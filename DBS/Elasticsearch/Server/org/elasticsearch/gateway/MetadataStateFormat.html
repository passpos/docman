<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>MetadataStateFormat (server 7.11.1 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<meta name="description" content="declaration: package: org.elasticsearch.gateway, class: MetadataStateFormat">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":10,"i1":9,"i2":6,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":6,"i12":10,"i13":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flexBox">
<header role="banner" class="flexHeader">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="skipNav"><a id="skip.navbar.top">
<!--   -->
</a></div>
</nav>
</header>
<div class="flexContent">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.elasticsearch.gateway</a></div>
<h1 title="Class MetadataStateFormat" class="title">Class MetadataStateFormat&lt;T&gt;</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree">java.lang.Object
<div class="inheritance">org.elasticsearch.gateway.MetadataStateFormat&lt;T&gt;</div>
</div>
<section class="description">
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>T</code> - the type of the XContent base data-structure</dd>
</dl>
<hr>
<pre>public abstract class <span class="typeNameLabel">MetadataStateFormat&lt;T&gt;</span>
extends java.lang.Object</pre>
<div class="block">MetadataStateFormat is a base class to write checksummed
 XContent based files to one or more directories in a standardized directory structure.</div>
</section>
<section class="summary">
<ul class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<li class="blockList">
<section class="fieldSummary"><a id="field.summary">
<!--   -->
</a>
<h2>Field Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static org.elasticsearch.common.xcontent.XContentType</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#FORMAT">FORMAT</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_DIR_NAME">STATE_DIR_NAME</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#STATE_FILE_EXTENSION">STATE_FILE_EXTENSION</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
<!--   -->
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colSecond" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(java.lang.String)">MetadataStateFormat</a></span>&#8203;(java.lang.String&nbsp;prefix)</code></th>
<td class="colLast">
<div class="block">Creates a new <a href="MetadataStateFormat.html" title="class in org.elasticsearch.gateway"><code>MetadataStateFormat</code></a> instance</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t1" class="tableTab" onclick="show(1);">Static Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t3" class="tableTab" onclick="show(4);">Abstract Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#cleanupOldFiles(long,java.nio.file.Path%5B%5D)">cleanupOldFiles</a></span>&#8203;(long&nbsp;currentGeneration,
java.nio.file.Path[]&nbsp;locations)</code></th>
<td class="colLast">
<div class="block">Clean ups all state files not matching passed generation.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>static void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#deleteMetaState(java.nio.file.Path...)">deleteMetaState</a></span>&#8203;(java.nio.file.Path...&nbsp;dataLocations)</code></th>
<td class="colLast">
<div class="block">Deletes all meta state directories recursively for the given data locations</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>abstract <a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#fromXContent(org.elasticsearch.common.xcontent.XContentParser)">fromXContent</a></span>&#8203;(org.elasticsearch.common.xcontent.XContentParser&nbsp;parser)</code></th>
<td class="colLast">
<div class="block">Reads a new instance of the state from the given XContentParser
 Subclasses need to implement this class for theirs specific state.</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getPrefix()">getPrefix</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getStateFileName(long)">getStateFileName</a></span>&#8203;(long&nbsp;generation)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#loadGeneration(org.apache.logging.log4j.Logger,org.elasticsearch.common.xcontent.NamedXContentRegistry,long,java.nio.file.Path...)">loadGeneration</a></span>&#8203;(org.apache.logging.log4j.Logger&nbsp;logger,
org.elasticsearch.common.xcontent.NamedXContentRegistry&nbsp;namedXContentRegistry,
long&nbsp;generation,
java.nio.file.Path...&nbsp;dataLocations)</code></th>
<td class="colLast">
<div class="block">Tries to load the state of particular generation from the given data-locations.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#loadLatestState(org.apache.logging.log4j.Logger,org.elasticsearch.common.xcontent.NamedXContentRegistry,java.nio.file.Path...)">loadLatestState</a></span>&#8203;(org.apache.logging.log4j.Logger&nbsp;logger,
org.elasticsearch.common.xcontent.NamedXContentRegistry&nbsp;namedXContentRegistry,
java.nio.file.Path...&nbsp;dataLocations)</code></th>
<td class="colLast">
<div class="block">Tries to load the latest state from the given data-locations.</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>org.elasticsearch.common.collect.Tuple&lt;<a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a>,&#8203;java.lang.Long&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#loadLatestStateWithGeneration(org.apache.logging.log4j.Logger,org.elasticsearch.common.xcontent.NamedXContentRegistry,java.nio.file.Path...)">loadLatestStateWithGeneration</a></span>&#8203;(org.apache.logging.log4j.Logger&nbsp;logger,
org.elasticsearch.common.xcontent.NamedXContentRegistry&nbsp;namedXContentRegistry,
java.nio.file.Path...&nbsp;dataLocations)</code></th>
<td class="colLast">
<div class="block">Tries to load the latest state from the given data-locations.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>protected org.apache.lucene.store.Directory</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newDirectory(java.nio.file.Path)">newDirectory</a></span>&#8203;(java.nio.file.Path&nbsp;dir)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>protected org.elasticsearch.common.xcontent.XContentBuilder</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newXContentBuilder(org.elasticsearch.common.xcontent.XContentType,java.io.OutputStream)">newXContentBuilder</a></span>&#8203;(org.elasticsearch.common.xcontent.XContentType&nbsp;type,
java.io.OutputStream&nbsp;stream)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#read(org.elasticsearch.common.xcontent.NamedXContentRegistry,java.nio.file.Path)">read</a></span>&#8203;(org.elasticsearch.common.xcontent.NamedXContentRegistry&nbsp;namedXContentRegistry,
java.nio.file.Path&nbsp;file)</code></th>
<td class="colLast">
<div class="block">Reads the state from a given file and compares the expected version against the actual version of
 the state.</div>
</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code>abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#toXContent(org.elasticsearch.common.xcontent.XContentBuilder,T)">toXContent</a></span>&#8203;(org.elasticsearch.common.xcontent.XContentBuilder&nbsp;builder,
<a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a>&nbsp;state)</code></th>
<td class="colLast">
<div class="block">Writes the given state to the given XContentBuilder
 Subclasses need to implement this class for theirs specific state.</div>
</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#write(T,java.nio.file.Path...)">write</a></span>&#8203;(<a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a>&nbsp;state,
java.nio.file.Path...&nbsp;locations)</code></th>
<td class="colLast">
<div class="block">Writes the given state to the given directories.</div>
</td>
</tr>
<tr class="rowColor" id="i13">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#writeAndCleanup(T,java.nio.file.Path...)">writeAndCleanup</a></span>&#8203;(<a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a>&nbsp;state,
java.nio.file.Path...&nbsp;locations)</code></th>
<td class="colLast">
<div class="block">Writes the given state to the given directories and performs cleanup of old state files if the write succeeds or
 newly created state file if write fails.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a><code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<li class="blockList">
<section class="fieldDetails"><a id="field.detail">
<!--   -->
</a>
<h2>Field Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="FORMAT">FORMAT</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">org.elasticsearch.common.xcontent.XContentType</span>&nbsp;<span class="memberName">FORMAT</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_DIR_NAME">STATE_DIR_NAME</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">STATE_DIR_NAME</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.elasticsearch.gateway.MetadataStateFormat.STATE_DIR_NAME">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="STATE_FILE_EXTENSION">STATE_FILE_EXTENSION</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">STATE_FILE_EXTENSION</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.elasticsearch.gateway.MetadataStateFormat.STATE_FILE_EXTENSION">Constant Field Values</a></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
<!--   -->
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(java.lang.String)">MetadataStateFormat</a></h3>
<div class="memberSignature"><span class="modifiers">protected</span>&nbsp;<span class="memberName">MetadataStateFormat</span>&#8203;(<span class="arguments">java.lang.String&nbsp;prefix)</span></div>
<div class="block">Creates a new <a href="MetadataStateFormat.html" title="class in org.elasticsearch.gateway"><code>MetadataStateFormat</code></a> instance</div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="writeAndCleanup(java.lang.Object,java.nio.file.Path[])">
<!--   -->
</a><a id="writeAndCleanup(T,java.nio.file.Path...)">writeAndCleanup</a></h3>
<div class="memberSignature"><span class="modifiers">public final</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">writeAndCleanup</span>&#8203;(<span class="arguments"><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a>&nbsp;state,
java.nio.file.Path...&nbsp;locations)</span>
                           throws <span class="exceptions"><a href="WriteStateException.html" title="class in org.elasticsearch.gateway">WriteStateException</a></span></div>
<div class="block">Writes the given state to the given directories and performs cleanup of old state files if the write succeeds or
 newly created state file if write fails.
 See also <a href="#write(T,java.nio.file.Path...)"><code>write(Object, Path...)</code></a> and <a href="#cleanupOldFiles(long,java.nio.file.Path%5B%5D)"><code>cleanupOldFiles(long, Path[])</code></a>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="WriteStateException.html" title="class in org.elasticsearch.gateway">WriteStateException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="write(java.lang.Object,java.nio.file.Path[])">
<!--   -->
</a><a id="write(T,java.nio.file.Path...)">write</a></h3>
<div class="memberSignature"><span class="modifiers">public final</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">write</span>&#8203;(<span class="arguments"><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a>&nbsp;state,
java.nio.file.Path...&nbsp;locations)</span>
                 throws <span class="exceptions"><a href="WriteStateException.html" title="class in org.elasticsearch.gateway">WriteStateException</a></span></div>
<div class="block">Writes the given state to the given directories. The state is written to a
 state directory (<a href="#STATE_DIR_NAME">"_state"</a>) underneath each of the given file locations and is created if it
 doesn't exist. The state is serialized to a temporary file in that directory and is then atomically moved to
 it's target filename of the pattern <code>{prefix}{version}.st</code>.
 If this method returns without exception there is a guarantee that state is persisted to the disk and loadLatestState will return
 it.<br>
 This method always performs cleanup of temporary files regardless whether it succeeds or fails. Cleanup logic for state files is
 more involved.
 If this method fails with an exception, it performs cleanup of newly created state file.
 But if this method succeeds, it does not perform cleanup of old state files.
 If this write succeeds, but some further write fails, you may want to rollback the transaction and keep old file around.
 After transaction is finished use <a href="#cleanupOldFiles(long,java.nio.file.Path%5B%5D)"><code>cleanupOldFiles(long, Path[])</code></a> for the clean-up.
 If this write is not a part of bigger transaction, consider using <a href="#writeAndCleanup(T,java.nio.file.Path...)"><code>writeAndCleanup(Object, Path...)</code></a> method instead.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>state</code> - the state object to write</dd>
<dd><code>locations</code> - the locations where the state should be written to.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>generation of newly written state.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="WriteStateException.html" title="class in org.elasticsearch.gateway">WriteStateException</a></code> - if some exception during writing state occurs. See also <a href="WriteStateException.html#isDirty()"><code>WriteStateException.isDirty()</code></a>.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="newXContentBuilder(org.elasticsearch.common.xcontent.XContentType,java.io.OutputStream)">newXContentBuilder</a></h3>
<div class="memberSignature"><span class="modifiers">protected</span>&nbsp;<span class="returnType">org.elasticsearch.common.xcontent.XContentBuilder</span>&nbsp;<span class="memberName">newXContentBuilder</span>&#8203;(<span class="arguments">org.elasticsearch.common.xcontent.XContentType&nbsp;type,
java.io.OutputStream&nbsp;stream)</span>
                                                                        throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="toXContent(org.elasticsearch.common.xcontent.XContentBuilder,java.lang.Object)">
<!--   -->
</a><a id="toXContent(org.elasticsearch.common.xcontent.XContentBuilder,T)">toXContent</a></h3>
<div class="memberSignature"><span class="modifiers">public abstract</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">toXContent</span>&#8203;(<span class="arguments">org.elasticsearch.common.xcontent.XContentBuilder&nbsp;builder,
<a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a>&nbsp;state)</span>
                         throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Writes the given state to the given XContentBuilder
 Subclasses need to implement this class for theirs specific state.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="fromXContent(org.elasticsearch.common.xcontent.XContentParser)">fromXContent</a></h3>
<div class="memberSignature"><span class="modifiers">public abstract</span>&nbsp;<span class="returnType"><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a></span>&nbsp;<span class="memberName">fromXContent</span>&#8203;(<span class="arguments">org.elasticsearch.common.xcontent.XContentParser&nbsp;parser)</span>
                        throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Reads a new instance of the state from the given XContentParser
 Subclasses need to implement this class for theirs specific state.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="read(org.elasticsearch.common.xcontent.NamedXContentRegistry,java.nio.file.Path)">read</a></h3>
<div class="memberSignature"><span class="modifiers">public final</span>&nbsp;<span class="returnType"><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a></span>&nbsp;<span class="memberName">read</span>&#8203;(<span class="arguments">org.elasticsearch.common.xcontent.NamedXContentRegistry&nbsp;namedXContentRegistry,
java.nio.file.Path&nbsp;file)</span>
             throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Reads the state from a given file and compares the expected version against the actual version of
 the state.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="newDirectory(java.nio.file.Path)">newDirectory</a></h3>
<div class="memberSignature"><span class="modifiers">protected</span>&nbsp;<span class="returnType">org.apache.lucene.store.Directory</span>&nbsp;<span class="memberName">newDirectory</span>&#8203;(<span class="arguments">java.nio.file.Path&nbsp;dir)</span>
                                                  throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="cleanupOldFiles(long,java.nio.file.Path[])">cleanupOldFiles</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">cleanupOldFiles</span>&#8203;(<span class="arguments">long&nbsp;currentGeneration,
java.nio.file.Path[]&nbsp;locations)</span></div>
<div class="block">Clean ups all state files not matching passed generation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>currentGeneration</code> - state generation to keep.</dd>
<dd><code>locations</code> - state paths.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getStateFileName(long)">getStateFileName</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">getStateFileName</span>&#8203;(<span class="arguments">long&nbsp;generation)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="loadGeneration(org.apache.logging.log4j.Logger,org.elasticsearch.common.xcontent.NamedXContentRegistry,long,java.nio.file.Path...)">loadGeneration</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a></span>&nbsp;<span class="memberName">loadGeneration</span>&#8203;(<span class="arguments">org.apache.logging.log4j.Logger&nbsp;logger,
org.elasticsearch.common.xcontent.NamedXContentRegistry&nbsp;namedXContentRegistry,
long&nbsp;generation,
java.nio.file.Path...&nbsp;dataLocations)</span></div>
<div class="block">Tries to load the state of particular generation from the given data-locations. If any of data locations contain state files with
 given generation, state will be loaded from these state files.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>logger</code> - a logger instance.</dd>
<dd><code>generation</code> - the generation to be loaded.</dd>
<dd><code>dataLocations</code> - the data-locations to try.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the state of asked generation or <code>null</code> if no state was found.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="loadLatestStateWithGeneration(org.apache.logging.log4j.Logger,org.elasticsearch.common.xcontent.NamedXContentRegistry,java.nio.file.Path...)">loadLatestStateWithGeneration</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">org.elasticsearch.common.collect.Tuple&lt;<a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a>,&#8203;java.lang.Long&gt;</span>&nbsp;<span class="memberName">loadLatestStateWithGeneration</span>&#8203;(<span class="arguments">org.apache.logging.log4j.Logger&nbsp;logger,
org.elasticsearch.common.xcontent.NamedXContentRegistry&nbsp;namedXContentRegistry,
java.nio.file.Path...&nbsp;dataLocations)</span>
                                                                                       throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Tries to load the latest state from the given data-locations.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>logger</code> - a logger instance.</dd>
<dd><code>dataLocations</code> - the data-locations to try.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>tuple of the latest state and generation. (null, -1) if no state is found.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="loadLatestState(org.apache.logging.log4j.Logger,org.elasticsearch.common.xcontent.NamedXContentRegistry,java.nio.file.Path...)">loadLatestState</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="MetadataStateFormat.html" title="type parameter in MetadataStateFormat">T</a></span>&nbsp;<span class="memberName">loadLatestState</span>&#8203;(<span class="arguments">org.apache.logging.log4j.Logger&nbsp;logger,
org.elasticsearch.common.xcontent.NamedXContentRegistry&nbsp;namedXContentRegistry,
java.nio.file.Path...&nbsp;dataLocations)</span>
                  throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Tries to load the latest state from the given data-locations.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>logger</code> - a logger instance.</dd>
<dd><code>dataLocations</code> - the data-locations to try.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the latest state or <code>null</code> if no state was found.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="deleteMetaState(java.nio.file.Path...)">deleteMetaState</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">deleteMetaState</span>&#8203;(<span class="arguments">java.nio.file.Path...&nbsp;dataLocations)</span>
                            throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Deletes all meta state directories recursively for the given data locations</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dataLocations</code> - the data location to delete</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getPrefix()">getPrefix</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">getPrefix</span>()</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</div>
</div>
</body>
</html>
