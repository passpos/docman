<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>IndexShard (server 7.11.1 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<meta name="description" content="declaration: package: org.elasticsearch.index.shard, class: IndexShard">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10,"i22":10,"i23":10,"i24":10,"i25":10,"i26":10,"i27":10,"i28":10,"i29":10,"i30":9,"i31":10,"i32":10,"i33":10,"i34":10,"i35":10,"i36":10,"i37":10,"i38":10,"i39":10,"i40":10,"i41":10,"i42":10,"i43":10,"i44":10,"i45":10,"i46":10,"i47":10,"i48":10,"i49":10,"i50":10,"i51":10,"i52":10,"i53":10,"i54":10,"i55":10,"i56":10,"i57":10,"i58":10,"i59":10,"i60":10,"i61":10,"i62":10,"i63":10,"i64":10,"i65":10,"i66":10,"i67":10,"i68":10,"i69":10,"i70":10,"i71":10,"i72":10,"i73":10,"i74":10,"i75":10,"i76":10,"i77":10,"i78":10,"i79":10,"i80":10,"i81":10,"i82":10,"i83":10,"i84":10,"i85":10,"i86":10,"i87":10,"i88":10,"i89":10,"i90":10,"i91":10,"i92":10,"i93":10,"i94":10,"i95":10,"i96":10,"i97":10,"i98":10,"i99":10,"i100":10,"i101":10,"i102":10,"i103":10,"i104":10,"i105":10,"i106":10,"i107":10,"i108":10,"i109":10,"i110":10,"i111":9,"i112":10,"i113":10,"i114":10,"i115":10,"i116":10,"i117":10,"i118":10,"i119":10,"i120":10,"i121":10,"i122":10,"i123":10,"i124":10,"i125":10,"i126":10,"i127":10,"i128":10,"i129":10,"i130":10,"i131":10,"i132":10,"i133":10,"i134":10,"i135":10,"i136":10,"i137":10,"i138":10,"i139":10,"i140":10,"i141":10,"i142":10,"i143":10,"i144":10,"i145":10,"i146":10,"i147":10,"i148":10,"i149":10,"i150":10,"i151":10,"i152":10,"i153":10,"i154":10,"i155":10,"i156":10,"i157":10,"i158":10,"i159":10,"i160":10,"i161":10,"i162":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flexBox">
<header role="banner" class="flexHeader">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="skipNav"><a id="skip.navbar.top">
<!--   -->
</a></div>
</nav>
</header>
<div class="flexContent">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.elasticsearch.index.shard</a></div>
<h1 title="Class IndexShard" class="title">Class IndexShard</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree">java.lang.Object
<div class="inheritance"><a href="AbstractIndexShardComponent.html" title="class in org.elasticsearch.index.shard">org.elasticsearch.index.shard.AbstractIndexShardComponent</a>
<div class="inheritance">org.elasticsearch.index.shard.IndexShard</div>
</div>
</div>
<section class="description">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="IndexShardComponent.html" title="interface in org.elasticsearch.index.shard">IndexShardComponent</a></code>, <code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html" title="interface in org.elasticsearch.indices.cluster">IndicesClusterStateService.Shard</a></code></dd>
</dl>
<hr>
<pre>public class <span class="typeNameLabel">IndexShard</span>
extends <a href="AbstractIndexShardComponent.html" title="class in org.elasticsearch.index.shard">AbstractIndexShardComponent</a>
implements <a href="../../indices/cluster/IndicesClusterStateService.Shard.html" title="interface in org.elasticsearch.indices.cluster">IndicesClusterStateService.Shard</a></pre>
</section>
<section class="summary">
<ul class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li class="blockList">
<section class="nestedClassSummary"><a id="nested.class.summary">
<!--   -->
</a>
<h2>Nested Class Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="IndexShard.ShardFailure.html" title="class in org.elasticsearch.index.shard">IndexShard.ShardFailure</a></span></code></th>
<td class="colLast">
<div class="block">Simple struct encapsulating a shard failure</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li class="blockList">
<section class="fieldSummary"><a id="field.summary">
<!--   -->
</a>
<h2>Field Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#OPERATIONS_BLOCKED">OPERATIONS_BLOCKED</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected <a href="../../cluster/routing/ShardRouting.html" title="class in org.elasticsearch.cluster.routing">ShardRouting</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#shardRouting">shardRouting</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="IndexShardState.html" title="enum in org.elasticsearch.index.shard">IndexShardState</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#state">state</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="inheritedList">
<h3>Fields inherited from class&nbsp;org.elasticsearch.index.shard.<a href="AbstractIndexShardComponent.html" title="class in org.elasticsearch.index.shard">AbstractIndexShardComponent</a></h3>
<a id="fields.inherited.from.class.org.elasticsearch.index.shard.AbstractIndexShardComponent">
<!--   -->
</a><code><a href="AbstractIndexShardComponent.html#indexSettings">indexSettings</a>, <a href="AbstractIndexShardComponent.html#logger">logger</a>, <a href="AbstractIndexShardComponent.html#shardId">shardId</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
<!--   -->
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.elasticsearch.cluster.routing.ShardRouting,org.elasticsearch.index.IndexSettings,org.elasticsearch.index.shard.ShardPath,org.elasticsearch.index.store.Store,java.util.function.Supplier,org.elasticsearch.index.cache.IndexCache,org.elasticsearch.index.mapper.MapperService,org.elasticsearch.index.similarity.SimilarityService,org.elasticsearch.index.engine.EngineFactory,org.elasticsearch.index.shard.IndexEventListener,org.elasticsearch.common.CheckedFunction,org.elasticsearch.threadpool.ThreadPool,org.elasticsearch.common.util.BigArrays,org.elasticsearch.index.engine.Engine.Warmer,java.util.List,java.util.List,java.lang.Runnable,org.elasticsearch.index.seqno.RetentionLeaseSyncer,org.elasticsearch.indices.breaker.CircuitBreakerService,org.elasticsearch.plugins.IndexStorePlugin.SnapshotCommitSupplier)">IndexShard</a></span>&#8203;(<a href="../../cluster/routing/ShardRouting.html" title="class in org.elasticsearch.cluster.routing">ShardRouting</a>&nbsp;shardRouting,
<a href="../IndexSettings.html" title="class in org.elasticsearch.index">IndexSettings</a>&nbsp;indexSettings,
<a href="ShardPath.html" title="class in org.elasticsearch.index.shard">ShardPath</a>&nbsp;path,
<a href="../store/Store.html" title="class in org.elasticsearch.index.store">Store</a>&nbsp;store,
java.util.function.Supplier&lt;org.apache.lucene.search.Sort&gt;&nbsp;indexSortSupplier,
<a href="../cache/IndexCache.html" title="class in org.elasticsearch.index.cache">IndexCache</a>&nbsp;indexCache,
<a href="../mapper/MapperService.html" title="class in org.elasticsearch.index.mapper">MapperService</a>&nbsp;mapperService,
<a href="../similarity/SimilarityService.html" title="class in org.elasticsearch.index.similarity">SimilarityService</a>&nbsp;similarityService,
<a href="../engine/EngineFactory.html" title="interface in org.elasticsearch.index.engine">EngineFactory</a>&nbsp;engineFactory,
<a href="IndexEventListener.html" title="interface in org.elasticsearch.index.shard">IndexEventListener</a>&nbsp;indexEventListener,
org.elasticsearch.common.CheckedFunction&lt;org.apache.lucene.index.DirectoryReader,&#8203;org.apache.lucene.index.DirectoryReader,&#8203;java.io.IOException&gt;&nbsp;indexReaderWrapper,
<a href="../../threadpool/ThreadPool.html" title="class in org.elasticsearch.threadpool">ThreadPool</a>&nbsp;threadPool,
<a href="../../common/util/BigArrays.html" title="class in org.elasticsearch.common.util">BigArrays</a>&nbsp;bigArrays,
<a href="../engine/Engine.Warmer.html" title="interface in org.elasticsearch.index.engine">Engine.Warmer</a>&nbsp;warmer,
java.util.List&lt;<a href="SearchOperationListener.html" title="interface in org.elasticsearch.index.shard">SearchOperationListener</a>&gt;&nbsp;searchOperationListener,
java.util.List&lt;<a href="IndexingOperationListener.html" title="interface in org.elasticsearch.index.shard">IndexingOperationListener</a>&gt;&nbsp;listeners,
java.lang.Runnable&nbsp;globalCheckpointSyncer,
<a href="../seqno/RetentionLeaseSyncer.html" title="class in org.elasticsearch.index.seqno">RetentionLeaseSyncer</a>&nbsp;retentionLeaseSyncer,
<a href="../../indices/breaker/CircuitBreakerService.html" title="class in org.elasticsearch.indices.breaker">CircuitBreakerService</a>&nbsp;circuitBreakerService,
<a href="../../plugins/IndexStorePlugin.SnapshotCommitSupplier.html" title="interface in org.elasticsearch.plugins">IndexStorePlugin.SnapshotCommitSupplier</a>&nbsp;snapshotCommitSupplier)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t1" class="tableTab" onclick="show(1);">Static Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireAllPrimaryOperationsPermits(org.elasticsearch.action.ActionListener,org.elasticsearch.common.unit.TimeValue)">acquireAllPrimaryOperationsPermits</a></span>&#8203;(<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
org.elasticsearch.common.unit.TimeValue&nbsp;timeout)</code></th>
<td class="colLast">
<div class="block">Acquire all primary operation permits.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireAllReplicaOperationsPermits(long,long,long,org.elasticsearch.action.ActionListener,org.elasticsearch.common.unit.TimeValue)">acquireAllReplicaOperationsPermits</a></span>&#8203;(long&nbsp;opPrimaryTerm,
long&nbsp;globalCheckpoint,
long&nbsp;maxSeqNoOfUpdatesOrDeletes,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
org.elasticsearch.common.unit.TimeValue&nbsp;timeout)</code></th>
<td class="colLast">
<div class="block">Acquire all replica operation permits whenever the shard is ready for indexing (see
 <a href="#acquireAllPrimaryOperationsPermits(org.elasticsearch.action.ActionListener,org.elasticsearch.common.unit.TimeValue)"><code>acquireAllPrimaryOperationsPermits(ActionListener, TimeValue)</code></a>.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>java.io.Closeable</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireHistoryRetentionLock(org.elasticsearch.index.engine.Engine.HistorySource)">acquireHistoryRetentionLock</a></span>&#8203;(<a href="../engine/Engine.HistorySource.html" title="enum in org.elasticsearch.index.engine">Engine.HistorySource</a>&nbsp;source)</code></th>
<td class="colLast">
<div class="block">Acquires a lock on the translog files and Lucene soft-deleted documents to prevent them from being trimmed</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code><a href="../engine/Engine.IndexCommitRef.html" title="class in org.elasticsearch.index.engine">Engine.IndexCommitRef</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireIndexCommitForSnapshot()">acquireIndexCommitForSnapshot</a></span>()</code></th>
<td class="colLast">
<div class="block">Acquires the <code>IndexCommit</code> which should be included in a snapshot.</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code><a href="../engine/Engine.IndexCommitRef.html" title="class in org.elasticsearch.index.engine">Engine.IndexCommitRef</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireLastIndexCommit(boolean)">acquireLastIndexCommit</a></span>&#8203;(boolean&nbsp;flushFirst)</code></th>
<td class="colLast">
<div class="block">Creates a new <code>IndexCommit</code> snapshot from the currently running engine.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquirePrimaryOperationPermit(org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object)">acquirePrimaryOperationPermit</a></span>&#8203;(<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
java.lang.String&nbsp;executorOnDelay,
java.lang.Object&nbsp;debugInfo)</code></th>
<td class="colLast">
<div class="block">Acquire a primary operation permit whenever the shard is ready for indexing.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquirePrimaryOperationPermit(org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object,boolean)">acquirePrimaryOperationPermit</a></span>&#8203;(<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
java.lang.String&nbsp;executorOnDelay,
java.lang.Object&nbsp;debugInfo,
boolean&nbsp;forceExecution)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireReplicaOperationPermit(long,long,long,org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object)">acquireReplicaOperationPermit</a></span>&#8203;(long&nbsp;opPrimaryTerm,
long&nbsp;globalCheckpoint,
long&nbsp;maxSeqNoOfUpdatesOrDeletes,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
java.lang.String&nbsp;executorOnDelay,
java.lang.Object&nbsp;debugInfo)</code></th>
<td class="colLast">
<div class="block">Acquire a replica operation permit whenever the shard is ready for indexing (see
 <a href="#acquirePrimaryOperationPermit(org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object)"><code>acquirePrimaryOperationPermit(ActionListener, String, Object)</code></a>).</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code><a href="../engine/Engine.IndexCommitRef.html" title="class in org.elasticsearch.index.engine">Engine.IndexCommitRef</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireSafeIndexCommit()">acquireSafeIndexCommit</a></span>()</code></th>
<td class="colLast">
<div class="block">Snapshots the most recent safe index commit from the currently running engine.</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code><a href="../engine/Engine.Searcher.html" title="class in org.elasticsearch.index.engine">Engine.Searcher</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireSearcher(java.lang.String)">acquireSearcher</a></span>&#8203;(java.lang.String&nbsp;source)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code><a href="../engine/Engine.SearcherSupplier.html" title="class in org.elasticsearch.index.engine">Engine.SearcherSupplier</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireSearcherSupplier()">acquireSearcherSupplier</a></span>()</code></th>
<td class="colLast">
<div class="block">Acquires a point-in-time reader that can be used to create <a href="../engine/Engine.Searcher.html" title="class in org.elasticsearch.index.engine"><code>Engine.Searcher</code></a>s on demand.</div>
</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code><a href="../engine/Engine.SearcherSupplier.html" title="class in org.elasticsearch.index.engine">Engine.SearcherSupplier</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#acquireSearcherSupplier(org.elasticsearch.index.engine.Engine.SearcherScope)">acquireSearcherSupplier</a></span>&#8203;(<a href="../engine/Engine.SearcherScope.html" title="enum in org.elasticsearch.index.engine">Engine.SearcherScope</a>&nbsp;scope)</code></th>
<td class="colLast">
<div class="block">Acquires a point-in-time reader that can be used to create <a href="../engine/Engine.Searcher.html" title="class in org.elasticsearch.index.engine"><code>Engine.Searcher</code></a>s on demand.</div>
</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#activateThrottling()">activateThrottling</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i13">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#activateWithPrimaryContext(org.elasticsearch.index.seqno.ReplicationTracker.PrimaryContext)">activateWithPrimaryContext</a></span>&#8203;(<a href="../seqno/ReplicationTracker.PrimaryContext.html" title="class in org.elasticsearch.index.seqno">ReplicationTracker.PrimaryContext</a>&nbsp;primaryContext)</code></th>
<td class="colLast">
<div class="block">Updates the known allocation IDs and the local checkpoints for the corresponding allocations from a primary relocation source.</div>
</td>
</tr>
<tr class="altColor" id="i14">
<td class="colFirst"><code>java.lang.Runnable</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addCleanFilesDependency()">addCleanFilesDependency</a></span>()</code></th>
<td class="colLast">
<div class="block">Creates a <code>Runnable</code> that must be executed before the clean files step in peer recovery can complete.</div>
</td>
</tr>
<tr class="rowColor" id="i15">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addGlobalCheckpointListener(long,org.elasticsearch.index.shard.GlobalCheckpointListeners.GlobalCheckpointListener,org.elasticsearch.common.unit.TimeValue)">addGlobalCheckpointListener</a></span>&#8203;(long&nbsp;waitingForGlobalCheckpoint,
<a href="GlobalCheckpointListeners.GlobalCheckpointListener.html" title="interface in org.elasticsearch.index.shard">GlobalCheckpointListeners.GlobalCheckpointListener</a>&nbsp;listener,
org.elasticsearch.common.unit.TimeValue&nbsp;timeout)</code></th>
<td class="colLast">
<div class="block">Add a global checkpoint listener.</div>
</td>
</tr>
<tr class="altColor" id="i16">
<td class="colFirst"><code><a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addPeerRecoveryRetentionLease(java.lang.String,long,org.elasticsearch.action.ActionListener)">addPeerRecoveryRetentionLease</a></span>&#8203;(java.lang.String&nbsp;nodeId,
long&nbsp;globalCheckpoint,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i17">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addRefreshListener(org.elasticsearch.index.translog.Translog.Location,java.util.function.Consumer)">addRefreshListener</a></span>&#8203;(<a href="../translog/Translog.Location.html" title="class in org.elasticsearch.index.translog">Translog.Location</a>&nbsp;location,
java.util.function.Consumer&lt;java.lang.Boolean&gt;&nbsp;listener)</code></th>
<td class="colLast">
<div class="block">Add a listener for refreshes.</div>
</td>
</tr>
<tr class="altColor" id="i18">
<td class="colFirst"><code><a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addRetentionLease(java.lang.String,long,java.lang.String,org.elasticsearch.action.ActionListener)">addRetentionLease</a></span>&#8203;(java.lang.String&nbsp;id,
long&nbsp;retainingSequenceNumber,
java.lang.String&nbsp;source,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</code></th>
<td class="colLast">
<div class="block">Adds a new retention lease.</div>
</td>
</tr>
<tr class="rowColor" id="i19">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addShardFailureCallback(java.util.function.Consumer)">addShardFailureCallback</a></span>&#8203;(java.util.function.Consumer&lt;<a href="IndexShard.ShardFailure.html" title="class in org.elasticsearch.index.shard">IndexShard.ShardFailure</a>&gt;&nbsp;onShardFailure)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i20">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#advanceMaxSeqNoOfUpdatesOrDeletes(long)">advanceMaxSeqNoOfUpdatesOrDeletes</a></span>&#8203;(long&nbsp;seqNo)</code></th>
<td class="colLast">
<div class="block">A replica calls this method to advance the max_seq_no_of_updates marker of its engine to at least the max_seq_no_of_updates
 value (piggybacked in a replication request) that it receives from its primary before executing that replication request.</div>
</td>
</tr>
<tr class="rowColor" id="i21">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#afterCleanFiles(java.lang.Runnable)">afterCleanFiles</a></span>&#8203;(java.lang.Runnable&nbsp;runnable)</code></th>
<td class="colLast">
<div class="block">Execute a <code>Runnable</code> on the generic pool once all dependencies added via <a href="#addCleanFilesDependency()"><code>addCleanFilesDependency()</code></a> have finished.</div>
</td>
</tr>
<tr class="altColor" id="i22">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#afterWriteOperation()">afterWriteOperation</a></span>()</code></th>
<td class="colLast">
<div class="block">Schedules a flush or translog generation roll if needed but will not schedule more than one concurrently.</div>
</td>
</tr>
<tr class="rowColor" id="i23">
<td class="colFirst"><code><a href="../engine/Engine.DeleteResult.html" title="class in org.elasticsearch.index.engine">Engine.DeleteResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#applyDeleteOperationOnPrimary(long,java.lang.String,java.lang.String,org.elasticsearch.index.VersionType,long,long)">applyDeleteOperationOnPrimary</a></span>&#8203;(long&nbsp;version,
java.lang.String&nbsp;type,
java.lang.String&nbsp;id,
<a href="../VersionType.html" title="enum in org.elasticsearch.index">VersionType</a>&nbsp;versionType,
long&nbsp;ifSeqNo,
long&nbsp;ifPrimaryTerm)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i24">
<td class="colFirst"><code><a href="../engine/Engine.DeleteResult.html" title="class in org.elasticsearch.index.engine">Engine.DeleteResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#applyDeleteOperationOnReplica(long,long,long,java.lang.String,java.lang.String)">applyDeleteOperationOnReplica</a></span>&#8203;(long&nbsp;seqNo,
long&nbsp;opPrimaryTerm,
long&nbsp;version,
java.lang.String&nbsp;type,
java.lang.String&nbsp;id)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i25">
<td class="colFirst"><code><a href="../engine/Engine.IndexResult.html" title="class in org.elasticsearch.index.engine">Engine.IndexResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#applyIndexOperationOnPrimary(long,org.elasticsearch.index.VersionType,org.elasticsearch.index.mapper.SourceToParse,long,long,long,boolean)">applyIndexOperationOnPrimary</a></span>&#8203;(long&nbsp;version,
<a href="../VersionType.html" title="enum in org.elasticsearch.index">VersionType</a>&nbsp;versionType,
<a href="../mapper/SourceToParse.html" title="class in org.elasticsearch.index.mapper">SourceToParse</a>&nbsp;sourceToParse,
long&nbsp;ifSeqNo,
long&nbsp;ifPrimaryTerm,
long&nbsp;autoGeneratedTimestamp,
boolean&nbsp;isRetry)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i26">
<td class="colFirst"><code><a href="../engine/Engine.IndexResult.html" title="class in org.elasticsearch.index.engine">Engine.IndexResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#applyIndexOperationOnReplica(long,long,long,long,boolean,org.elasticsearch.index.mapper.SourceToParse)">applyIndexOperationOnReplica</a></span>&#8203;(long&nbsp;seqNo,
long&nbsp;opPrimaryTerm,
long&nbsp;version,
long&nbsp;autoGeneratedTimeStamp,
boolean&nbsp;isRetry,
<a href="../mapper/SourceToParse.html" title="class in org.elasticsearch.index.mapper">SourceToParse</a>&nbsp;sourceToParse)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i27">
<td class="colFirst"><code><a href="../engine/Engine.Result.html" title="class in org.elasticsearch.index.engine">Engine.Result</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#applyTranslogOperation(org.elasticsearch.index.translog.Translog.Operation,org.elasticsearch.index.engine.Engine.Operation.Origin)">applyTranslogOperation</a></span>&#8203;(<a href="../translog/Translog.Operation.html" title="interface in org.elasticsearch.index.translog">Translog.Operation</a>&nbsp;operation,
<a href="../engine/Engine.Operation.Origin.html" title="enum in org.elasticsearch.index.engine">Engine.Operation.Origin</a>&nbsp;origin)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i28">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#assertRetentionLeasesPersisted()">assertRetentionLeasesPersisted</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i29">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#awaitShardSearchActive(java.util.function.Consumer)">awaitShardSearchActive</a></span>&#8203;(java.util.function.Consumer&lt;java.lang.Boolean&gt;&nbsp;listener)</code></th>
<td class="colLast">
<div class="block">Registers the given listener and invokes it once the shard is active again and all
 pending refresh translog location has been refreshed.</div>
</td>
</tr>
<tr class="altColor" id="i30">
<td class="colFirst"><code>static org.apache.lucene.analysis.Analyzer</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#buildIndexAnalyzer(org.elasticsearch.index.mapper.MapperService)">buildIndexAnalyzer</a></span>&#8203;(<a href="../mapper/MapperService.html" title="class in org.elasticsearch.index.mapper">MapperService</a>&nbsp;mapperService)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i31">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#checkIdle(long)">checkIdle</a></span>&#8203;(long&nbsp;inactiveTimeNS)</code></th>
<td class="colLast">
<div class="block">Called by <a href="../../indices/IndexingMemoryController.html" title="class in org.elasticsearch.indices"><code>IndexingMemoryController</code></a> to check whether more than <code>inactiveTimeNS</code> has passed since the last
 indexing operation, and notify listeners that we are now inactive so e.g.</div>
</td>
</tr>
<tr class="altColor" id="i32">
<td class="colFirst"><code><a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#cloneLocalPeerRecoveryRetentionLease(java.lang.String,org.elasticsearch.action.ActionListener)">cloneLocalPeerRecoveryRetentionLease</a></span>&#8203;(java.lang.String&nbsp;nodeId,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i33">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#close(java.lang.String,boolean)">close</a></span>&#8203;(java.lang.String&nbsp;reason,
boolean&nbsp;flushEngine)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i34">
<td class="colFirst"><code><a href="../engine/CommitStats.html" title="class in org.elasticsearch.index.engine">CommitStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#commitStats()">commitStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i35">
<td class="colFirst"><code><a href="../../search/suggest/completion/CompletionStats.html" title="class in org.elasticsearch.search.suggest.completion">CompletionStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#completionStats(java.lang.String...)">completionStats</a></span>&#8203;(java.lang.String...&nbsp;fields)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i36">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#deactivateThrottling()">deactivateThrottling</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i37">
<td class="colFirst"><code><a href="DocsStats.html" title="class in org.elasticsearch.index.shard">DocsStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#docStats()">docStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i38">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#estimateNumberOfHistoryOperations(java.lang.String,org.elasticsearch.index.engine.Engine.HistorySource,long)">estimateNumberOfHistoryOperations</a></span>&#8203;(java.lang.String&nbsp;reason,
<a href="../engine/Engine.HistorySource.html" title="enum in org.elasticsearch.index.engine">Engine.HistorySource</a>&nbsp;source,
long&nbsp;startingSeqNo)</code></th>
<td class="colLast">
<div class="block">Returns the estimated number of history operations whose seq# at least the provided seq# in this shard.</div>
</td>
</tr>
<tr class="rowColor" id="i39">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#failShard(java.lang.String,java.lang.Exception)">failShard</a></span>&#8203;(java.lang.String&nbsp;reason,
java.lang.Exception&nbsp;e)</code></th>
<td class="colLast">
<div class="block">Fails the shard and marks the shard store as corrupted if
 <code>e</code> is caused by index corruption</div>
</td>
</tr>
<tr class="altColor" id="i40">
<td class="colFirst"><code><a href="../fielddata/ShardFieldData.html" title="class in org.elasticsearch.index.fielddata">ShardFieldData</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#fieldData()">fieldData</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i41">
<td class="colFirst"><code><a href="../fielddata/FieldDataStats.html" title="class in org.elasticsearch.index.fielddata">FieldDataStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#fieldDataStats(java.lang.String...)">fieldDataStats</a></span>&#8203;(java.lang.String...&nbsp;fields)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i42">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#finalizeRecovery()">finalizeRecovery</a></span>()</code></th>
<td class="colLast">
<div class="block">perform the last stages of recovery once all translog operations are done.</div>
</td>
</tr>
<tr class="rowColor" id="i43">
<td class="colFirst"><code><a href="../engine/Engine.CommitId.html" title="class in org.elasticsearch.index.engine">Engine.CommitId</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flush(org.elasticsearch.action.admin.indices.flush.FlushRequest)">flush</a></span>&#8203;(<a href="../../action/admin/indices/flush/FlushRequest.html" title="class in org.elasticsearch.action.admin.indices.flush">FlushRequest</a>&nbsp;request)</code></th>
<td class="colLast">
<div class="block">Executes the given flush request against the engine.</div>
</td>
</tr>
<tr class="altColor" id="i44">
<td class="colFirst"><code><a href="../flush/FlushStats.html" title="class in org.elasticsearch.index.flush">FlushStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flushStats()">flushStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i45">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#forceMerge(org.elasticsearch.action.admin.indices.forcemerge.ForceMergeRequest)">forceMerge</a></span>&#8203;(<a href="../../action/admin/indices/forcemerge/ForceMergeRequest.html" title="class in org.elasticsearch.action.admin.indices.forcemerge">ForceMergeRequest</a>&nbsp;forceMerge)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i46">
<td class="colFirst"><code><a href="../engine/Engine.GetResult.html" title="class in org.elasticsearch.index.engine">Engine.GetResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#get(org.elasticsearch.index.engine.Engine.Get)">get</a></span>&#8203;(<a href="../engine/Engine.Get.html" title="class in org.elasticsearch.index.engine">Engine.Get</a>&nbsp;get)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i47">
<td class="colFirst"><code>java.util.List&lt;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getActiveOperations()">getActiveOperations</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i48">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getActiveOperationsCount()">getActiveOperationsCount</a></span>()</code></th>
<td class="colLast">
<div class="block">Obtain the active operation count, or <a href="#OPERATIONS_BLOCKED"><code>OPERATIONS_BLOCKED</code></a> if all permits are held (even if there are
 outstanding operations in flight).</div>
</td>
</tr>
<tr class="rowColor" id="i49">
<td class="colFirst"><code>protected <a href="../engine/Engine.html" title="class in org.elasticsearch.index.engine">Engine</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getEngineOrNull()">getEngineOrNull</a></span>()</code></th>
<td class="colLast">
<div class="block">NOTE: returns null if engine is not yet started (e.g.</div>
</td>
</tr>
<tr class="altColor" id="i50">
<td class="colFirst"><code><a href="../engine/Engine.DeleteResult.html" title="class in org.elasticsearch.index.engine">Engine.DeleteResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getFailedDeleteResult(java.lang.Exception,long)">getFailedDeleteResult</a></span>&#8203;(java.lang.Exception&nbsp;e,
long&nbsp;version)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i51">
<td class="colFirst"><code><a href="../engine/Engine.IndexResult.html" title="class in org.elasticsearch.index.engine">Engine.IndexResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getFailedIndexResult(java.lang.Exception,long)">getFailedIndexResult</a></span>&#8203;(java.lang.Exception&nbsp;e,
long&nbsp;version)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i52">
<td class="colFirst"><code><a href="../translog/Translog.Snapshot.html" title="interface in org.elasticsearch.index.translog">Translog.Snapshot</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getHistoryOperations(java.lang.String,org.elasticsearch.index.engine.Engine.HistorySource,long)">getHistoryOperations</a></span>&#8203;(java.lang.String&nbsp;reason,
<a href="../engine/Engine.HistorySource.html" title="enum in org.elasticsearch.index.engine">Engine.HistorySource</a>&nbsp;source,
long&nbsp;startingSeqNo)</code></th>
<td class="colLast">
<div class="block">Creates a new history snapshot for reading operations since the provided starting seqno (inclusive).</div>
</td>
</tr>
<tr class="rowColor" id="i53">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getHistoryUUID()">getHistoryUUID</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i54">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getIndexBufferRAMBytesUsed()">getIndexBufferRAMBytesUsed</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns number of heap bytes used by the indexing buffer for this shard, or 0 if the shard is closed</div>
</td>
</tr>
<tr class="rowColor" id="i55">
<td class="colFirst"><code><a href="IndexEventListener.html" title="interface in org.elasticsearch.index.shard">IndexEventListener</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getIndexEventListener()">getIndexEventListener</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i56">
<td class="colFirst"><code>org.apache.lucene.search.Sort</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getIndexSort()">getIndexSort</a></span>()</code></th>
<td class="colLast">
<div class="block">Return the sort order of this index, or null if the index has no sort.</div>
</td>
</tr>
<tr class="rowColor" id="i57">
<td class="colFirst"><code>com.carrotsearch.hppc.ObjectLongMap&lt;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getInSyncGlobalCheckpoints()">getInSyncGlobalCheckpoints</a></span>()</code></th>
<td class="colLast">
<div class="block">Get the local knowledge of the global checkpoints for all in-sync allocation IDs.</div>
</td>
</tr>
<tr class="altColor" id="i58">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getLastKnownGlobalCheckpoint()">getLastKnownGlobalCheckpoint</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the global checkpoint for the shard.</div>
</td>
</tr>
<tr class="rowColor" id="i59">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getLastSyncedGlobalCheckpoint()">getLastSyncedGlobalCheckpoint</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the latest global checkpoint value that has been persisted in the underlying storage (i.e.</div>
</td>
</tr>
<tr class="altColor" id="i60">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getLocalCheckpoint()">getLocalCheckpoint</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the persisted local checkpoint for the shard.</div>
</td>
</tr>
<tr class="rowColor" id="i61">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMaxSeenAutoIdTimestamp()">getMaxSeenAutoIdTimestamp</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the maximum auto_id_timestamp of all append-only requests have been processed by this shard or the auto_id_timestamp received
 from the primary via <a href="#updateMaxUnsafeAutoIdTimestamp(long)"><code>updateMaxUnsafeAutoIdTimestamp(long)</code></a> at the beginning of a peer-recovery or a primary-replica resync.</div>
</td>
</tr>
<tr class="altColor" id="i62">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMaxSeqNoOfUpdatesOrDeletes()">getMaxSeqNoOfUpdatesOrDeletes</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the maximum sequence number of either update or delete operations have been processed in this shard
 or the sequence number from <a href="#advanceMaxSeqNoOfUpdatesOrDeletes(long)"><code>advanceMaxSeqNoOfUpdatesOrDeletes(long)</code></a>.</div>
</td>
</tr>
<tr class="rowColor" id="i63">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMinRetainedSeqNo()">getMinRetainedSeqNo</a></span>()</code></th>
<td class="colLast">
<div class="block">Gets the minimum retained sequence number for this engine.</div>
</td>
</tr>
<tr class="altColor" id="i64">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getOperationPrimaryTerm()">getOperationPrimaryTerm</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the primary term that is currently being used to assign to operations</div>
</td>
</tr>
<tr class="rowColor" id="i65">
<td class="colFirst"><code>java.util.List&lt;<a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getPeerRecoveryRetentionLeases()">getPeerRecoveryRetentionLeases</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns a list of retention leases for peer recovery installed in this shard copy.</div>
</td>
</tr>
<tr class="altColor" id="i66">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getPendingPrimaryTerm()">getPendingPrimaryTerm</a></span>()</code></th>
<td class="colLast">
<div class="block">USE THIS METHOD WITH CARE!
 Returns the primary term the index shard is supposed to be on.</div>
</td>
</tr>
<tr class="rowColor" id="i67">
<td class="colFirst"><code><a href="../../action/support/replication/PendingReplicationActions.html" title="class in org.elasticsearch.action.support.replication">PendingReplicationActions</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getPendingReplicationActions()">getPendingReplicationActions</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the pending replication actions for the shard.</div>
</td>
</tr>
<tr class="altColor" id="i68">
<td class="colFirst"><code>org.apache.lucene.search.QueryCachingPolicy</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getQueryCachingPolicy()">getQueryCachingPolicy</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i69">
<td class="colFirst"><code><a href="ReplicationGroup.html" title="class in org.elasticsearch.index.shard">ReplicationGroup</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getReplicationGroup()">getReplicationGroup</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the current replication group for the shard.</div>
</td>
</tr>
<tr class="altColor" id="i70">
<td class="colFirst"><code><a href="../seqno/RetentionLeases.html" title="class in org.elasticsearch.index.seqno">RetentionLeases</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRetentionLeases()">getRetentionLeases</a></span>()</code></th>
<td class="colLast">
<div class="block">Get all retention leases tracked on this shard.</div>
</td>
</tr>
<tr class="rowColor" id="i71">
<td class="colFirst"><code>org.elasticsearch.common.collect.Tuple&lt;java.lang.Boolean,&#8203;<a href="../seqno/RetentionLeases.html" title="class in org.elasticsearch.index.seqno">RetentionLeases</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRetentionLeases(boolean)">getRetentionLeases</a></span>&#8203;(boolean&nbsp;expireLeases)</code></th>
<td class="colLast">
<div class="block">If the expire leases parameter is false, gets all retention leases tracked on this shard and otherwise first calculates
 expiration of existing retention leases, and then gets all non-expired retention leases tracked on this shard.</div>
</td>
</tr>
<tr class="altColor" id="i72">
<td class="colFirst"><code><a href="../seqno/RetentionLeaseStats.html" title="class in org.elasticsearch.index.seqno">RetentionLeaseStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRetentionLeaseStats()">getRetentionLeaseStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i73">
<td class="colFirst"><code><a href="SearchOperationListener.html" title="interface in org.elasticsearch.index.shard">SearchOperationListener</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSearchOperationListener()">getSearchOperationListener</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i74">
<td class="colFirst"><code><a href="../get/ShardGetService.html" title="class in org.elasticsearch.index.get">ShardGetService</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getService()">getService</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i75">
<td class="colFirst"><code><a href="../get/GetStats.html" title="class in org.elasticsearch.index.get">GetStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getStats()">getStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i76">
<td class="colFirst"><code><a href="../../threadpool/ThreadPool.html" title="class in org.elasticsearch.threadpool">ThreadPool</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getThreadPool()">getThreadPool</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i77">
<td class="colFirst"><code><a href="ShardLongFieldRange.html" title="class in org.elasticsearch.index.shard">ShardLongFieldRange</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTimestampMillisRange()">getTimestampMillisRange</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i78">
<td class="colFirst"><code><a href="../translog/Translog.Durability.html" title="enum in org.elasticsearch.index.translog">Translog.Durability</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTranslogDurability()">getTranslogDurability</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the current translog durability mode</div>
</td>
</tr>
<tr class="rowColor" id="i79">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getWritingBytes()">getWritingBytes</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns how many bytes we are currently moving from heap to disk</div>
</td>
</tr>
<tr class="altColor" id="i80">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#hasCompleteHistoryOperations(java.lang.String,org.elasticsearch.index.engine.Engine.HistorySource,long)">hasCompleteHistoryOperations</a></span>&#8203;(java.lang.String&nbsp;reason,
<a href="../engine/Engine.HistorySource.html" title="enum in org.elasticsearch.index.engine">Engine.HistorySource</a>&nbsp;source,
long&nbsp;startingSeqNo)</code></th>
<td class="colLast">
<div class="block">Checks if we have a completed history of operations since the given starting seqno (inclusive).</div>
</td>
</tr>
<tr class="rowColor" id="i81">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#hasRefreshPending()">hasRefreshPending</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true if this shard has some scheduled refresh that is pending because of search-idle.</div>
</td>
</tr>
<tr class="altColor" id="i82">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#ignoreRecoveryAttempt()">ignoreRecoveryAttempt</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns <code>true</code> if this shard can ignore a recovery attempt made to it (since the already doing/done it)</div>
</td>
</tr>
<tr class="rowColor" id="i83">
<td class="colFirst"><code><a href="IndexingStats.html" title="class in org.elasticsearch.index.shard">IndexingStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#indexingStats(java.lang.String...)">indexingStats</a></span>&#8203;(java.lang.String...&nbsp;types)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i84">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#initiateTracking(java.lang.String)">initiateTracking</a></span>&#8203;(java.lang.String&nbsp;allocationId)</code></th>
<td class="colLast">
<div class="block">Called when the recovery process for a shard has opened the engine on the target shard.</div>
</td>
</tr>
<tr class="rowColor" id="i85">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isActive()">isActive</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i86">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isReadAllowed()">isReadAllowed</a></span>()</code></th>
<td class="colLast">
<div class="block">returns true if the <a href="IndexShardState.html" title="enum in org.elasticsearch.index.shard"><code>IndexShardState</code></a> allows reading</div>
</td>
</tr>
<tr class="rowColor" id="i87">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isRelocatedPrimary()">isRelocatedPrimary</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns whether the shard is a relocated primary, i.e.</div>
</td>
</tr>
<tr class="altColor" id="i88">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isSearchIdle()">isSearchIdle</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true if this shards is search idle</div>
</td>
</tr>
<tr class="rowColor" id="i89">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isSyncNeeded()">isSyncNeeded</a></span>()</code></th>
<td class="colLast">
<div class="block">Checks if the underlying storage sync is required.</div>
</td>
</tr>
<tr class="altColor" id="i90">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isSystem()">isSystem</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i91">
<td class="colFirst"><code><a href="../seqno/RetentionLeases.html" title="class in org.elasticsearch.index.seqno">RetentionLeases</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#loadRetentionLeases()">loadRetentionLeases</a></span>()</code></th>
<td class="colLast">
<div class="block">Loads the latest retention leases from their dedicated state file.</div>
</td>
</tr>
<tr class="altColor" id="i92">
<td class="colFirst"><code><a href="../mapper/MapperService.html" title="class in org.elasticsearch.index.mapper">MapperService</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mapperService()">mapperService</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i93">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#markAllocationIdAsInSync(java.lang.String,long)">markAllocationIdAsInSync</a></span>&#8203;(java.lang.String&nbsp;allocationId,
long&nbsp;localCheckpoint)</code></th>
<td class="colLast">
<div class="block">Marks the shard with the provided allocation ID as in-sync with the primary shard.</div>
</td>
</tr>
<tr class="altColor" id="i94">
<td class="colFirst"><code><a href="IndexShardState.html" title="enum in org.elasticsearch.index.shard">IndexShardState</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#markAsRecovering(java.lang.String,org.elasticsearch.indices.recovery.RecoveryState)">markAsRecovering</a></span>&#8203;(java.lang.String&nbsp;reason,
<a href="../../indices/recovery/RecoveryState.html" title="class in org.elasticsearch.indices.recovery">RecoveryState</a>&nbsp;recoveryState)</code></th>
<td class="colLast">
<div class="block">Marks the shard as recovering based on a recovery state, fails with exception is recovering is not allowed to be set.</div>
</td>
</tr>
<tr class="rowColor" id="i95">
<td class="colFirst"><code><a href="../engine/Engine.NoOpResult.html" title="class in org.elasticsearch.index.engine">Engine.NoOpResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#markSeqNoAsNoop(long,long,java.lang.String)">markSeqNoAsNoop</a></span>&#8203;(long&nbsp;seqNo,
long&nbsp;opPrimaryTerm,
java.lang.String&nbsp;reason)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i96">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#maybeCheckIndex()">maybeCheckIndex</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i97">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#maybeSyncGlobalCheckpoint(java.lang.String)">maybeSyncGlobalCheckpoint</a></span>&#8203;(java.lang.String&nbsp;reason)</code></th>
<td class="colLast">
<div class="block">Syncs the global checkpoint to the replicas if the global checkpoint on at least one replica is behind the global checkpoint on the
 primary.</div>
</td>
</tr>
<tr class="altColor" id="i98">
<td class="colFirst"><code><a href="../merge/MergeStats.html" title="class in org.elasticsearch.index.merge">MergeStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#mergeStats()">mergeStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i99">
<td class="colFirst"><code>org.apache.lucene.util.Version</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#minimumCompatibleVersion()">minimumCompatibleVersion</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i100">
<td class="colFirst"><code><a href="../translog/Translog.Snapshot.html" title="interface in org.elasticsearch.index.translog">Translog.Snapshot</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newChangesSnapshot(java.lang.String,long,long,boolean)">newChangesSnapshot</a></span>&#8203;(java.lang.String&nbsp;source,
long&nbsp;fromSeqNo,
long&nbsp;toSeqNo,
boolean&nbsp;requiredFullRange)</code></th>
<td class="colLast">
<div class="block">Creates a new changes snapshot for reading operations whose seq_no are between <code>fromSeqNo</code>(inclusive)
 and <code>toSeqNo</code>(inclusive).</div>
</td>
</tr>
<tr class="rowColor" id="i101">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#noopUpdate(java.lang.String)">noopUpdate</a></span>&#8203;(java.lang.String&nbsp;type)</code></th>
<td class="colLast">
<div class="block">Should be called for each no-op update operation to increment relevant statistics.</div>
</td>
</tr>
<tr class="altColor" id="i102">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#onSettingsChanged()">onSettingsChanged</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i103">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#openEngineAndRecoverFromTranslog()">openEngineAndRecoverFromTranslog</a></span>()</code></th>
<td class="colLast">
<div class="block">opens the engine on top of the existing lucene engine and translog.</div>
</td>
</tr>
<tr class="altColor" id="i104">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#openEngineAndSkipTranslogRecovery()">openEngineAndSkipTranslogRecovery</a></span>()</code></th>
<td class="colLast">
<div class="block">Opens the engine on top of the existing lucene engine and translog.</div>
</td>
</tr>
<tr class="rowColor" id="i105">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#outstandingCleanFilesConditions()">outstandingCleanFilesConditions</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i106">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#pendingInSync()">pendingInSync</a></span>()</code></th>
<td class="colLast">
<div class="block">Check if there are any recoveries pending in-sync.</div>
</td>
</tr>
<tr class="rowColor" id="i107">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#performRecoveryRestart()">performRecoveryRestart</a></span>()</code></th>
<td class="colLast">
<div class="block">called if recovery has to be restarted after network error / delay **</div>
</td>
</tr>
<tr class="altColor" id="i108">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#persistRetentionLeases()">persistRetentionLeases</a></span>()</code></th>
<td class="colLast">
<div class="block">Persists the current retention leases to their dedicated state file.</div>
</td>
</tr>
<tr class="rowColor" id="i109">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#postRecovery(java.lang.String)">postRecovery</a></span>&#8203;(java.lang.String&nbsp;reason)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i110">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareForIndexRecovery()">prepareForIndexRecovery</a></span>()</code></th>
<td class="colLast">
<div class="block">called before starting to copy index files over</div>
</td>
</tr>
<tr class="rowColor" id="i111">
<td class="colFirst"><code>static <a href="../engine/Engine.Index.html" title="class in org.elasticsearch.index.engine">Engine.Index</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#prepareIndex(org.elasticsearch.index.mapper.DocumentMapperForType,org.elasticsearch.index.mapper.SourceToParse,long,long,long,org.elasticsearch.index.VersionType,org.elasticsearch.index.engine.Engine.Operation.Origin,long,boolean,long,long)">prepareIndex</a></span>&#8203;(<a href="../mapper/DocumentMapperForType.html" title="class in org.elasticsearch.index.mapper">DocumentMapperForType</a>&nbsp;docMapper,
<a href="../mapper/SourceToParse.html" title="class in org.elasticsearch.index.mapper">SourceToParse</a>&nbsp;source,
long&nbsp;seqNo,
long&nbsp;primaryTerm,
long&nbsp;version,
<a href="../VersionType.html" title="enum in org.elasticsearch.index">VersionType</a>&nbsp;versionType,
<a href="../engine/Engine.Operation.Origin.html" title="enum in org.elasticsearch.index.engine">Engine.Operation.Origin</a>&nbsp;origin,
long&nbsp;autoGeneratedIdTimestamp,
boolean&nbsp;isRetry,
long&nbsp;ifSeqNo,
long&nbsp;ifPrimaryTerm)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i112">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#preRecovery()">preRecovery</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i113">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#readAllowed()">readAllowed</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i114">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#recoverFromLocalShards(java.util.function.BiConsumer,java.util.List,org.elasticsearch.action.ActionListener)">recoverFromLocalShards</a></span>&#8203;(java.util.function.BiConsumer&lt;java.lang.String,&#8203;<a href="../../cluster/metadata/MappingMetadata.html" title="class in org.elasticsearch.cluster.metadata">MappingMetadata</a>&gt;&nbsp;mappingUpdateConsumer,
java.util.List&lt;<a href="IndexShard.html" title="class in org.elasticsearch.index.shard">IndexShard</a>&gt;&nbsp;localShards,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Boolean&gt;&nbsp;listener)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i115">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#recoverFromStore(org.elasticsearch.action.ActionListener)">recoverFromStore</a></span>&#8203;(<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Boolean&gt;&nbsp;listener)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i116">
<td class="colFirst"><code>long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#recoverLocallyUpToGlobalCheckpoint()">recoverLocallyUpToGlobalCheckpoint</a></span>()</code></th>
<td class="colLast">
<div class="block">A best effort to bring up this shard to the global checkpoint using the local translog before performing a peer recovery.</div>
</td>
</tr>
<tr class="rowColor" id="i117">
<td class="colFirst"><code><a href="../../indices/recovery/RecoveryState.html" title="class in org.elasticsearch.indices.recovery">RecoveryState</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#recoveryState()">recoveryState</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the current <a href="../../indices/recovery/RecoveryState.html" title="class in org.elasticsearch.indices.recovery"><code>RecoveryState</code></a> if this shard is recovering or has been recovering.</div>
</td>
</tr>
<tr class="altColor" id="i118">
<td class="colFirst"><code><a href="../recovery/RecoveryStats.html" title="class in org.elasticsearch.index.recovery">RecoveryStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#recoveryStats()">recoveryStats</a></span>()</code></th>
<td class="colLast">
<div class="block">returns stats about ongoing recoveries, both source and target</div>
</td>
</tr>
<tr class="rowColor" id="i119">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#refresh(java.lang.String)">refresh</a></span>&#8203;(java.lang.String&nbsp;source)</code></th>
<td class="colLast">
<div class="block">Writes all indexing changes to disk and opens a new searcher reflecting all changes.</div>
</td>
</tr>
<tr class="altColor" id="i120">
<td class="colFirst"><code><a href="../refresh/RefreshStats.html" title="class in org.elasticsearch.index.refresh">RefreshStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#refreshStats()">refreshStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i121">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#relocated(java.lang.String,java.util.function.BiConsumer,org.elasticsearch.action.ActionListener)">relocated</a></span>&#8203;(java.lang.String&nbsp;targetAllocationId,
java.util.function.BiConsumer&lt;<a href="../seqno/ReplicationTracker.PrimaryContext.html" title="class in org.elasticsearch.index.seqno">ReplicationTracker.PrimaryContext</a>,&#8203;<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Void&gt;&gt;&nbsp;consumer,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Void&gt;&nbsp;listener)</code></th>
<td class="colLast">
<div class="block">Completes the relocation.</div>
</td>
</tr>
<tr class="altColor" id="i122">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#removePeerRecoveryRetentionLease(java.lang.String,org.elasticsearch.action.ActionListener)">removePeerRecoveryRetentionLease</a></span>&#8203;(java.lang.String&nbsp;nodeId,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i123">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#removeRetentionLease(java.lang.String,org.elasticsearch.action.ActionListener)">removeRetentionLease</a></span>&#8203;(java.lang.String&nbsp;id,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</code></th>
<td class="colLast">
<div class="block">Removes an existing retention lease.</div>
</td>
</tr>
<tr class="altColor" id="i124">
<td class="colFirst"><code><a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#renewRetentionLease(java.lang.String,long,java.lang.String)">renewRetentionLease</a></span>&#8203;(java.lang.String&nbsp;id,
long&nbsp;retainingSequenceNumber,
java.lang.String&nbsp;source)</code></th>
<td class="colLast">
<div class="block">Renews an existing retention lease.</div>
</td>
</tr>
<tr class="rowColor" id="i125">
<td class="colFirst"><code><a href="../cache/request/ShardRequestCache.html" title="class in org.elasticsearch.index.cache.request">ShardRequestCache</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#requestCache()">requestCache</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i126">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#resetRecoveryStage()">resetRecoveryStage</a></span>()</code></th>
<td class="colLast">
<div class="block">If a file-based recovery occurs, a recovery target calls this method to reset the recovery stage.</div>
</td>
</tr>
<tr class="rowColor" id="i127">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#restoreFromRepository(org.elasticsearch.repositories.Repository,org.elasticsearch.action.ActionListener)">restoreFromRepository</a></span>&#8203;(<a href="../../repositories/Repository.html" title="interface in org.elasticsearch.repositories">Repository</a>&nbsp;repository,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Boolean&gt;&nbsp;listener)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i128">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#rollTranslogGeneration()">rollTranslogGeneration</a></span>()</code></th>
<td class="colLast">
<div class="block">Rolls the tranlog generation and cleans unneeded.</div>
</td>
</tr>
<tr class="rowColor" id="i129">
<td class="colFirst"><code><a href="../../cluster/routing/ShardRouting.html" title="class in org.elasticsearch.cluster.routing">ShardRouting</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#routingEntry()">routingEntry</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the latest cluster routing entry received with this shard.</div>
</td>
</tr>
<tr class="altColor" id="i130">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#runUnderPrimaryPermit(java.lang.Runnable,java.util.function.Consumer,java.lang.String,java.lang.Object)">runUnderPrimaryPermit</a></span>&#8203;(java.lang.Runnable&nbsp;runnable,
java.util.function.Consumer&lt;java.lang.Exception&gt;&nbsp;onFailure,
java.lang.String&nbsp;executorOnDelay,
java.lang.Object&nbsp;debugInfo)</code></th>
<td class="colLast">
<div class="block">Runs the specified runnable under a permit and otherwise calling back the specified failure callback.</div>
</td>
</tr>
<tr class="rowColor" id="i131">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#scheduledRefresh()">scheduledRefresh</a></span>()</code></th>
<td class="colLast">
<div class="block">Executes a scheduled refresh if necessary.</div>
</td>
</tr>
<tr class="altColor" id="i132">
<td class="colFirst"><code><a href="../search/stats/SearchStats.html" title="class in org.elasticsearch.index.search.stats">SearchStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#searchStats(java.lang.String...)">searchStats</a></span>&#8203;(java.lang.String...&nbsp;groups)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i133">
<td class="colFirst"><code>java.util.List&lt;<a href="../engine/Segment.html" title="class in org.elasticsearch.index.engine">Segment</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#segments(boolean)">segments</a></span>&#8203;(boolean&nbsp;verbose)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i134">
<td class="colFirst"><code><a href="../engine/SegmentsStats.html" title="class in org.elasticsearch.index.engine">SegmentsStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#segmentStats(boolean,boolean)">segmentStats</a></span>&#8203;(boolean&nbsp;includeSegmentFileSizes,
boolean&nbsp;includeUnloadedSegments)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i135">
<td class="colFirst"><code><a href="../seqno/SeqNoStats.html" title="class in org.elasticsearch.index.seqno">SeqNoStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#seqNoStats()">seqNoStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i136">
<td class="colFirst"><code><a href="../cache/bitset/ShardBitsetFilterCache.html" title="class in org.elasticsearch.index.cache.bitset">ShardBitsetFilterCache</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#shardBitsetFilterCache()">shardBitsetFilterCache</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i137">
<td class="colFirst"><code><a href="ShardPath.html" title="class in org.elasticsearch.index.shard">ShardPath</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#shardPath()">shardPath</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i138">
<td class="colFirst"><code><a href="../store/Store.MetadataSnapshot.html" title="class in org.elasticsearch.index.store">Store.MetadataSnapshot</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#snapshotStoreMetadata()">snapshotStoreMetadata</a></span>()</code></th>
<td class="colLast">
<div class="block">gets a <a href="../store/Store.MetadataSnapshot.html" title="class in org.elasticsearch.index.store"><code>Store.MetadataSnapshot</code></a> for the current directory.</div>
</td>
</tr>
<tr class="rowColor" id="i139">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#startRecovery(org.elasticsearch.indices.recovery.RecoveryState,org.elasticsearch.indices.recovery.PeerRecoveryTargetService,org.elasticsearch.indices.recovery.PeerRecoveryTargetService.RecoveryListener,org.elasticsearch.repositories.RepositoriesService,java.util.function.BiConsumer,org.elasticsearch.indices.IndicesService)">startRecovery</a></span>&#8203;(<a href="../../indices/recovery/RecoveryState.html" title="class in org.elasticsearch.indices.recovery">RecoveryState</a>&nbsp;recoveryState,
<a href="../../indices/recovery/PeerRecoveryTargetService.html" title="class in org.elasticsearch.indices.recovery">PeerRecoveryTargetService</a>&nbsp;recoveryTargetService,
<a href="../../indices/recovery/PeerRecoveryTargetService.RecoveryListener.html" title="interface in org.elasticsearch.indices.recovery">PeerRecoveryTargetService.RecoveryListener</a>&nbsp;recoveryListener,
<a href="../../repositories/RepositoriesService.html" title="class in org.elasticsearch.repositories">RepositoriesService</a>&nbsp;repositoriesService,
java.util.function.BiConsumer&lt;java.lang.String,&#8203;<a href="../../cluster/metadata/MappingMetadata.html" title="class in org.elasticsearch.cluster.metadata">MappingMetadata</a>&gt;&nbsp;mappingUpdateConsumer,
<a href="../../indices/IndicesService.html" title="class in org.elasticsearch.indices">IndicesService</a>&nbsp;indicesService)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i140">
<td class="colFirst"><code><a href="IndexShardState.html" title="enum in org.elasticsearch.index.shard">IndexShardState</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#state()">state</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the latest internal shard state.</div>
</td>
</tr>
<tr class="rowColor" id="i141">
<td class="colFirst"><code><a href="../store/Store.html" title="class in org.elasticsearch.index.store">Store</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#store()">store</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i142">
<td class="colFirst"><code><a href="../store/StoreStats.html" title="class in org.elasticsearch.index.store">StoreStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#storeStats()">storeStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i143">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#sync()">sync</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i144">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#sync(org.elasticsearch.index.translog.Translog.Location,java.util.function.Consumer)">sync</a></span>&#8203;(<a href="../translog/Translog.Location.html" title="class in org.elasticsearch.index.translog">Translog.Location</a>&nbsp;location,
java.util.function.Consumer&lt;java.lang.Exception&gt;&nbsp;syncListener)</code></th>
<td class="colLast">
<div class="block">Syncs the given location with the underlying storage unless already synced.</div>
</td>
</tr>
<tr class="rowColor" id="i145">
<td class="colFirst"><code><a href="../engine/Engine.SyncedFlushResult.html" title="enum in org.elasticsearch.index.engine">Engine.SyncedFlushResult</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#syncFlush(java.lang.String,org.elasticsearch.index.engine.Engine.CommitId)">syncFlush</a></span>&#8203;(java.lang.String&nbsp;syncId,
<a href="../engine/Engine.CommitId.html" title="class in org.elasticsearch.index.engine">Engine.CommitId</a>&nbsp;expectedCommitId)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i146">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#syncRetentionLeases()">syncRetentionLeases</a></span>()</code></th>
<td class="colLast">
<div class="block">Syncs the current retention leases to all replicas.</div>
</td>
</tr>
<tr class="rowColor" id="i147">
<td class="colFirst"><code><a href="../translog/TranslogStats.html" title="class in org.elasticsearch.index.translog">TranslogStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#translogStats()">translogStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i148">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#trimOperationOfPreviousPrimaryTerms(long)">trimOperationOfPreviousPrimaryTerms</a></span>&#8203;(long&nbsp;aboveSeqNo)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i149">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#trimTranslog()">trimTranslog</a></span>()</code></th>
<td class="colLast">
<div class="block">checks and removes translog files that no longer need to be retained.</div>
</td>
</tr>
<tr class="altColor" id="i150">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateGlobalCheckpointForShard(java.lang.String,long)">updateGlobalCheckpointForShard</a></span>&#8203;(java.lang.String&nbsp;allocationId,
long&nbsp;globalCheckpoint)</code></th>
<td class="colLast">
<div class="block">Update the local knowledge of the persisted global checkpoint for the specified allocation ID.</div>
</td>
</tr>
<tr class="rowColor" id="i151">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateGlobalCheckpointOnReplica(long,java.lang.String)">updateGlobalCheckpointOnReplica</a></span>&#8203;(long&nbsp;globalCheckpoint,
java.lang.String&nbsp;reason)</code></th>
<td class="colLast">
<div class="block">Updates the global checkpoint on a replica shard after it has been updated by the primary.</div>
</td>
</tr>
<tr class="altColor" id="i152">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateLocalCheckpointForShard(java.lang.String,long)">updateLocalCheckpointForShard</a></span>&#8203;(java.lang.String&nbsp;allocationId,
long&nbsp;checkpoint)</code></th>
<td class="colLast">
<div class="block">Notifies the service to update the local checkpoint for the shard with the provided allocation ID.</div>
</td>
</tr>
<tr class="rowColor" id="i153">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateMaxUnsafeAutoIdTimestamp(long)">updateMaxUnsafeAutoIdTimestamp</a></span>&#8203;(long&nbsp;maxSeenAutoIdTimestampFromPrimary)</code></th>
<td class="colLast">
<div class="block">Since operations stored in soft-deletes do not have max_auto_id_timestamp, the primary has to propagate its max_auto_id_timestamp
 (via <a href="#getMaxSeenAutoIdTimestamp()"><code>getMaxSeenAutoIdTimestamp()</code></a> of all processed append-only requests to replicas at the beginning of a peer-recovery
 or a primary-replica resync to force a replica to disable optimization for all append-only requests which are replicated via
 replication while its retry variants are replicated via recovery without auto_id_timestamp.</div>
</td>
</tr>
<tr class="altColor" id="i154">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateRetentionLeasesOnReplica(org.elasticsearch.index.seqno.RetentionLeases)">updateRetentionLeasesOnReplica</a></span>&#8203;(<a href="../seqno/RetentionLeases.html" title="class in org.elasticsearch.index.seqno">RetentionLeases</a>&nbsp;retentionLeases)</code></th>
<td class="colLast">
<div class="block">Updates retention leases on a replica.</div>
</td>
</tr>
<tr class="rowColor" id="i155">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#updateShardState(org.elasticsearch.cluster.routing.ShardRouting,long,java.util.function.BiConsumer,long,java.util.Set,org.elasticsearch.cluster.routing.IndexShardRoutingTable)">updateShardState</a></span>&#8203;(<a href="../../cluster/routing/ShardRouting.html" title="class in org.elasticsearch.cluster.routing">ShardRouting</a>&nbsp;newRouting,
long&nbsp;newPrimaryTerm,
java.util.function.BiConsumer&lt;<a href="IndexShard.html" title="class in org.elasticsearch.index.shard">IndexShard</a>,&#8203;<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="PrimaryReplicaSyncer.ResyncTask.html" title="class in org.elasticsearch.index.shard">PrimaryReplicaSyncer.ResyncTask</a>&gt;&gt;&nbsp;primaryReplicaSyncer,
long&nbsp;applyingClusterStateVersion,
java.util.Set&lt;java.lang.String&gt;&nbsp;inSyncAllocationIds,
<a href="../../cluster/routing/IndexShardRoutingTable.html" title="class in org.elasticsearch.cluster.routing">IndexShardRoutingTable</a>&nbsp;routingTable)</code></th>
<td class="colLast">
<div class="block">Updates the shard state based on an incoming cluster state:
 - Updates and persists the new routing value.</div>
</td>
</tr>
<tr class="altColor" id="i156">
<td class="colFirst"><code>org.apache.lucene.util.Version</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#upgrade(org.elasticsearch.action.admin.indices.upgrade.post.UpgradeRequest)">upgrade</a></span>&#8203;(<a href="../../action/admin/indices/upgrade/post/UpgradeRequest.html" title="class in org.elasticsearch.action.admin.indices.upgrade.post">UpgradeRequest</a>&nbsp;upgrade)</code></th>
<td class="colLast">
<div class="block">Upgrades the shard to the current version of Lucene and returns the minimum segment version</div>
</td>
</tr>
<tr class="rowColor" id="i157">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#useRetentionLeasesInPeerRecovery()">useRetentionLeasesInPeerRecovery</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i158">
<td class="colFirst"><code>protected void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#verifyActive()">verifyActive</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i159">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#verifyShardBeforeIndexClosing()">verifyShardBeforeIndexClosing</a></span>()</code></th>
<td class="colLast">
<div class="block">Performs the pre-closing checks on the <a href="IndexShard.html" title="class in org.elasticsearch.index.shard"><code>IndexShard</code></a>.</div>
</td>
</tr>
<tr class="altColor" id="i160">
<td class="colFirst"><code><a href="../warmer/ShardIndexWarmerService.html" title="class in org.elasticsearch.index.warmer">ShardIndexWarmerService</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#warmerService()">warmerService</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i161">
<td class="colFirst"><code><a href="../warmer/WarmerStats.html" title="class in org.elasticsearch.index.warmer">WarmerStats</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#warmerStats()">warmerStats</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i162">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#writeIndexingBuffer()">writeIndexingBuffer</a></span>()</code></th>
<td class="colLast">
<div class="block">Called when our shard is using too much heap and should move buffered indexed/deleted documents to disk.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;org.elasticsearch.index.shard.<a href="AbstractIndexShardComponent.html" title="class in org.elasticsearch.index.shard">AbstractIndexShardComponent</a></h3>
<a id="methods.inherited.from.class.org.elasticsearch.index.shard.AbstractIndexShardComponent">
<!--   -->
</a><code><a href="AbstractIndexShardComponent.html#indexSettings()">indexSettings</a>, <a href="AbstractIndexShardComponent.html#shardId()">shardId</a></code></div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a><code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></div>
<div class="inheritedList">
<h3>Methods inherited from interface&nbsp;org.elasticsearch.indices.cluster.<a href="../../indices/cluster/IndicesClusterStateService.Shard.html" title="interface in org.elasticsearch.indices.cluster">IndicesClusterStateService.Shard</a></h3>
<a id="methods.inherited.from.class.org.elasticsearch.indices.cluster.IndicesClusterStateService.Shard">
<!--   -->
</a><code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html#shardId()">shardId</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<li class="blockList">
<section class="fieldDetails"><a id="field.detail">
<!--   -->
</a>
<h2>Field Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="shardRouting">shardRouting</a></h3>
<div class="memberSignature"><span class="modifiers">protected volatile</span>&nbsp;<span class="returnType"><a href="../../cluster/routing/ShardRouting.html" title="class in org.elasticsearch.cluster.routing">ShardRouting</a></span>&nbsp;<span class="memberName">shardRouting</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="state">state</a></h3>
<div class="memberSignature"><span class="modifiers">protected volatile</span>&nbsp;<span class="returnType"><a href="IndexShardState.html" title="enum in org.elasticsearch.index.shard">IndexShardState</a></span>&nbsp;<span class="memberName">state</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="OPERATIONS_BLOCKED">OPERATIONS_BLOCKED</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">OPERATIONS_BLOCKED</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#org.elasticsearch.index.shard.IndexShard.OPERATIONS_BLOCKED">Constant Field Values</a></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
<!--   -->
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(org.elasticsearch.cluster.routing.ShardRouting,org.elasticsearch.index.IndexSettings,org.elasticsearch.index.shard.ShardPath,org.elasticsearch.index.store.Store,java.util.function.Supplier,org.elasticsearch.index.cache.IndexCache,org.elasticsearch.index.mapper.MapperService,org.elasticsearch.index.similarity.SimilarityService,org.elasticsearch.index.engine.EngineFactory,org.elasticsearch.index.shard.IndexEventListener,org.elasticsearch.common.CheckedFunction,org.elasticsearch.threadpool.ThreadPool,org.elasticsearch.common.util.BigArrays,org.elasticsearch.index.engine.Engine.Warmer,java.util.List,java.util.List,java.lang.Runnable,org.elasticsearch.index.seqno.RetentionLeaseSyncer,org.elasticsearch.indices.breaker.CircuitBreakerService,org.elasticsearch.plugins.IndexStorePlugin.SnapshotCommitSupplier)">IndexShard</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">IndexShard</span>&#8203;(<span class="arguments"><a href="../../cluster/routing/ShardRouting.html" title="class in org.elasticsearch.cluster.routing">ShardRouting</a>&nbsp;shardRouting,
<a href="../IndexSettings.html" title="class in org.elasticsearch.index">IndexSettings</a>&nbsp;indexSettings,
<a href="ShardPath.html" title="class in org.elasticsearch.index.shard">ShardPath</a>&nbsp;path,
<a href="../store/Store.html" title="class in org.elasticsearch.index.store">Store</a>&nbsp;store,
java.util.function.Supplier&lt;org.apache.lucene.search.Sort&gt;&nbsp;indexSortSupplier,
<a href="../cache/IndexCache.html" title="class in org.elasticsearch.index.cache">IndexCache</a>&nbsp;indexCache,
<a href="../mapper/MapperService.html" title="class in org.elasticsearch.index.mapper">MapperService</a>&nbsp;mapperService,
<a href="../similarity/SimilarityService.html" title="class in org.elasticsearch.index.similarity">SimilarityService</a>&nbsp;similarityService,
@Nullable
<a href="../engine/EngineFactory.html" title="interface in org.elasticsearch.index.engine">EngineFactory</a>&nbsp;engineFactory,
<a href="IndexEventListener.html" title="interface in org.elasticsearch.index.shard">IndexEventListener</a>&nbsp;indexEventListener,
org.elasticsearch.common.CheckedFunction&lt;org.apache.lucene.index.DirectoryReader,&#8203;org.apache.lucene.index.DirectoryReader,&#8203;java.io.IOException&gt;&nbsp;indexReaderWrapper,
<a href="../../threadpool/ThreadPool.html" title="class in org.elasticsearch.threadpool">ThreadPool</a>&nbsp;threadPool,
<a href="../../common/util/BigArrays.html" title="class in org.elasticsearch.common.util">BigArrays</a>&nbsp;bigArrays,
<a href="../engine/Engine.Warmer.html" title="interface in org.elasticsearch.index.engine">Engine.Warmer</a>&nbsp;warmer,
java.util.List&lt;<a href="SearchOperationListener.html" title="interface in org.elasticsearch.index.shard">SearchOperationListener</a>&gt;&nbsp;searchOperationListener,
java.util.List&lt;<a href="IndexingOperationListener.html" title="interface in org.elasticsearch.index.shard">IndexingOperationListener</a>&gt;&nbsp;listeners,
java.lang.Runnable&nbsp;globalCheckpointSyncer,
<a href="../seqno/RetentionLeaseSyncer.html" title="class in org.elasticsearch.index.seqno">RetentionLeaseSyncer</a>&nbsp;retentionLeaseSyncer,
<a href="../../indices/breaker/CircuitBreakerService.html" title="class in org.elasticsearch.indices.breaker">CircuitBreakerService</a>&nbsp;circuitBreakerService,
<a href="../../plugins/IndexStorePlugin.SnapshotCommitSupplier.html" title="interface in org.elasticsearch.plugins">IndexStorePlugin.SnapshotCommitSupplier</a>&nbsp;snapshotCommitSupplier)</span>
           throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="getThreadPool()">getThreadPool</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../../threadpool/ThreadPool.html" title="class in org.elasticsearch.threadpool">ThreadPool</a></span>&nbsp;<span class="memberName">getThreadPool</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="store()">store</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../store/Store.html" title="class in org.elasticsearch.index.store">Store</a></span>&nbsp;<span class="memberName">store</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getIndexSort()">getIndexSort</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">org.apache.lucene.search.Sort</span>&nbsp;<span class="memberName">getIndexSort</span>()</div>
<div class="block">Return the sort order of this index, or null if the index has no sort.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getService()">getService</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../get/ShardGetService.html" title="class in org.elasticsearch.index.get">ShardGetService</a></span>&nbsp;<span class="memberName">getService</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="shardBitsetFilterCache()">shardBitsetFilterCache</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../cache/bitset/ShardBitsetFilterCache.html" title="class in org.elasticsearch.index.cache.bitset">ShardBitsetFilterCache</a></span>&nbsp;<span class="memberName">shardBitsetFilterCache</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mapperService()">mapperService</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../mapper/MapperService.html" title="class in org.elasticsearch.index.mapper">MapperService</a></span>&nbsp;<span class="memberName">mapperService</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getSearchOperationListener()">getSearchOperationListener</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="SearchOperationListener.html" title="interface in org.elasticsearch.index.shard">SearchOperationListener</a></span>&nbsp;<span class="memberName">getSearchOperationListener</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="warmerService()">warmerService</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../warmer/ShardIndexWarmerService.html" title="class in org.elasticsearch.index.warmer">ShardIndexWarmerService</a></span>&nbsp;<span class="memberName">warmerService</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="requestCache()">requestCache</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../cache/request/ShardRequestCache.html" title="class in org.elasticsearch.index.cache.request">ShardRequestCache</a></span>&nbsp;<span class="memberName">requestCache</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="fieldData()">fieldData</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../fielddata/ShardFieldData.html" title="class in org.elasticsearch.index.fielddata">ShardFieldData</a></span>&nbsp;<span class="memberName">fieldData</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isSystem()">isSystem</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">isSystem</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getPendingPrimaryTerm()">getPendingPrimaryTerm</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getPendingPrimaryTerm</span>()</div>
<div class="block">USE THIS METHOD WITH CARE!
 Returns the primary term the index shard is supposed to be on. In case of primary promotion or when a replica learns about
 a new term due to a new primary, the term that's exposed here will not be the term that the shard internally uses to assign
 to operations. The shard will auto-correct its internal operation term, but this might take time.
 See <a href="../../cluster/metadata/IndexMetadata.html#primaryTerm(int)"><code>IndexMetadata.primaryTerm(int)</code></a></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getOperationPrimaryTerm()">getOperationPrimaryTerm</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getOperationPrimaryTerm</span>()</div>
<div class="block">Returns the primary term that is currently being used to assign to operations</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="routingEntry()">routingEntry</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../../cluster/routing/ShardRouting.html" title="class in org.elasticsearch.cluster.routing">ShardRouting</a></span>&nbsp;<span class="memberName">routingEntry</span>()</div>
<div class="block">Returns the latest cluster routing entry received with this shard.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html#routingEntry()">routingEntry</a></code>&nbsp;in interface&nbsp;<code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html" title="interface in org.elasticsearch.indices.cluster">IndicesClusterStateService.Shard</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getQueryCachingPolicy()">getQueryCachingPolicy</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">org.apache.lucene.search.QueryCachingPolicy</span>&nbsp;<span class="memberName">getQueryCachingPolicy</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="updateShardState(org.elasticsearch.cluster.routing.ShardRouting,long,java.util.function.BiConsumer,long,java.util.Set,org.elasticsearch.cluster.routing.IndexShardRoutingTable)">updateShardState</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">updateShardState</span>&#8203;(<span class="arguments"><a href="../../cluster/routing/ShardRouting.html" title="class in org.elasticsearch.cluster.routing">ShardRouting</a>&nbsp;newRouting,
long&nbsp;newPrimaryTerm,
java.util.function.BiConsumer&lt;<a href="IndexShard.html" title="class in org.elasticsearch.index.shard">IndexShard</a>,&#8203;<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="PrimaryReplicaSyncer.ResyncTask.html" title="class in org.elasticsearch.index.shard">PrimaryReplicaSyncer.ResyncTask</a>&gt;&gt;&nbsp;primaryReplicaSyncer,
long&nbsp;applyingClusterStateVersion,
java.util.Set&lt;java.lang.String&gt;&nbsp;inSyncAllocationIds,
<a href="../../cluster/routing/IndexShardRoutingTable.html" title="class in org.elasticsearch.cluster.routing">IndexShardRoutingTable</a>&nbsp;routingTable)</span>
                      throws <span class="exceptions">java.io.IOException</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html#updateShardState(org.elasticsearch.cluster.routing.ShardRouting,long,java.util.function.BiConsumer,long,java.util.Set,org.elasticsearch.cluster.routing.IndexShardRoutingTable)">IndicesClusterStateService.Shard</a></code></span></div>
<div class="block">Updates the shard state based on an incoming cluster state:
 - Updates and persists the new routing value.
 - Updates the primary term if this shard is a primary.
 - Updates the allocation ids that are tracked by the shard if it is a primary.
   See <a href="../seqno/ReplicationTracker.html#updateFromMaster(long,java.util.Set,org.elasticsearch.cluster.routing.IndexShardRoutingTable)"><code>ReplicationTracker.updateFromMaster(long, Set, IndexShardRoutingTable)</code></a> for details.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html#updateShardState(org.elasticsearch.cluster.routing.ShardRouting,long,java.util.function.BiConsumer,long,java.util.Set,org.elasticsearch.cluster.routing.IndexShardRoutingTable)">updateShardState</a></code>&nbsp;in interface&nbsp;<code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html" title="interface in org.elasticsearch.indices.cluster">IndicesClusterStateService.Shard</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>newRouting</code> - the new routing entry</dd>
<dd><code>newPrimaryTerm</code> - the new primary term</dd>
<dd><code>primaryReplicaSyncer</code> - the primary-replica resync action to trigger when a term is increased on a primary</dd>
<dd><code>applyingClusterStateVersion</code> - the cluster state version being applied when updating the allocation IDs from the master</dd>
<dd><code>inSyncAllocationIds</code> - the allocation ids of the currently in-sync shard copies</dd>
<dd><code>routingTable</code> - the shard routing table</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if shard state could not be persisted</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="markAsRecovering(java.lang.String,org.elasticsearch.indices.recovery.RecoveryState)">markAsRecovering</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="IndexShardState.html" title="enum in org.elasticsearch.index.shard">IndexShardState</a></span>&nbsp;<span class="memberName">markAsRecovering</span>&#8203;(<span class="arguments">java.lang.String&nbsp;reason,
<a href="../../indices/recovery/RecoveryState.html" title="class in org.elasticsearch.indices.recovery">RecoveryState</a>&nbsp;recoveryState)</span>
                                 throws <span class="exceptions"><a href="IndexShardStartedException.html" title="class in org.elasticsearch.index.shard">IndexShardStartedException</a>,
<a href="IndexShardRelocatedException.html" title="class in org.elasticsearch.index.shard">IndexShardRelocatedException</a>,
<a href="IndexShardRecoveringException.html" title="class in org.elasticsearch.index.shard">IndexShardRecoveringException</a>,
<a href="IndexShardClosedException.html" title="class in org.elasticsearch.index.shard">IndexShardClosedException</a></span></div>
<div class="block">Marks the shard as recovering based on a recovery state, fails with exception is recovering is not allowed to be set.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="IndexShardStartedException.html" title="class in org.elasticsearch.index.shard">IndexShardStartedException</a></code></dd>
<dd><code><a href="IndexShardRelocatedException.html" title="class in org.elasticsearch.index.shard">IndexShardRelocatedException</a></code></dd>
<dd><code><a href="IndexShardRecoveringException.html" title="class in org.elasticsearch.index.shard">IndexShardRecoveringException</a></code></dd>
<dd><code><a href="IndexShardClosedException.html" title="class in org.elasticsearch.index.shard">IndexShardClosedException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="relocated(java.lang.String,java.util.function.BiConsumer,org.elasticsearch.action.ActionListener)">relocated</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">relocated</span>&#8203;(<span class="arguments">java.lang.String&nbsp;targetAllocationId,
java.util.function.BiConsumer&lt;<a href="../seqno/ReplicationTracker.PrimaryContext.html" title="class in org.elasticsearch.index.seqno">ReplicationTracker.PrimaryContext</a>,&#8203;<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Void&gt;&gt;&nbsp;consumer,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Void&gt;&nbsp;listener)</span>
               throws <span class="exceptions"><a href="IllegalIndexShardStateException.html" title="class in org.elasticsearch.index.shard">IllegalIndexShardStateException</a>,
java.lang.IllegalStateException</span></div>
<div class="block">Completes the relocation. Operations are blocked and current operations are drained before changing state to relocated. The provided
 <code>BiConsumer</code> is executed after all operations are successfully blocked.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>consumer</code> - a <code>BiConsumer</code> that is executed after operations are blocked and that consumes the primary context as well as
                 a listener to resolve once it finished</dd>
<dd><code>listener</code> - listener to resolve once this method actions including executing <code>consumer</code> in the non-failure case complete</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="IllegalIndexShardStateException.html" title="class in org.elasticsearch.index.shard">IllegalIndexShardStateException</a></code> - if the shard is not relocating due to concurrent cancellation</dd>
<dd><code>java.lang.IllegalStateException</code> - if the relocation target is no longer part of the replication group</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="state()">state</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="IndexShardState.html" title="enum in org.elasticsearch.index.shard">IndexShardState</a></span>&nbsp;<span class="memberName">state</span>()</div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html#state()">IndicesClusterStateService.Shard</a></code></span></div>
<div class="block">Returns the latest internal shard state.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html#state()">state</a></code>&nbsp;in interface&nbsp;<code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html" title="interface in org.elasticsearch.indices.cluster">IndicesClusterStateService.Shard</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="applyIndexOperationOnPrimary(long,org.elasticsearch.index.VersionType,org.elasticsearch.index.mapper.SourceToParse,long,long,long,boolean)">applyIndexOperationOnPrimary</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.IndexResult.html" title="class in org.elasticsearch.index.engine">Engine.IndexResult</a></span>&nbsp;<span class="memberName">applyIndexOperationOnPrimary</span>&#8203;(<span class="arguments">long&nbsp;version,
<a href="../VersionType.html" title="enum in org.elasticsearch.index">VersionType</a>&nbsp;versionType,
<a href="../mapper/SourceToParse.html" title="class in org.elasticsearch.index.mapper">SourceToParse</a>&nbsp;sourceToParse,
long&nbsp;ifSeqNo,
long&nbsp;ifPrimaryTerm,
long&nbsp;autoGeneratedTimestamp,
boolean&nbsp;isRetry)</span>
                                                throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="applyIndexOperationOnReplica(long,long,long,long,boolean,org.elasticsearch.index.mapper.SourceToParse)">applyIndexOperationOnReplica</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.IndexResult.html" title="class in org.elasticsearch.index.engine">Engine.IndexResult</a></span>&nbsp;<span class="memberName">applyIndexOperationOnReplica</span>&#8203;(<span class="arguments">long&nbsp;seqNo,
long&nbsp;opPrimaryTerm,
long&nbsp;version,
long&nbsp;autoGeneratedTimeStamp,
boolean&nbsp;isRetry,
<a href="../mapper/SourceToParse.html" title="class in org.elasticsearch.index.mapper">SourceToParse</a>&nbsp;sourceToParse)</span>
                                                throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="prepareIndex(org.elasticsearch.index.mapper.DocumentMapperForType,org.elasticsearch.index.mapper.SourceToParse,long,long,long,org.elasticsearch.index.VersionType,org.elasticsearch.index.engine.Engine.Operation.Origin,long,boolean,long,long)">prepareIndex</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType"><a href="../engine/Engine.Index.html" title="class in org.elasticsearch.index.engine">Engine.Index</a></span>&nbsp;<span class="memberName">prepareIndex</span>&#8203;(<span class="arguments"><a href="../mapper/DocumentMapperForType.html" title="class in org.elasticsearch.index.mapper">DocumentMapperForType</a>&nbsp;docMapper,
<a href="../mapper/SourceToParse.html" title="class in org.elasticsearch.index.mapper">SourceToParse</a>&nbsp;source,
long&nbsp;seqNo,
long&nbsp;primaryTerm,
long&nbsp;version,
<a href="../VersionType.html" title="enum in org.elasticsearch.index">VersionType</a>&nbsp;versionType,
<a href="../engine/Engine.Operation.Origin.html" title="enum in org.elasticsearch.index.engine">Engine.Operation.Origin</a>&nbsp;origin,
long&nbsp;autoGeneratedIdTimestamp,
boolean&nbsp;isRetry,
long&nbsp;ifSeqNo,
long&nbsp;ifPrimaryTerm)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="markSeqNoAsNoop(long,long,java.lang.String)">markSeqNoAsNoop</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.NoOpResult.html" title="class in org.elasticsearch.index.engine">Engine.NoOpResult</a></span>&nbsp;<span class="memberName">markSeqNoAsNoop</span>&#8203;(<span class="arguments">long&nbsp;seqNo,
long&nbsp;opPrimaryTerm,
java.lang.String&nbsp;reason)</span>
                                  throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getFailedIndexResult(java.lang.Exception,long)">getFailedIndexResult</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.IndexResult.html" title="class in org.elasticsearch.index.engine">Engine.IndexResult</a></span>&nbsp;<span class="memberName">getFailedIndexResult</span>&#8203;(<span class="arguments">java.lang.Exception&nbsp;e,
long&nbsp;version)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getFailedDeleteResult(java.lang.Exception,long)">getFailedDeleteResult</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.DeleteResult.html" title="class in org.elasticsearch.index.engine">Engine.DeleteResult</a></span>&nbsp;<span class="memberName">getFailedDeleteResult</span>&#8203;(<span class="arguments">java.lang.Exception&nbsp;e,
long&nbsp;version)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="applyDeleteOperationOnPrimary(long,java.lang.String,java.lang.String,org.elasticsearch.index.VersionType,long,long)">applyDeleteOperationOnPrimary</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.DeleteResult.html" title="class in org.elasticsearch.index.engine">Engine.DeleteResult</a></span>&nbsp;<span class="memberName">applyDeleteOperationOnPrimary</span>&#8203;(<span class="arguments">long&nbsp;version,
java.lang.String&nbsp;type,
java.lang.String&nbsp;id,
<a href="../VersionType.html" title="enum in org.elasticsearch.index">VersionType</a>&nbsp;versionType,
long&nbsp;ifSeqNo,
long&nbsp;ifPrimaryTerm)</span>
                                                  throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="applyDeleteOperationOnReplica(long,long,long,java.lang.String,java.lang.String)">applyDeleteOperationOnReplica</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.DeleteResult.html" title="class in org.elasticsearch.index.engine">Engine.DeleteResult</a></span>&nbsp;<span class="memberName">applyDeleteOperationOnReplica</span>&#8203;(<span class="arguments">long&nbsp;seqNo,
long&nbsp;opPrimaryTerm,
long&nbsp;version,
java.lang.String&nbsp;type,
java.lang.String&nbsp;id)</span>
                                                  throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="get(org.elasticsearch.index.engine.Engine.Get)">get</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.GetResult.html" title="class in org.elasticsearch.index.engine">Engine.GetResult</a></span>&nbsp;<span class="memberName">get</span>&#8203;(<span class="arguments"><a href="../engine/Engine.Get.html" title="class in org.elasticsearch.index.engine">Engine.Get</a>&nbsp;get)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="refresh(java.lang.String)">refresh</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">refresh</span>&#8203;(<span class="arguments">java.lang.String&nbsp;source)</span></div>
<div class="block">Writes all indexing changes to disk and opens a new searcher reflecting all changes.  This can throw <code>AlreadyClosedException</code>.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getWritingBytes()">getWritingBytes</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getWritingBytes</span>()</div>
<div class="block">Returns how many bytes we are currently moving from heap to disk</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="refreshStats()">refreshStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../refresh/RefreshStats.html" title="class in org.elasticsearch.index.refresh">RefreshStats</a></span>&nbsp;<span class="memberName">refreshStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="flushStats()">flushStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../flush/FlushStats.html" title="class in org.elasticsearch.index.flush">FlushStats</a></span>&nbsp;<span class="memberName">flushStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="docStats()">docStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="DocsStats.html" title="class in org.elasticsearch.index.shard">DocsStats</a></span>&nbsp;<span class="memberName">docStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="commitStats()">commitStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/CommitStats.html" title="class in org.elasticsearch.index.engine">CommitStats</a></span>&nbsp;<span class="memberName">commitStats</span>()</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="../engine/CommitStats.html" title="class in org.elasticsearch.index.engine"><code>CommitStats</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>org.apache.lucene.store.AlreadyClosedException</code> - if shard is closed</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="seqNoStats()">seqNoStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../seqno/SeqNoStats.html" title="class in org.elasticsearch.index.seqno">SeqNoStats</a></span>&nbsp;<span class="memberName">seqNoStats</span>()</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><a href="../seqno/SeqNoStats.html" title="class in org.elasticsearch.index.seqno"><code>SeqNoStats</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>org.apache.lucene.store.AlreadyClosedException</code> - if shard is closed</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="indexingStats(java.lang.String...)">indexingStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="IndexingStats.html" title="class in org.elasticsearch.index.shard">IndexingStats</a></span>&nbsp;<span class="memberName">indexingStats</span>&#8203;(<span class="arguments">java.lang.String...&nbsp;types)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="searchStats(java.lang.String...)">searchStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../search/stats/SearchStats.html" title="class in org.elasticsearch.index.search.stats">SearchStats</a></span>&nbsp;<span class="memberName">searchStats</span>&#8203;(<span class="arguments">java.lang.String...&nbsp;groups)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getStats()">getStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../get/GetStats.html" title="class in org.elasticsearch.index.get">GetStats</a></span>&nbsp;<span class="memberName">getStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="storeStats()">storeStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../store/StoreStats.html" title="class in org.elasticsearch.index.store">StoreStats</a></span>&nbsp;<span class="memberName">storeStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="mergeStats()">mergeStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../merge/MergeStats.html" title="class in org.elasticsearch.index.merge">MergeStats</a></span>&nbsp;<span class="memberName">mergeStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="segmentStats(boolean,boolean)">segmentStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/SegmentsStats.html" title="class in org.elasticsearch.index.engine">SegmentsStats</a></span>&nbsp;<span class="memberName">segmentStats</span>&#8203;(<span class="arguments">boolean&nbsp;includeSegmentFileSizes,
boolean&nbsp;includeUnloadedSegments)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="warmerStats()">warmerStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../warmer/WarmerStats.html" title="class in org.elasticsearch.index.warmer">WarmerStats</a></span>&nbsp;<span class="memberName">warmerStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="fieldDataStats(java.lang.String...)">fieldDataStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../fielddata/FieldDataStats.html" title="class in org.elasticsearch.index.fielddata">FieldDataStats</a></span>&nbsp;<span class="memberName">fieldDataStats</span>&#8203;(<span class="arguments">java.lang.String...&nbsp;fields)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="translogStats()">translogStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../translog/TranslogStats.html" title="class in org.elasticsearch.index.translog">TranslogStats</a></span>&nbsp;<span class="memberName">translogStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="completionStats(java.lang.String...)">completionStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../../search/suggest/completion/CompletionStats.html" title="class in org.elasticsearch.search.suggest.completion">CompletionStats</a></span>&nbsp;<span class="memberName">completionStats</span>&#8203;(<span class="arguments">java.lang.String...&nbsp;fields)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="syncFlush(java.lang.String,org.elasticsearch.index.engine.Engine.CommitId)">syncFlush</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.SyncedFlushResult.html" title="enum in org.elasticsearch.index.engine">Engine.SyncedFlushResult</a></span>&nbsp;<span class="memberName">syncFlush</span>&#8203;(<span class="arguments">java.lang.String&nbsp;syncId,
<a href="../engine/Engine.CommitId.html" title="class in org.elasticsearch.index.engine">Engine.CommitId</a>&nbsp;expectedCommitId)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="flush(org.elasticsearch.action.admin.indices.flush.FlushRequest)">flush</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.CommitId.html" title="class in org.elasticsearch.index.engine">Engine.CommitId</a></span>&nbsp;<span class="memberName">flush</span>&#8203;(<span class="arguments"><a href="../../action/admin/indices/flush/FlushRequest.html" title="class in org.elasticsearch.action.admin.indices.flush">FlushRequest</a>&nbsp;request)</span></div>
<div class="block">Executes the given flush request against the engine.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>request</code> - the flush request</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the commit ID</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="trimTranslog()">trimTranslog</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">trimTranslog</span>()</div>
<div class="block">checks and removes translog files that no longer need to be retained. See
 <a href="../translog/TranslogDeletionPolicy.html" title="class in org.elasticsearch.index.translog"><code>TranslogDeletionPolicy</code></a> for details</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="rollTranslogGeneration()">rollTranslogGeneration</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">rollTranslogGeneration</span>()</div>
<div class="block">Rolls the tranlog generation and cleans unneeded.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="forceMerge(org.elasticsearch.action.admin.indices.forcemerge.ForceMergeRequest)">forceMerge</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">forceMerge</span>&#8203;(<span class="arguments"><a href="../../action/admin/indices/forcemerge/ForceMergeRequest.html" title="class in org.elasticsearch.action.admin.indices.forcemerge">ForceMergeRequest</a>&nbsp;forceMerge)</span>
                throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="upgrade(org.elasticsearch.action.admin.indices.upgrade.post.UpgradeRequest)">upgrade</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">org.apache.lucene.util.Version</span>&nbsp;<span class="memberName">upgrade</span>&#8203;(<span class="arguments"><a href="../../action/admin/indices/upgrade/post/UpgradeRequest.html" title="class in org.elasticsearch.action.admin.indices.upgrade.post">UpgradeRequest</a>&nbsp;upgrade)</span>
                                       throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Upgrades the shard to the current version of Lucene and returns the minimum segment version</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="minimumCompatibleVersion()">minimumCompatibleVersion</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">org.apache.lucene.util.Version</span>&nbsp;<span class="memberName">minimumCompatibleVersion</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireLastIndexCommit(boolean)">acquireLastIndexCommit</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.IndexCommitRef.html" title="class in org.elasticsearch.index.engine">Engine.IndexCommitRef</a></span>&nbsp;<span class="memberName">acquireLastIndexCommit</span>&#8203;(<span class="arguments">boolean&nbsp;flushFirst)</span>
                                             throws <span class="exceptions"><a href="../engine/EngineException.html" title="class in org.elasticsearch.index.engine">EngineException</a></span></div>
<div class="block">Creates a new <code>IndexCommit</code> snapshot from the currently running engine. All resources referenced by this
 commit won't be freed until the commit / snapshot is closed.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>flushFirst</code> - <code>true</code> if the index should first be flushed to disk / a low level lucene commit should be executed</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../engine/EngineException.html" title="class in org.elasticsearch.index.engine">EngineException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireIndexCommitForSnapshot()">acquireIndexCommitForSnapshot</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.IndexCommitRef.html" title="class in org.elasticsearch.index.engine">Engine.IndexCommitRef</a></span>&nbsp;<span class="memberName">acquireIndexCommitForSnapshot</span>()
                                                    throws <span class="exceptions"><a href="../engine/EngineException.html" title="class in org.elasticsearch.index.engine">EngineException</a></span></div>
<div class="block">Acquires the <code>IndexCommit</code> which should be included in a snapshot.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../engine/EngineException.html" title="class in org.elasticsearch.index.engine">EngineException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireSafeIndexCommit()">acquireSafeIndexCommit</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.IndexCommitRef.html" title="class in org.elasticsearch.index.engine">Engine.IndexCommitRef</a></span>&nbsp;<span class="memberName">acquireSafeIndexCommit</span>()
                                             throws <span class="exceptions"><a href="../engine/EngineException.html" title="class in org.elasticsearch.index.engine">EngineException</a></span></div>
<div class="block">Snapshots the most recent safe index commit from the currently running engine.
 All index files referenced by this index commit won't be freed until the commit/snapshot is closed.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../engine/EngineException.html" title="class in org.elasticsearch.index.engine">EngineException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="snapshotStoreMetadata()">snapshotStoreMetadata</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../store/Store.MetadataSnapshot.html" title="class in org.elasticsearch.index.store">Store.MetadataSnapshot</a></span>&nbsp;<span class="memberName">snapshotStoreMetadata</span>()
                                             throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">gets a <a href="../store/Store.MetadataSnapshot.html" title="class in org.elasticsearch.index.store"><code>Store.MetadataSnapshot</code></a> for the current directory. This method is safe to call in all lifecycle of the index shard,
 without having to worry about the current state of the engine and concurrent flushes.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>org.apache.lucene.index.IndexNotFoundException</code> - if no index is found in the current directory</dd>
<dd><code>org.apache.lucene.index.CorruptIndexException</code> - if the lucene index is corrupted. This can be caused by a checksum
                                                            mismatch or an unexpected exception when opening the index reading the
                                                            segments file.</dd>
<dd><code>org.apache.lucene.index.IndexFormatTooOldException</code> - if the lucene index is too old to be opened.</dd>
<dd><code>org.apache.lucene.index.IndexFormatTooNewException</code> - if the lucene index is too new to be opened.</dd>
<dd><code>java.io.FileNotFoundException</code> - if one or more files referenced by a commit are not present.</dd>
<dd><code>java.nio.file.NoSuchFileException</code> - if one or more files referenced by a commit are not present.</dd>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="failShard(java.lang.String,java.lang.Exception)">failShard</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">failShard</span>&#8203;(<span class="arguments">java.lang.String&nbsp;reason,
@Nullable
java.lang.Exception&nbsp;e)</span></div>
<div class="block">Fails the shard and marks the shard store as corrupted if
 <code>e</code> is caused by index corruption</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireSearcherSupplier()">acquireSearcherSupplier</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.SearcherSupplier.html" title="class in org.elasticsearch.index.engine">Engine.SearcherSupplier</a></span>&nbsp;<span class="memberName">acquireSearcherSupplier</span>()</div>
<div class="block">Acquires a point-in-time reader that can be used to create <a href="../engine/Engine.Searcher.html" title="class in org.elasticsearch.index.engine"><code>Engine.Searcher</code></a>s on demand.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireSearcherSupplier(org.elasticsearch.index.engine.Engine.SearcherScope)">acquireSearcherSupplier</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.SearcherSupplier.html" title="class in org.elasticsearch.index.engine">Engine.SearcherSupplier</a></span>&nbsp;<span class="memberName">acquireSearcherSupplier</span>&#8203;(<span class="arguments"><a href="../engine/Engine.SearcherScope.html" title="enum in org.elasticsearch.index.engine">Engine.SearcherScope</a>&nbsp;scope)</span></div>
<div class="block">Acquires a point-in-time reader that can be used to create <a href="../engine/Engine.Searcher.html" title="class in org.elasticsearch.index.engine"><code>Engine.Searcher</code></a>s on demand.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireSearcher(java.lang.String)">acquireSearcher</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.Searcher.html" title="class in org.elasticsearch.index.engine">Engine.Searcher</a></span>&nbsp;<span class="memberName">acquireSearcher</span>&#8203;(<span class="arguments">java.lang.String&nbsp;source)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="close(java.lang.String,boolean)">close</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">close</span>&#8203;(<span class="arguments">java.lang.String&nbsp;reason,
boolean&nbsp;flushEngine)</span>
           throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="preRecovery()">preRecovery</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">preRecovery</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="postRecovery(java.lang.String)">postRecovery</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">postRecovery</span>&#8203;(<span class="arguments">java.lang.String&nbsp;reason)</span>
                  throws <span class="exceptions"><a href="IndexShardStartedException.html" title="class in org.elasticsearch.index.shard">IndexShardStartedException</a>,
<a href="IndexShardRelocatedException.html" title="class in org.elasticsearch.index.shard">IndexShardRelocatedException</a>,
<a href="IndexShardClosedException.html" title="class in org.elasticsearch.index.shard">IndexShardClosedException</a></span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="IndexShardStartedException.html" title="class in org.elasticsearch.index.shard">IndexShardStartedException</a></code></dd>
<dd><code><a href="IndexShardRelocatedException.html" title="class in org.elasticsearch.index.shard">IndexShardRelocatedException</a></code></dd>
<dd><code><a href="IndexShardClosedException.html" title="class in org.elasticsearch.index.shard">IndexShardClosedException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="prepareForIndexRecovery()">prepareForIndexRecovery</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">prepareForIndexRecovery</span>()</div>
<div class="block">called before starting to copy index files over</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="recoverLocallyUpToGlobalCheckpoint()">recoverLocallyUpToGlobalCheckpoint</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">recoverLocallyUpToGlobalCheckpoint</span>()</div>
<div class="block">A best effort to bring up this shard to the global checkpoint using the local translog before performing a peer recovery.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a sequence number that an operation-based peer recovery can start with.
 This is the first operation after the local checkpoint of the safe commit if exists.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="trimOperationOfPreviousPrimaryTerms(long)">trimOperationOfPreviousPrimaryTerms</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">trimOperationOfPreviousPrimaryTerms</span>&#8203;(<span class="arguments">long&nbsp;aboveSeqNo)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getMaxSeenAutoIdTimestamp()">getMaxSeenAutoIdTimestamp</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getMaxSeenAutoIdTimestamp</span>()</div>
<div class="block">Returns the maximum auto_id_timestamp of all append-only requests have been processed by this shard or the auto_id_timestamp received
 from the primary via <a href="#updateMaxUnsafeAutoIdTimestamp(long)"><code>updateMaxUnsafeAutoIdTimestamp(long)</code></a> at the beginning of a peer-recovery or a primary-replica resync.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#updateMaxUnsafeAutoIdTimestamp(long)"><code>updateMaxUnsafeAutoIdTimestamp(long)</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="updateMaxUnsafeAutoIdTimestamp(long)">updateMaxUnsafeAutoIdTimestamp</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">updateMaxUnsafeAutoIdTimestamp</span>&#8203;(<span class="arguments">long&nbsp;maxSeenAutoIdTimestampFromPrimary)</span></div>
<div class="block">Since operations stored in soft-deletes do not have max_auto_id_timestamp, the primary has to propagate its max_auto_id_timestamp
 (via <a href="#getMaxSeenAutoIdTimestamp()"><code>getMaxSeenAutoIdTimestamp()</code></a> of all processed append-only requests to replicas at the beginning of a peer-recovery
 or a primary-replica resync to force a replica to disable optimization for all append-only requests which are replicated via
 replication while its retry variants are replicated via recovery without auto_id_timestamp.
 <p>
 Without this force-update, a replica can generate duplicate documents (for the same id) if it first receives
 a retry append-only (without timestamp) via recovery, then an original append-only (with timestamp) via replication.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="applyTranslogOperation(org.elasticsearch.index.translog.Translog.Operation,org.elasticsearch.index.engine.Engine.Operation.Origin)">applyTranslogOperation</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../engine/Engine.Result.html" title="class in org.elasticsearch.index.engine">Engine.Result</a></span>&nbsp;<span class="memberName">applyTranslogOperation</span>&#8203;(<span class="arguments"><a href="../translog/Translog.Operation.html" title="interface in org.elasticsearch.index.translog">Translog.Operation</a>&nbsp;operation,
<a href="../engine/Engine.Operation.Origin.html" title="enum in org.elasticsearch.index.engine">Engine.Operation.Origin</a>&nbsp;origin)</span>
                                     throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="openEngineAndRecoverFromTranslog()">openEngineAndRecoverFromTranslog</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">openEngineAndRecoverFromTranslog</span>()
                                      throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">opens the engine on top of the existing lucene engine and translog.
 Operations from the translog will be replayed to bring lucene up to date.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="openEngineAndSkipTranslogRecovery()">openEngineAndSkipTranslogRecovery</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">openEngineAndSkipTranslogRecovery</span>()
                                       throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Opens the engine on top of the existing lucene engine and translog.
 The translog is kept but its operations won't be replayed.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="performRecoveryRestart()">performRecoveryRestart</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">performRecoveryRestart</span>()
                            throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">called if recovery has to be restarted after network error / delay **</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="resetRecoveryStage()">resetRecoveryStage</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">resetRecoveryStage</span>()</div>
<div class="block">If a file-based recovery occurs, a recovery target calls this method to reset the recovery stage.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="recoveryStats()">recoveryStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../recovery/RecoveryStats.html" title="class in org.elasticsearch.index.recovery">RecoveryStats</a></span>&nbsp;<span class="memberName">recoveryStats</span>()</div>
<div class="block">returns stats about ongoing recoveries, both source and target</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="recoveryState()">recoveryState</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../../indices/recovery/RecoveryState.html" title="class in org.elasticsearch.indices.recovery">RecoveryState</a></span>&nbsp;<span class="memberName">recoveryState</span>()</div>
<div class="block">Returns the current <a href="../../indices/recovery/RecoveryState.html" title="class in org.elasticsearch.indices.recovery"><code>RecoveryState</code></a> if this shard is recovering or has been recovering.
 Returns null if the recovery has not yet started or shard was not recovered (created via an API).</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html#recoveryState()">recoveryState</a></code>&nbsp;in interface&nbsp;<code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html" title="interface in org.elasticsearch.indices.cluster">IndicesClusterStateService.Shard</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getTimestampMillisRange()">getTimestampMillisRange</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="ShardLongFieldRange.html" title="class in org.elasticsearch.index.shard">ShardLongFieldRange</a></span>&nbsp;<span class="memberName">getTimestampMillisRange</span>()</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html#getTimestampMillisRange()">getTimestampMillisRange</a></code>&nbsp;in interface&nbsp;<code><a href="../../indices/cluster/IndicesClusterStateService.Shard.html" title="interface in org.elasticsearch.indices.cluster">IndicesClusterStateService.Shard</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the range of the <code>@timestamp</code> field for this shard, in milliseconds since the epoch, or <a href="ShardLongFieldRange.html#EMPTY"><code>ShardLongFieldRange.EMPTY</code></a> if this field is not found, or <a href="ShardLongFieldRange.html#UNKNOWN"><code>ShardLongFieldRange.UNKNOWN</code></a> if its range is not fixed.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="finalizeRecovery()">finalizeRecovery</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">finalizeRecovery</span>()</div>
<div class="block">perform the last stages of recovery once all translog operations are done.
 note that you should still call <a href="#postRecovery(java.lang.String)"><code>postRecovery(String)</code></a>.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="ignoreRecoveryAttempt()">ignoreRecoveryAttempt</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">ignoreRecoveryAttempt</span>()</div>
<div class="block">Returns <code>true</code> if this shard can ignore a recovery attempt made to it (since the already doing/done it)</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="readAllowed()">readAllowed</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">readAllowed</span>()
                 throws <span class="exceptions"><a href="IllegalIndexShardStateException.html" title="class in org.elasticsearch.index.shard">IllegalIndexShardStateException</a></span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="IllegalIndexShardStateException.html" title="class in org.elasticsearch.index.shard">IllegalIndexShardStateException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isReadAllowed()">isReadAllowed</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">isReadAllowed</span>()</div>
<div class="block">returns true if the <a href="IndexShardState.html" title="enum in org.elasticsearch.index.shard"><code>IndexShardState</code></a> allows reading</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="verifyActive()">verifyActive</a></h3>
<div class="memberSignature"><span class="modifiers">protected final</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">verifyActive</span>()
                           throws <span class="exceptions"><a href="IllegalIndexShardStateException.html" title="class in org.elasticsearch.index.shard">IllegalIndexShardStateException</a></span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="IllegalIndexShardStateException.html" title="class in org.elasticsearch.index.shard">IllegalIndexShardStateException</a></code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getIndexBufferRAMBytesUsed()">getIndexBufferRAMBytesUsed</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getIndexBufferRAMBytesUsed</span>()</div>
<div class="block">Returns number of heap bytes used by the indexing buffer for this shard, or 0 if the shard is closed</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addShardFailureCallback(java.util.function.Consumer)">addShardFailureCallback</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">addShardFailureCallback</span>&#8203;(<span class="arguments">java.util.function.Consumer&lt;<a href="IndexShard.ShardFailure.html" title="class in org.elasticsearch.index.shard">IndexShard.ShardFailure</a>&gt;&nbsp;onShardFailure)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="checkIdle(long)">checkIdle</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">checkIdle</span>&#8203;(<span class="arguments">long&nbsp;inactiveTimeNS)</span></div>
<div class="block">Called by <a href="../../indices/IndexingMemoryController.html" title="class in org.elasticsearch.indices"><code>IndexingMemoryController</code></a> to check whether more than <code>inactiveTimeNS</code> has passed since the last
 indexing operation, and notify listeners that we are now inactive so e.g. sync'd flush can happen.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isActive()">isActive</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">isActive</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="shardPath()">shardPath</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="ShardPath.html" title="class in org.elasticsearch.index.shard">ShardPath</a></span>&nbsp;<span class="memberName">shardPath</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="recoverFromLocalShards(java.util.function.BiConsumer,java.util.List,org.elasticsearch.action.ActionListener)">recoverFromLocalShards</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">recoverFromLocalShards</span>&#8203;(<span class="arguments">java.util.function.BiConsumer&lt;java.lang.String,&#8203;<a href="../../cluster/metadata/MappingMetadata.html" title="class in org.elasticsearch.cluster.metadata">MappingMetadata</a>&gt;&nbsp;mappingUpdateConsumer,
java.util.List&lt;<a href="IndexShard.html" title="class in org.elasticsearch.index.shard">IndexShard</a>&gt;&nbsp;localShards,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Boolean&gt;&nbsp;listener)</span>
                            throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="recoverFromStore(org.elasticsearch.action.ActionListener)">recoverFromStore</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">recoverFromStore</span>&#8203;(<span class="arguments"><a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Boolean&gt;&nbsp;listener)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="restoreFromRepository(org.elasticsearch.repositories.Repository,org.elasticsearch.action.ActionListener)">restoreFromRepository</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">restoreFromRepository</span>&#8203;(<span class="arguments"><a href="../../repositories/Repository.html" title="interface in org.elasticsearch.repositories">Repository</a>&nbsp;repository,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;java.lang.Boolean&gt;&nbsp;listener)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="onSettingsChanged()">onSettingsChanged</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">onSettingsChanged</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireHistoryRetentionLock(org.elasticsearch.index.engine.Engine.HistorySource)">acquireHistoryRetentionLock</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.io.Closeable</span>&nbsp;<span class="memberName">acquireHistoryRetentionLock</span>&#8203;(<span class="arguments"><a href="../engine/Engine.HistorySource.html" title="enum in org.elasticsearch.index.engine">Engine.HistorySource</a>&nbsp;source)</span></div>
<div class="block">Acquires a lock on the translog files and Lucene soft-deleted documents to prevent them from being trimmed</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="estimateNumberOfHistoryOperations(java.lang.String,org.elasticsearch.index.engine.Engine.HistorySource,long)">estimateNumberOfHistoryOperations</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">estimateNumberOfHistoryOperations</span>&#8203;(<span class="arguments">java.lang.String&nbsp;reason,
<a href="../engine/Engine.HistorySource.html" title="enum in org.elasticsearch.index.engine">Engine.HistorySource</a>&nbsp;source,
long&nbsp;startingSeqNo)</span>
                                      throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Returns the estimated number of history operations whose seq# at least the provided seq# in this shard.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getHistoryOperations(java.lang.String,org.elasticsearch.index.engine.Engine.HistorySource,long)">getHistoryOperations</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../translog/Translog.Snapshot.html" title="interface in org.elasticsearch.index.translog">Translog.Snapshot</a></span>&nbsp;<span class="memberName">getHistoryOperations</span>&#8203;(<span class="arguments">java.lang.String&nbsp;reason,
<a href="../engine/Engine.HistorySource.html" title="enum in org.elasticsearch.index.engine">Engine.HistorySource</a>&nbsp;source,
long&nbsp;startingSeqNo)</span>
                                       throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Creates a new history snapshot for reading operations since the provided starting seqno (inclusive).
 The returned snapshot can be retrieved from either Lucene index or translog files.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="hasCompleteHistoryOperations(java.lang.String,org.elasticsearch.index.engine.Engine.HistorySource,long)">hasCompleteHistoryOperations</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">hasCompleteHistoryOperations</span>&#8203;(<span class="arguments">java.lang.String&nbsp;reason,
<a href="../engine/Engine.HistorySource.html" title="enum in org.elasticsearch.index.engine">Engine.HistorySource</a>&nbsp;source,
long&nbsp;startingSeqNo)</span>
                                     throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Checks if we have a completed history of operations since the given starting seqno (inclusive).
 This method should be called after acquiring the retention lock; See <a href="#acquireHistoryRetentionLock(org.elasticsearch.index.engine.Engine.HistorySource)"><code>acquireHistoryRetentionLock(Engine.HistorySource)</code></a></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getMinRetainedSeqNo()">getMinRetainedSeqNo</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getMinRetainedSeqNo</span>()</div>
<div class="block">Gets the minimum retained sequence number for this engine.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the minimum retained sequence number</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="newChangesSnapshot(java.lang.String,long,long,boolean)">newChangesSnapshot</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../translog/Translog.Snapshot.html" title="interface in org.elasticsearch.index.translog">Translog.Snapshot</a></span>&nbsp;<span class="memberName">newChangesSnapshot</span>&#8203;(<span class="arguments">java.lang.String&nbsp;source,
long&nbsp;fromSeqNo,
long&nbsp;toSeqNo,
boolean&nbsp;requiredFullRange)</span>
                                     throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Creates a new changes snapshot for reading operations whose seq_no are between <code>fromSeqNo</code>(inclusive)
 and <code>toSeqNo</code>(inclusive). The caller has to close the returned snapshot after finishing the reading.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>source</code> - the source of the request</dd>
<dd><code>fromSeqNo</code> - the from seq_no (inclusive) to read</dd>
<dd><code>toSeqNo</code> - the to seq_no (inclusive) to read</dd>
<dd><code>requiredFullRange</code> - if <code>true</code> then <a href="../translog/Translog.Snapshot.html#next()"><code>Translog.Snapshot.next()</code></a> will throw <code>IllegalStateException</code>
                          if any operation between <code>fromSeqNo</code> and <code>toSeqNo</code> is missing.
                          This parameter should be only enabled when the entire requesting range is below the global checkpoint.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="segments(boolean)">segments</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.List&lt;<a href="../engine/Segment.html" title="class in org.elasticsearch.index.engine">Segment</a>&gt;</span>&nbsp;<span class="memberName">segments</span>&#8203;(<span class="arguments">boolean&nbsp;verbose)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getHistoryUUID()">getHistoryUUID</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">getHistoryUUID</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getIndexEventListener()">getIndexEventListener</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="IndexEventListener.html" title="interface in org.elasticsearch.index.shard">IndexEventListener</a></span>&nbsp;<span class="memberName">getIndexEventListener</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="activateThrottling()">activateThrottling</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">activateThrottling</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="deactivateThrottling()">deactivateThrottling</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">deactivateThrottling</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="writeIndexingBuffer()">writeIndexingBuffer</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">writeIndexingBuffer</span>()</div>
<div class="block">Called when our shard is using too much heap and should move buffered indexed/deleted documents to disk.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="updateLocalCheckpointForShard(java.lang.String,long)">updateLocalCheckpointForShard</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">updateLocalCheckpointForShard</span>&#8203;(<span class="arguments">java.lang.String&nbsp;allocationId,
long&nbsp;checkpoint)</span></div>
<div class="block">Notifies the service to update the local checkpoint for the shard with the provided allocation ID. See
 <a href="../seqno/ReplicationTracker.html#updateLocalCheckpoint(java.lang.String,long)"><code>ReplicationTracker.updateLocalCheckpoint(String, long)</code></a> for
 details.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>allocationId</code> - the allocation ID of the shard to update the local checkpoint for</dd>
<dd><code>checkpoint</code> - the local checkpoint for the shard</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="updateGlobalCheckpointForShard(java.lang.String,long)">updateGlobalCheckpointForShard</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">updateGlobalCheckpointForShard</span>&#8203;(<span class="arguments">java.lang.String&nbsp;allocationId,
long&nbsp;globalCheckpoint)</span></div>
<div class="block">Update the local knowledge of the persisted global checkpoint for the specified allocation ID.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>allocationId</code> - the allocation ID to update the global checkpoint for</dd>
<dd><code>globalCheckpoint</code> - the global checkpoint</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addGlobalCheckpointListener(long,org.elasticsearch.index.shard.GlobalCheckpointListeners.GlobalCheckpointListener,org.elasticsearch.common.unit.TimeValue)">addGlobalCheckpointListener</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">addGlobalCheckpointListener</span>&#8203;(<span class="arguments">long&nbsp;waitingForGlobalCheckpoint,
<a href="GlobalCheckpointListeners.GlobalCheckpointListener.html" title="interface in org.elasticsearch.index.shard">GlobalCheckpointListeners.GlobalCheckpointListener</a>&nbsp;listener,
org.elasticsearch.common.unit.TimeValue&nbsp;timeout)</span></div>
<div class="block">Add a global checkpoint listener. If the global checkpoint is equal to or above the global checkpoint the listener is waiting for,
 then the listener will be notified immediately via an executor (so possibly not on the current thread). If the specified timeout
 elapses before the listener is notified, the listener will be notified with an <code>TimeoutException</code>. A caller may pass null to
 specify no timeout.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>waitingForGlobalCheckpoint</code> - the global checkpoint the listener is waiting for</dd>
<dd><code>listener</code> - the listener</dd>
<dd><code>timeout</code> - the timeout</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getRetentionLeases()">getRetentionLeases</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../seqno/RetentionLeases.html" title="class in org.elasticsearch.index.seqno">RetentionLeases</a></span>&nbsp;<span class="memberName">getRetentionLeases</span>()</div>
<div class="block">Get all retention leases tracked on this shard.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the retention leases</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getRetentionLeases(boolean)">getRetentionLeases</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">org.elasticsearch.common.collect.Tuple&lt;java.lang.Boolean,&#8203;<a href="../seqno/RetentionLeases.html" title="class in org.elasticsearch.index.seqno">RetentionLeases</a>&gt;</span>&nbsp;<span class="memberName">getRetentionLeases</span>&#8203;(<span class="arguments">boolean&nbsp;expireLeases)</span></div>
<div class="block">If the expire leases parameter is false, gets all retention leases tracked on this shard and otherwise first calculates
 expiration of existing retention leases, and then gets all non-expired retention leases tracked on this shard. Note that only the
 primary shard calculates which leases are expired, and if any have expired, syncs the retention leases to any replicas. If the
 expire leases parameter is true, this replication tracker must be in primary mode.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a tuple indicating whether or not any retention leases were expired, and the non-expired retention leases</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getRetentionLeaseStats()">getRetentionLeaseStats</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../seqno/RetentionLeaseStats.html" title="class in org.elasticsearch.index.seqno">RetentionLeaseStats</a></span>&nbsp;<span class="memberName">getRetentionLeaseStats</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addRetentionLease(java.lang.String,long,java.lang.String,org.elasticsearch.action.ActionListener)">addRetentionLease</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a></span>&nbsp;<span class="memberName">addRetentionLease</span>&#8203;(<span class="arguments">java.lang.String&nbsp;id,
long&nbsp;retainingSequenceNumber,
java.lang.String&nbsp;source,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</span></div>
<div class="block">Adds a new retention lease.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>id</code> - the identifier of the retention lease</dd>
<dd><code>retainingSequenceNumber</code> - the retaining sequence number</dd>
<dd><code>source</code> - the source of the retention lease</dd>
<dd><code>listener</code> - the callback when the retention lease is successfully added and synced to replicas</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the new retention lease</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if the specified retention lease already exists</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="renewRetentionLease(java.lang.String,long,java.lang.String)">renewRetentionLease</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a></span>&nbsp;<span class="memberName">renewRetentionLease</span>&#8203;(<span class="arguments">java.lang.String&nbsp;id,
long&nbsp;retainingSequenceNumber,
java.lang.String&nbsp;source)</span></div>
<div class="block">Renews an existing retention lease.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>id</code> - the identifier of the retention lease</dd>
<dd><code>retainingSequenceNumber</code> - the retaining sequence number</dd>
<dd><code>source</code> - the source of the retention lease</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the renewed retention lease</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if the specified retention lease does not exist</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="removeRetentionLease(java.lang.String,org.elasticsearch.action.ActionListener)">removeRetentionLease</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">removeRetentionLease</span>&#8203;(<span class="arguments">java.lang.String&nbsp;id,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</span></div>
<div class="block">Removes an existing retention lease.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>id</code> - the identifier of the retention lease</dd>
<dd><code>listener</code> - the callback when the retention lease is successfully removed and synced to replicas</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="updateRetentionLeasesOnReplica(org.elasticsearch.index.seqno.RetentionLeases)">updateRetentionLeasesOnReplica</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">updateRetentionLeasesOnReplica</span>&#8203;(<span class="arguments"><a href="../seqno/RetentionLeases.html" title="class in org.elasticsearch.index.seqno">RetentionLeases</a>&nbsp;retentionLeases)</span></div>
<div class="block">Updates retention leases on a replica.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>retentionLeases</code> - the retention leases</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="loadRetentionLeases()">loadRetentionLeases</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../seqno/RetentionLeases.html" title="class in org.elasticsearch.index.seqno">RetentionLeases</a></span>&nbsp;<span class="memberName">loadRetentionLeases</span>()
                                    throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Loads the latest retention leases from their dedicated state file.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the retention leases</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if an I/O exception occurs reading the retention leases</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="persistRetentionLeases()">persistRetentionLeases</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">persistRetentionLeases</span>()
                            throws <span class="exceptions"><a href="../../gateway/WriteStateException.html" title="class in org.elasticsearch.gateway">WriteStateException</a></span></div>
<div class="block">Persists the current retention leases to their dedicated state file.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="../../gateway/WriteStateException.html" title="class in org.elasticsearch.gateway">WriteStateException</a></code> - if an exception occurs writing the state file</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="assertRetentionLeasesPersisted()">assertRetentionLeasesPersisted</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">assertRetentionLeasesPersisted</span>()
                                       throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="syncRetentionLeases()">syncRetentionLeases</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">syncRetentionLeases</span>()</div>
<div class="block">Syncs the current retention leases to all replicas.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="initiateTracking(java.lang.String)">initiateTracking</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">initiateTracking</span>&#8203;(<span class="arguments">java.lang.String&nbsp;allocationId)</span></div>
<div class="block">Called when the recovery process for a shard has opened the engine on the target shard. Ensures that the right data structures
 have been set up locally to track local checkpoint information for the shard and that the shard is added to the replication group.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>allocationId</code> - the allocation ID of the shard for which recovery was initiated</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="markAllocationIdAsInSync(java.lang.String,long)">markAllocationIdAsInSync</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">markAllocationIdAsInSync</span>&#8203;(<span class="arguments">java.lang.String&nbsp;allocationId,
long&nbsp;localCheckpoint)</span>
                              throws <span class="exceptions">java.lang.InterruptedException</span></div>
<div class="block">Marks the shard with the provided allocation ID as in-sync with the primary shard. See
 <a href="../seqno/ReplicationTracker.html#markAllocationIdAsInSync(java.lang.String,long)"><code>ReplicationTracker.markAllocationIdAsInSync(String, long)</code></a>
 for additional details.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>allocationId</code> - the allocation ID of the shard to mark as in-sync</dd>
<dd><code>localCheckpoint</code> - the current local checkpoint on the shard</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getLocalCheckpoint()">getLocalCheckpoint</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getLocalCheckpoint</span>()</div>
<div class="block">Returns the persisted local checkpoint for the shard.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the local checkpoint</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getLastKnownGlobalCheckpoint()">getLastKnownGlobalCheckpoint</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getLastKnownGlobalCheckpoint</span>()</div>
<div class="block">Returns the global checkpoint for the shard.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the global checkpoint</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getLastSyncedGlobalCheckpoint()">getLastSyncedGlobalCheckpoint</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getLastSyncedGlobalCheckpoint</span>()</div>
<div class="block">Returns the latest global checkpoint value that has been persisted in the underlying storage (i.e. translog's checkpoint)</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getInSyncGlobalCheckpoints()">getInSyncGlobalCheckpoints</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">com.carrotsearch.hppc.ObjectLongMap&lt;java.lang.String&gt;</span>&nbsp;<span class="memberName">getInSyncGlobalCheckpoints</span>()</div>
<div class="block">Get the local knowledge of the global checkpoints for all in-sync allocation IDs.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a map from allocation ID to the local knowledge of the global checkpoint for that allocation ID</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="maybeSyncGlobalCheckpoint(java.lang.String)">maybeSyncGlobalCheckpoint</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">maybeSyncGlobalCheckpoint</span>&#8203;(<span class="arguments">java.lang.String&nbsp;reason)</span></div>
<div class="block">Syncs the global checkpoint to the replicas if the global checkpoint on at least one replica is behind the global checkpoint on the
 primary.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getReplicationGroup()">getReplicationGroup</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="ReplicationGroup.html" title="class in org.elasticsearch.index.shard">ReplicationGroup</a></span>&nbsp;<span class="memberName">getReplicationGroup</span>()</div>
<div class="block">Returns the current replication group for the shard.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the replication group</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getPendingReplicationActions()">getPendingReplicationActions</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../../action/support/replication/PendingReplicationActions.html" title="class in org.elasticsearch.action.support.replication">PendingReplicationActions</a></span>&nbsp;<span class="memberName">getPendingReplicationActions</span>()</div>
<div class="block">Returns the pending replication actions for the shard.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the pending replication actions</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="updateGlobalCheckpointOnReplica(long,java.lang.String)">updateGlobalCheckpointOnReplica</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">updateGlobalCheckpointOnReplica</span>&#8203;(<span class="arguments">long&nbsp;globalCheckpoint,
java.lang.String&nbsp;reason)</span></div>
<div class="block">Updates the global checkpoint on a replica shard after it has been updated by the primary.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>globalCheckpoint</code> - the global checkpoint</dd>
<dd><code>reason</code> - the reason the global checkpoint was updated</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addCleanFilesDependency()">addCleanFilesDependency</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.Runnable</span>&nbsp;<span class="memberName">addCleanFilesDependency</span>()</div>
<div class="block">Creates a <code>Runnable</code> that must be executed before the clean files step in peer recovery can complete.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>runnable that must be executed during the clean files step in peer recovery</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="afterCleanFiles(java.lang.Runnable)">afterCleanFiles</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">afterCleanFiles</span>&#8203;(<span class="arguments">java.lang.Runnable&nbsp;runnable)</span></div>
<div class="block">Execute a <code>Runnable</code> on the generic pool once all dependencies added via <a href="#addCleanFilesDependency()"><code>addCleanFilesDependency()</code></a> have finished.
 If there are no dependencies to wait for then the <code>Runnable</code> will be executed on the calling thread.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="outstandingCleanFilesConditions()">outstandingCleanFilesConditions</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">outstandingCleanFilesConditions</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="activateWithPrimaryContext(org.elasticsearch.index.seqno.ReplicationTracker.PrimaryContext)">activateWithPrimaryContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">activateWithPrimaryContext</span>&#8203;(<span class="arguments"><a href="../seqno/ReplicationTracker.PrimaryContext.html" title="class in org.elasticsearch.index.seqno">ReplicationTracker.PrimaryContext</a>&nbsp;primaryContext)</span></div>
<div class="block">Updates the known allocation IDs and the local checkpoints for the corresponding allocations from a primary relocation source.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>primaryContext</code> - the sequence number context</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="pendingInSync()">pendingInSync</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">pendingInSync</span>()</div>
<div class="block">Check if there are any recoveries pending in-sync.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if there is at least one shard pending in-sync, otherwise false</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="noopUpdate(java.lang.String)">noopUpdate</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">noopUpdate</span>&#8203;(<span class="arguments">java.lang.String&nbsp;type)</span></div>
<div class="block">Should be called for each no-op update operation to increment relevant statistics.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>type</code> - the doc type of the update</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="maybeCheckIndex()">maybeCheckIndex</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">maybeCheckIndex</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getEngineOrNull()">getEngineOrNull</a></h3>
<div class="memberSignature"><span class="modifiers">protected</span>&nbsp;<span class="returnType"><a href="../engine/Engine.html" title="class in org.elasticsearch.index.engine">Engine</a></span>&nbsp;<span class="memberName">getEngineOrNull</span>()</div>
<div class="block">NOTE: returns null if engine is not yet started (e.g. recovery phase 1, copying over index files, is still running), or if engine is
 closed.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="startRecovery(org.elasticsearch.indices.recovery.RecoveryState,org.elasticsearch.indices.recovery.PeerRecoveryTargetService,org.elasticsearch.indices.recovery.PeerRecoveryTargetService.RecoveryListener,org.elasticsearch.repositories.RepositoriesService,java.util.function.BiConsumer,org.elasticsearch.indices.IndicesService)">startRecovery</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">startRecovery</span>&#8203;(<span class="arguments"><a href="../../indices/recovery/RecoveryState.html" title="class in org.elasticsearch.indices.recovery">RecoveryState</a>&nbsp;recoveryState,
<a href="../../indices/recovery/PeerRecoveryTargetService.html" title="class in org.elasticsearch.indices.recovery">PeerRecoveryTargetService</a>&nbsp;recoveryTargetService,
<a href="../../indices/recovery/PeerRecoveryTargetService.RecoveryListener.html" title="interface in org.elasticsearch.indices.recovery">PeerRecoveryTargetService.RecoveryListener</a>&nbsp;recoveryListener,
<a href="../../repositories/RepositoriesService.html" title="class in org.elasticsearch.repositories">RepositoriesService</a>&nbsp;repositoriesService,
java.util.function.BiConsumer&lt;java.lang.String,&#8203;<a href="../../cluster/metadata/MappingMetadata.html" title="class in org.elasticsearch.cluster.metadata">MappingMetadata</a>&gt;&nbsp;mappingUpdateConsumer,
<a href="../../indices/IndicesService.html" title="class in org.elasticsearch.indices">IndicesService</a>&nbsp;indicesService)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isRelocatedPrimary()">isRelocatedPrimary</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">isRelocatedPrimary</span>()</div>
<div class="block">Returns whether the shard is a relocated primary, i.e. not in charge anymore of replicating changes (see <a href="../seqno/ReplicationTracker.html" title="class in org.elasticsearch.index.seqno"><code>ReplicationTracker</code></a>).</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addPeerRecoveryRetentionLease(java.lang.String,long,org.elasticsearch.action.ActionListener)">addPeerRecoveryRetentionLease</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a></span>&nbsp;<span class="memberName">addPeerRecoveryRetentionLease</span>&#8203;(<span class="arguments">java.lang.String&nbsp;nodeId,
long&nbsp;globalCheckpoint,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="cloneLocalPeerRecoveryRetentionLease(java.lang.String,org.elasticsearch.action.ActionListener)">cloneLocalPeerRecoveryRetentionLease</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a></span>&nbsp;<span class="memberName">cloneLocalPeerRecoveryRetentionLease</span>&#8203;(<span class="arguments">java.lang.String&nbsp;nodeId,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="removePeerRecoveryRetentionLease(java.lang.String,org.elasticsearch.action.ActionListener)">removePeerRecoveryRetentionLease</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">removePeerRecoveryRetentionLease</span>&#8203;(<span class="arguments">java.lang.String&nbsp;nodeId,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../action/support/replication/ReplicationResponse.html" title="class in org.elasticsearch.action.support.replication">ReplicationResponse</a>&gt;&nbsp;listener)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getPeerRecoveryRetentionLeases()">getPeerRecoveryRetentionLeases</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.List&lt;<a href="../seqno/RetentionLease.html" title="class in org.elasticsearch.index.seqno">RetentionLease</a>&gt;</span>&nbsp;<span class="memberName">getPeerRecoveryRetentionLeases</span>()</div>
<div class="block">Returns a list of retention leases for peer recovery installed in this shard copy.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="useRetentionLeasesInPeerRecovery()">useRetentionLeasesInPeerRecovery</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">useRetentionLeasesInPeerRecovery</span>()</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="buildIndexAnalyzer(org.elasticsearch.index.mapper.MapperService)">buildIndexAnalyzer</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">org.apache.lucene.analysis.Analyzer</span>&nbsp;<span class="memberName">buildIndexAnalyzer</span>&#8203;(<span class="arguments"><a href="../mapper/MapperService.html" title="class in org.elasticsearch.index.mapper">MapperService</a>&nbsp;mapperService)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquirePrimaryOperationPermit(org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object)">acquirePrimaryOperationPermit</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">acquirePrimaryOperationPermit</span>&#8203;(<span class="arguments"><a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
java.lang.String&nbsp;executorOnDelay,
java.lang.Object&nbsp;debugInfo)</span></div>
<div class="block">Acquire a primary operation permit whenever the shard is ready for indexing. If a permit is directly available, the provided
 ActionListener will be called on the calling thread. During relocation hand-off, permit acquisition can be delayed. The provided
 ActionListener will then be called using the provided executor.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>debugInfo</code> - an extra information that can be useful when tracing an unreleased permit. When assertions are enabled
                  the tracing will capture the supplied object's <code>Object.toString()</code> value. Otherwise the object
                  isn't used</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquirePrimaryOperationPermit(org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object,boolean)">acquirePrimaryOperationPermit</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">acquirePrimaryOperationPermit</span>&#8203;(<span class="arguments"><a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
java.lang.String&nbsp;executorOnDelay,
java.lang.Object&nbsp;debugInfo,
boolean&nbsp;forceExecution)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireAllPrimaryOperationsPermits(org.elasticsearch.action.ActionListener,org.elasticsearch.common.unit.TimeValue)">acquireAllPrimaryOperationsPermits</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">acquireAllPrimaryOperationsPermits</span>&#8203;(<span class="arguments"><a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
org.elasticsearch.common.unit.TimeValue&nbsp;timeout)</span></div>
<div class="block">Acquire all primary operation permits. Once all permits are acquired, the provided ActionListener is called.
 It is the responsibility of the caller to close the <a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease"><code>Releasable</code></a>.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="runUnderPrimaryPermit(java.lang.Runnable,java.util.function.Consumer,java.lang.String,java.lang.Object)">runUnderPrimaryPermit</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">runUnderPrimaryPermit</span>&#8203;(<span class="arguments">java.lang.Runnable&nbsp;runnable,
java.util.function.Consumer&lt;java.lang.Exception&gt;&nbsp;onFailure,
java.lang.String&nbsp;executorOnDelay,
java.lang.Object&nbsp;debugInfo)</span></div>
<div class="block">Runs the specified runnable under a permit and otherwise calling back the specified failure callback. This method is really a
 convenience for <a href="#acquirePrimaryOperationPermit(org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object)"><code>acquirePrimaryOperationPermit(ActionListener, String, Object)</code></a> where the listener equates to
 try-with-resources closing the releasable after executing the runnable on successfully acquiring the permit, an otherwise calling
 back the failure callback.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>runnable</code> - the runnable to execute under permit</dd>
<dd><code>onFailure</code> - the callback on failure</dd>
<dd><code>executorOnDelay</code> - the executor to execute the runnable on if permit acquisition is blocked</dd>
<dd><code>debugInfo</code> - debug info</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireReplicaOperationPermit(long,long,long,org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object)">acquireReplicaOperationPermit</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">acquireReplicaOperationPermit</span>&#8203;(<span class="arguments">long&nbsp;opPrimaryTerm,
long&nbsp;globalCheckpoint,
long&nbsp;maxSeqNoOfUpdatesOrDeletes,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
java.lang.String&nbsp;executorOnDelay,
java.lang.Object&nbsp;debugInfo)</span></div>
<div class="block">Acquire a replica operation permit whenever the shard is ready for indexing (see
 <a href="#acquirePrimaryOperationPermit(org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object)"><code>acquirePrimaryOperationPermit(ActionListener, String, Object)</code></a>). If the given primary term is lower than then one in
 <a href="#shardRouting"><code>shardRouting</code></a>, the <a href="../../action/ActionListener.html#onFailure(java.lang.Exception)"><code>ActionListener.onFailure(Exception)</code></a> method of the provided listener is invoked with an
 <code>IllegalStateException</code>. If permit acquisition is delayed, the listener will be invoked on the executor with the specified
 name.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>opPrimaryTerm</code> - the operation primary term</dd>
<dd><code>globalCheckpoint</code> - the global checkpoint associated with the request</dd>
<dd><code>maxSeqNoOfUpdatesOrDeletes</code> - the max seq_no of updates (index operations overwrite Lucene) or deletes captured on the primary
                                   after this replication request was executed on it (see <a href="#getMaxSeqNoOfUpdatesOrDeletes()"><code>getMaxSeqNoOfUpdatesOrDeletes()</code></a></dd>
<dd><code>onPermitAcquired</code> - the listener for permit acquisition</dd>
<dd><code>executorOnDelay</code> - the name of the executor to invoke the listener on if permit acquisition is delayed</dd>
<dd><code>debugInfo</code> - an extra information that can be useful when tracing an unreleased permit. When assertions are
                                   enabled the tracing will capture the supplied object's <code>Object.toString()</code> value.
                                   Otherwise the object isn't used</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="acquireAllReplicaOperationsPermits(long,long,long,org.elasticsearch.action.ActionListener,org.elasticsearch.common.unit.TimeValue)">acquireAllReplicaOperationsPermits</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">acquireAllReplicaOperationsPermits</span>&#8203;(<span class="arguments">long&nbsp;opPrimaryTerm,
long&nbsp;globalCheckpoint,
long&nbsp;maxSeqNoOfUpdatesOrDeletes,
<a href="../../action/ActionListener.html" title="interface in org.elasticsearch.action">ActionListener</a>&lt;<a href="../../common/lease/Releasable.html" title="interface in org.elasticsearch.common.lease">Releasable</a>&gt;&nbsp;onPermitAcquired,
org.elasticsearch.common.unit.TimeValue&nbsp;timeout)</span></div>
<div class="block">Acquire all replica operation permits whenever the shard is ready for indexing (see
 <a href="#acquireAllPrimaryOperationsPermits(org.elasticsearch.action.ActionListener,org.elasticsearch.common.unit.TimeValue)"><code>acquireAllPrimaryOperationsPermits(ActionListener, TimeValue)</code></a>. If the given primary term is lower than then one in
 <a href="#shardRouting"><code>shardRouting</code></a>, the <a href="../../action/ActionListener.html#onFailure(java.lang.Exception)"><code>ActionListener.onFailure(Exception)</code></a> method of the provided listener is invoked with an
 <code>IllegalStateException</code>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>opPrimaryTerm</code> - the operation primary term</dd>
<dd><code>globalCheckpoint</code> - the global checkpoint associated with the request</dd>
<dd><code>maxSeqNoOfUpdatesOrDeletes</code> - the max seq_no of updates (index operations overwrite Lucene) or deletes captured on the primary
                                   after this replication request was executed on it (see <a href="#getMaxSeqNoOfUpdatesOrDeletes()"><code>getMaxSeqNoOfUpdatesOrDeletes()</code></a></dd>
<dd><code>onPermitAcquired</code> - the listener for permit acquisition</dd>
<dd><code>timeout</code> - the maximum time to wait for the in-flight operations block</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getActiveOperationsCount()">getActiveOperationsCount</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">int</span>&nbsp;<span class="memberName">getActiveOperationsCount</span>()</div>
<div class="block">Obtain the active operation count, or <a href="#OPERATIONS_BLOCKED"><code>OPERATIONS_BLOCKED</code></a> if all permits are held (even if there are
 outstanding operations in flight).</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the active operation count, or <a href="#OPERATIONS_BLOCKED"><code>OPERATIONS_BLOCKED</code></a> when all permits are held.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getActiveOperations()">getActiveOperations</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.List&lt;java.lang.String&gt;</span>&nbsp;<span class="memberName">getActiveOperations</span>()</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a list of describing each permit that wasn't released yet. The description consist of the debugInfo supplied
         when the permit was acquired plus a stack traces that was captured when the permit was request.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="sync(org.elasticsearch.index.translog.Translog.Location,java.util.function.Consumer)">sync</a></h3>
<div class="memberSignature"><span class="modifiers">public final</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">sync</span>&#8203;(<span class="arguments"><a href="../translog/Translog.Location.html" title="class in org.elasticsearch.index.translog">Translog.Location</a>&nbsp;location,
java.util.function.Consumer&lt;java.lang.Exception&gt;&nbsp;syncListener)</span></div>
<div class="block">Syncs the given location with the underlying storage unless already synced. This method might return immediately without
 actually fsyncing the location until the sync listener is called. Yet, unless there is already another thread fsyncing
 the transaction log the caller thread will be hijacked to run the fsync for all pending fsync operations.
 This method allows indexing threads to continue indexing without blocking on fsync calls. We ensure that there is only
 one thread blocking on the sync an all others can continue indexing.
 NOTE: if the syncListener throws an exception when it's processed the exception will only be logged. Users should make sure that the
 listener handles all exception cases internally.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="sync()">sync</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">sync</span>()
          throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isSyncNeeded()">isSyncNeeded</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">isSyncNeeded</span>()</div>
<div class="block">Checks if the underlying storage sync is required.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getTranslogDurability()">getTranslogDurability</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../translog/Translog.Durability.html" title="enum in org.elasticsearch.index.translog">Translog.Durability</a></span>&nbsp;<span class="memberName">getTranslogDurability</span>()</div>
<div class="block">Returns the current translog durability mode</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="afterWriteOperation()">afterWriteOperation</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">afterWriteOperation</span>()</div>
<div class="block">Schedules a flush or translog generation roll if needed but will not schedule more than one concurrently. The operation will be
 executed asynchronously on the flush thread pool.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="scheduledRefresh()">scheduledRefresh</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">scheduledRefresh</span>()</div>
<div class="block">Executes a scheduled refresh if necessary.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> iff the engine got refreshed otherwise <code>false</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isSearchIdle()">isSearchIdle</a></h3>
<div class="memberSignature"><span class="modifiers">public final</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">isSearchIdle</span>()</div>
<div class="block">Returns true if this shards is search idle</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="hasRefreshPending()">hasRefreshPending</a></h3>
<div class="memberSignature"><span class="modifiers">public final</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">hasRefreshPending</span>()</div>
<div class="block">Returns true if this shard has some scheduled refresh that is pending because of search-idle.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="awaitShardSearchActive(java.util.function.Consumer)">awaitShardSearchActive</a></h3>
<div class="memberSignature"><span class="modifiers">public final</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">awaitShardSearchActive</span>&#8203;(<span class="arguments">java.util.function.Consumer&lt;java.lang.Boolean&gt;&nbsp;listener)</span></div>
<div class="block">Registers the given listener and invokes it once the shard is active again and all
 pending refresh translog location has been refreshed. If there is no pending refresh location registered the listener will be
 invoked immediately.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>listener</code> - the listener to invoke once the pending refresh location is visible. The listener will be called with
                 <code>true</code> if the listener was registered to wait for a refresh.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addRefreshListener(org.elasticsearch.index.translog.Translog.Location,java.util.function.Consumer)">addRefreshListener</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">addRefreshListener</span>&#8203;(<span class="arguments"><a href="../translog/Translog.Location.html" title="class in org.elasticsearch.index.translog">Translog.Location</a>&nbsp;location,
java.util.function.Consumer&lt;java.lang.Boolean&gt;&nbsp;listener)</span></div>
<div class="block">Add a listener for refreshes.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>location</code> - the location to listen for</dd>
<dd><code>listener</code> - for the refresh. Called with true if registering the listener ran it out of slots and forced a refresh. Called with
        false otherwise.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getMaxSeqNoOfUpdatesOrDeletes()">getMaxSeqNoOfUpdatesOrDeletes</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">long</span>&nbsp;<span class="memberName">getMaxSeqNoOfUpdatesOrDeletes</span>()</div>
<div class="block">Returns the maximum sequence number of either update or delete operations have been processed in this shard
 or the sequence number from <a href="#advanceMaxSeqNoOfUpdatesOrDeletes(long)"><code>advanceMaxSeqNoOfUpdatesOrDeletes(long)</code></a>. An index request is considered
 as an update operation if it overwrites the existing documents in Lucene index with the same document id.
 <p>
 The primary captures this value after executes a replication request, then transfers it to a replica before
 executing that replication request on a replica.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="advanceMaxSeqNoOfUpdatesOrDeletes(long)">advanceMaxSeqNoOfUpdatesOrDeletes</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">advanceMaxSeqNoOfUpdatesOrDeletes</span>&#8203;(<span class="arguments">long&nbsp;seqNo)</span></div>
<div class="block">A replica calls this method to advance the max_seq_no_of_updates marker of its engine to at least the max_seq_no_of_updates
 value (piggybacked in a replication request) that it receives from its primary before executing that replication request.
 The receiving value is at least as high as the max_seq_no_of_updates on the primary was when any of the operations of that
 replication request were processed on it.
 <p>
 A replica shard also calls this method to bootstrap the max_seq_no_of_updates marker with the value that it received from
 the primary in peer-recovery, before it replays remote translog operations from the primary. The receiving value is at least
 as high as the max_seq_no_of_updates on the primary was when any of these operations were processed on it.
 <p>
 These transfers guarantee that every index/delete operation when executing on a replica engine will observe this marker a value
 which is at least the value of the max_seq_no_of_updates marker on the primary after that operation was executed on the primary.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#acquireReplicaOperationPermit(long,long,long,org.elasticsearch.action.ActionListener,java.lang.String,java.lang.Object)"><code>acquireReplicaOperationPermit(long, long, long, ActionListener, String, Object)</code></a>, 
<a href="../../indices/recovery/RecoveryTarget.html#indexTranslogOperations(java.util.List,int,long,long,org.elasticsearch.index.seqno.RetentionLeases,long,org.elasticsearch.action.ActionListener)"><code>RecoveryTarget.indexTranslogOperations(List, int, long, long, RetentionLeases, long, ActionListener)</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="verifyShardBeforeIndexClosing()">verifyShardBeforeIndexClosing</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">verifyShardBeforeIndexClosing</span>()
                                   throws <span class="exceptions">java.lang.IllegalStateException</span></div>
<div class="block">Performs the pre-closing checks on the <a href="IndexShard.html" title="class in org.elasticsearch.index.shard"><code>IndexShard</code></a>.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if the sanity checks failed</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</div>
</div>
</body>
</html>
