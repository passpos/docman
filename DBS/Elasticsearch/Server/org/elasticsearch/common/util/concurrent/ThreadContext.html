<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>ThreadContext (server 7.11.1 API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<meta name="description" content="declaration: package: org.elasticsearch.common.util.concurrent, class: ThreadContext">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":10,"i1":10,"i2":9,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":9,"i21":10,"i22":10,"i23":10,"i24":10,"i25":10,"i26":10,"i27":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flexBox">
<header role="banner" class="flexHeader">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="skipNav"><a id="skip.navbar.top">
<!--   -->
</a></div>
</nav>
</header>
<div class="flexContent">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.elasticsearch.common.util.concurrent</a></div>
<h1 title="Class ThreadContext" class="title">Class ThreadContext</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree">java.lang.Object
<div class="inheritance">org.elasticsearch.common.util.concurrent.ThreadContext</div>
</div>
<section class="description">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../../io/stream/Writeable.html" title="interface in org.elasticsearch.common.io.stream">Writeable</a></code></dd>
</dl>
<hr>
<pre>public final class <span class="typeNameLabel">ThreadContext</span>
extends java.lang.Object
implements <a href="../../io/stream/Writeable.html" title="interface in org.elasticsearch.common.io.stream">Writeable</a></pre>
<div class="block">A ThreadContext is a map of string headers and a transient map of keyed objects that are associated with
 a thread. It allows to store and retrieve header information across method calls, network calls as well as threads spawned from a
 thread that has a <a href="ThreadContext.html" title="class in org.elasticsearch.common.util.concurrent"><code>ThreadContext</code></a> associated with. Threads spawned from a <a href="../../../threadpool/ThreadPool.html" title="class in org.elasticsearch.threadpool"><code>ThreadPool</code></a>
 have out of the box support for <a href="ThreadContext.html" title="class in org.elasticsearch.common.util.concurrent"><code>ThreadContext</code></a> and all threads spawned will inherit the <a href="ThreadContext.html" title="class in org.elasticsearch.common.util.concurrent"><code>ThreadContext</code></a> from the thread
 that it is forking from.". Network calls will also preserve the senders headers automatically.
 <p>
 Consumers of ThreadContext usually don't need to interact with adding or stashing contexts. Every elasticsearch thread is managed by
 a thread pool or executor being responsible for stashing and restoring the threads context. For instance if a network request is
 received, all headers are deserialized from the network and directly added as the headers of the threads <a href="ThreadContext.html" title="class in org.elasticsearch.common.util.concurrent"><code>ThreadContext</code></a>
 (see <a href="#readHeaders(org.elasticsearch.common.io.stream.StreamInput)"><code>readHeaders(StreamInput)</code></a>. In order to not modify the context that is currently active on this thread the network code
 uses a try/with pattern to stash it's current context, read headers into a fresh one and once the request is handled or a handler thread
 is forked (which in turn inherits the context) it restores the previous context. For instance:
 </p>
 <pre>
     // current context is stashed and replaced with a default context
     try (StoredContext context = threadContext.stashContext()) {
         threadContext.readHeaders(in); // read headers into current context
         if (fork) {
             threadPool.execute(() -&gt; request.handle()); // inherits context
         } else {
             request.handle();
         }
     }
     // previous context is restored on StoredContext#close()
 </pre></div>
</section>
<section class="summary">
<ul class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li class="blockList">
<section class="nestedClassSummary"><a id="nested.class.summary">
<!--   -->
</a>
<h2>Nested Class Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="inheritedList">
<h2>Nested classes/interfaces inherited from interface&nbsp;org.elasticsearch.common.io.stream.<a href="../../io/stream/Writeable.html" title="interface in org.elasticsearch.common.io.stream">Writeable</a></h2>
<a id="nested.classes.inherited.from.class.org.elasticsearch.common.io.stream.Writeable">
<!--   -->
</a><code><a href="../../io/stream/Writeable.Reader.html" title="interface in org.elasticsearch.common.io.stream">Writeable.Reader</a>&lt;<a href="../../io/stream/Writeable.Reader.html" title="type parameter in Writeable.Reader">V</a>&gt;, <a href="../../io/stream/Writeable.Writer.html" title="interface in org.elasticsearch.common.io.stream">Writeable.Writer</a>&lt;<a href="../../io/stream/Writeable.Writer.html" title="type parameter in Writeable.Writer">V</a>&gt;</code></div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li class="blockList">
<section class="fieldSummary"><a id="field.summary">
<!--   -->
</a>
<h2>Field Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#ACTION_ORIGIN_TRANSIENT_NAME">ACTION_ORIGIN_TRANSIENT_NAME</a></span></code></th>
<td class="colLast">
<div class="block">Name for the <a href="#stashWithOrigin(java.lang.String)"><code>origin</code></a> attribute.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="../../settings/Setting.html" title="class in org.elasticsearch.common.settings">Setting</a>&lt;<a href="../../settings/Settings.html" title="class in org.elasticsearch.common.settings">Settings</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#DEFAULT_HEADERS_SETTING">DEFAULT_HEADERS_SETTING</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#PREFIX">PREFIX</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
<!--   -->
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(org.elasticsearch.common.settings.Settings)">ThreadContext</a></span>&#8203;(<a href="../../settings/Settings.html" title="class in org.elasticsearch.common.settings">Settings</a>&nbsp;settings)</code></th>
<td class="colLast">
<div class="block">Creates a new ThreadContext instance</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t1" class="tableTab" onclick="show(1);">Static Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addResponseHeader(java.lang.String,java.lang.String)">addResponseHeader</a></span>&#8203;(java.lang.String&nbsp;key,
java.lang.String&nbsp;value)</code></th>
<td class="colLast">
<div class="block">Add the <code>value</code> for the specified <code>key</code> Any duplicate <code>value</code> is ignored.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#addResponseHeader(java.lang.String,java.lang.String,java.util.function.Function)">addResponseHeader</a></span>&#8203;(java.lang.String&nbsp;key,
java.lang.String&nbsp;value,
java.util.function.Function&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;uniqueValue)</code></th>
<td class="colLast">
<div class="block">Add the <code>value</code> for the specified <code>key</code> with the specified <code>uniqueValue</code> used for de-duplication.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>static java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#buildDefaultHeaders(org.elasticsearch.common.settings.Settings)">buildDefaultHeaders</a></span>&#8203;(<a href="../../settings/Settings.html" title="class in org.elasticsearch.common.settings">Settings</a>&nbsp;settings)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code><a href="../../io/stream/Writeable.html" title="interface in org.elasticsearch.common.io.stream">Writeable</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#captureAsWriteable()">captureAsWriteable</a></span>()</code></th>
<td class="colLast">
<div class="block">Captures the current thread context as writeable, allowing it to be serialized out later</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#copyHeaders(java.lang.Iterable)">copyHeaders</a></span>&#8203;(java.lang.Iterable&lt;java.util.Map.Entry&lt;java.lang.String,&#8203;java.lang.String&gt;&gt;&nbsp;headers)</code></th>
<td class="colLast">
<div class="block">Copies all header key, value pairs into the current context</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getHeader(java.lang.String)">getHeader</a></span>&#8203;(java.lang.String&nbsp;key)</code></th>
<td class="colLast">
<div class="block">Returns the header for the given key or <code>null</code> if not present</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getHeaders()">getHeaders</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns all of the request headers from the thread's context.<br>
 <b>Be advised, headers might contain credentials.</b>
 In order to avoid storing, and erroneously exposing, such headers,
 it is recommended to instead store security headers that prove
 the credentials have been verified successfully, and which are
 internal to the system, in the sense that they cannot be sent
 by the clients.</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getRequestHeadersOnly()">getRequestHeadersOnly</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the request headers, without the default headers</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>java.util.Map&lt;java.lang.String,&#8203;java.util.List&lt;java.lang.String&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getResponseHeaders()">getResponseHeaders</a></span>()</code></th>
<td class="colLast">
<div class="block">Get a copy of all <em>response</em> headers.</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>&lt;T&gt;&nbsp;T</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTransient(java.lang.String)">getTransient</a></span>&#8203;(java.lang.String&nbsp;key)</code></th>
<td class="colLast">
<div class="block">Returns a transient header object or <code>null</code> if there is no header for the given key</div>
</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isSystemContext()">isSystemContext</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns <code>true</code> iff this context is a system context</div>
</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#markAsSystemContext()">markAsSystemContext</a></span>()</code></th>
<td class="colLast">
<div class="block">Marks this thread context as an internal system context.</div>
</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code>java.util.function.Supplier&lt;<a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newRestorableContext(boolean)">newRestorableContext</a></span>&#8203;(boolean&nbsp;preserveResponseHeaders)</code></th>
<td class="colLast">
<div class="block">Returns a supplier that gathers a <a href="#newStoredContext(boolean)"><code>newStoredContext(boolean)</code></a> and restores it once the
 returned supplier is invoked.</div>
</td>
</tr>
<tr class="rowColor" id="i13">
<td class="colFirst"><code><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newStoredContext(boolean)">newStoredContext</a></span>&#8203;(boolean&nbsp;preserveResponseHeaders)</code></th>
<td class="colLast">
<div class="block">Just like <a href="#stashContext()"><code>stashContext()</code></a> but no default context is set.</div>
</td>
</tr>
<tr class="altColor" id="i14">
<td class="colFirst"><code><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#newStoredContext(boolean,java.util.Collection)">newStoredContext</a></span>&#8203;(boolean&nbsp;preserveResponseHeaders,
java.util.Collection&lt;java.lang.String&gt;&nbsp;transientHeadersToClear)</code></th>
<td class="colLast">
<div class="block">Just like <a href="#stashContext()"><code>stashContext()</code></a> but no default context is set.</div>
</td>
</tr>
<tr class="rowColor" id="i15">
<td class="colFirst"><code>java.lang.Runnable</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#preserveContext(java.lang.Runnable)">preserveContext</a></span>&#8203;(java.lang.Runnable&nbsp;command)</code></th>
<td class="colLast">
<div class="block">Saves the current thread context and wraps command in a Runnable that restores that context before running command.</div>
</td>
</tr>
<tr class="altColor" id="i16">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#putHeader(java.lang.String,java.lang.String)">putHeader</a></span>&#8203;(java.lang.String&nbsp;key,
java.lang.String&nbsp;value)</code></th>
<td class="colLast">
<div class="block">Puts a header into the context</div>
</td>
</tr>
<tr class="rowColor" id="i17">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#putHeader(java.util.Map)">putHeader</a></span>&#8203;(java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;header)</code></th>
<td class="colLast">
<div class="block">Puts all of the given headers into this context</div>
</td>
</tr>
<tr class="altColor" id="i18">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#putTransient(java.lang.String,java.lang.Object)">putTransient</a></span>&#8203;(java.lang.String&nbsp;key,
java.lang.Object&nbsp;value)</code></th>
<td class="colLast">
<div class="block">Puts a transient header object into this context</div>
</td>
</tr>
<tr class="rowColor" id="i19">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#readHeaders(org.elasticsearch.common.io.stream.StreamInput)">readHeaders</a></span>&#8203;(<a href="../../io/stream/StreamInput.html" title="class in org.elasticsearch.common.io.stream">StreamInput</a>&nbsp;in)</code></th>
<td class="colLast">
<div class="block">Reads the headers from the stream into the current context</div>
</td>
</tr>
<tr class="altColor" id="i20">
<td class="colFirst"><code>static org.elasticsearch.common.collect.Tuple&lt;java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;,&#8203;java.util.Map&lt;java.lang.String,&#8203;java.util.Set&lt;java.lang.String&gt;&gt;&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#readHeadersFromStream(org.elasticsearch.common.io.stream.StreamInput)">readHeadersFromStream</a></span>&#8203;(<a href="../../io/stream/StreamInput.html" title="class in org.elasticsearch.common.io.stream">StreamInput</a>&nbsp;in)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i21">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setHeaders(org.elasticsearch.common.collect.Tuple)">setHeaders</a></span>&#8203;(org.elasticsearch.common.collect.Tuple&lt;java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;,&#8203;java.util.Map&lt;java.lang.String,&#8203;java.util.Set&lt;java.lang.String&gt;&gt;&gt;&nbsp;headerTuple)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i22">
<td class="colFirst"><code><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stashAndMergeHeaders(java.util.Map)">stashAndMergeHeaders</a></span>&#8203;(java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;headers)</code></th>
<td class="colLast">
<div class="block">Removes the current context and resets a new context that contains a merge of the current headers and the given headers.</div>
</td>
</tr>
<tr class="rowColor" id="i23">
<td class="colFirst"><code><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stashContext()">stashContext</a></span>()</code></th>
<td class="colLast">
<div class="block">Removes the current context and resets a default context.</div>
</td>
</tr>
<tr class="altColor" id="i24">
<td class="colFirst"><code><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#stashWithOrigin(java.lang.String)">stashWithOrigin</a></span>&#8203;(java.lang.String&nbsp;origin)</code></th>
<td class="colLast">
<div class="block">Removes the current context and resets a default context marked with as
 originating from the supplied string.</div>
</td>
</tr>
<tr class="rowColor" id="i25">
<td class="colFirst"><code>java.lang.Runnable</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#unwrap(java.lang.Runnable)">unwrap</a></span>&#8203;(java.lang.Runnable&nbsp;command)</code></th>
<td class="colLast">
<div class="block">Unwraps a command that was previously wrapped by <a href="#preserveContext(java.lang.Runnable)"><code>preserveContext(Runnable)</code></a>.</div>
</td>
</tr>
<tr class="altColor" id="i26">
<td class="colFirst"><code>java.util.function.Supplier&lt;<a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#wrapRestorable(org.elasticsearch.common.util.concurrent.ThreadContext.StoredContext)">wrapRestorable</a></span>&#8203;(<a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a>&nbsp;storedContext)</code></th>
<td class="colLast">
<div class="block">Same as <a href="#newRestorableContext(boolean)"><code>newRestorableContext(boolean)</code></a> but wraps an existing context to restore.</div>
</td>
</tr>
<tr class="rowColor" id="i27">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#writeTo(org.elasticsearch.common.io.stream.StreamOutput)">writeTo</a></span>&#8203;(<a href="../../io/stream/StreamOutput.html" title="class in org.elasticsearch.common.io.stream">StreamOutput</a>&nbsp;out)</code></th>
<td class="colLast">
<div class="block">Write this into the <a href="../../io/stream/StreamOutput.html" title="class in org.elasticsearch.common.io.stream">StreamOutput</a>.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a><code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<li class="blockList">
<section class="fieldDetails"><a id="field.detail">
<!--   -->
</a>
<h2>Field Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="PREFIX">PREFIX</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">PREFIX</span></div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.elasticsearch.common.util.concurrent.ThreadContext.PREFIX">Constant Field Values</a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="DEFAULT_HEADERS_SETTING">DEFAULT_HEADERS_SETTING</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType"><a href="../../settings/Setting.html" title="class in org.elasticsearch.common.settings">Setting</a>&lt;<a href="../../settings/Settings.html" title="class in org.elasticsearch.common.settings">Settings</a>&gt;</span>&nbsp;<span class="memberName">DEFAULT_HEADERS_SETTING</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="ACTION_ORIGIN_TRANSIENT_NAME">ACTION_ORIGIN_TRANSIENT_NAME</a></h3>
<div class="memberSignature"><span class="modifiers">public static final</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">ACTION_ORIGIN_TRANSIENT_NAME</span></div>
<div class="block">Name for the <a href="#stashWithOrigin(java.lang.String)"><code>origin</code></a> attribute.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#org.elasticsearch.common.util.concurrent.ThreadContext.ACTION_ORIGIN_TRANSIENT_NAME">Constant Field Values</a></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
<!--   -->
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(org.elasticsearch.common.settings.Settings)">ThreadContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="memberName">ThreadContext</span>&#8203;(<span class="arguments"><a href="../../settings/Settings.html" title="class in org.elasticsearch.common.settings">Settings</a>&nbsp;settings)</span></div>
<div class="block">Creates a new ThreadContext instance</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>settings</code> - the settings to read the default request headers from</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="stashContext()">stashContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></span>&nbsp;<span class="memberName">stashContext</span>()</div>
<div class="block">Removes the current context and resets a default context. The removed context can be
 restored by closing the returned <a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent"><code>ThreadContext.StoredContext</code></a>.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="captureAsWriteable()">captureAsWriteable</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="../../io/stream/Writeable.html" title="interface in org.elasticsearch.common.io.stream">Writeable</a></span>&nbsp;<span class="memberName">captureAsWriteable</span>()</div>
<div class="block">Captures the current thread context as writeable, allowing it to be serialized out later</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="stashWithOrigin(java.lang.String)">stashWithOrigin</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></span>&nbsp;<span class="memberName">stashWithOrigin</span>&#8203;(<span class="arguments">java.lang.String&nbsp;origin)</span></div>
<div class="block">Removes the current context and resets a default context marked with as
 originating from the supplied string. The removed context can be
 restored by closing the returned <a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent"><code>ThreadContext.StoredContext</code></a>. Callers should
 be careful to save the current context before calling this method and
 restore it any listeners, likely with
 <a href="../../../action/support/ContextPreservingActionListener.html" title="class in org.elasticsearch.action.support"><code>ContextPreservingActionListener</code></a>. Use <a href="../../../client/OriginSettingClient.html" title="class in org.elasticsearch.client"><code>OriginSettingClient</code></a>
 which can be used to do this automatically.
 <p>
 Without security the origin is ignored, but security uses it to authorize
 actions that are made up of many sub-actions. These actions call
 <a href="#stashWithOrigin(java.lang.String)"><code>stashWithOrigin(java.lang.String)</code></a> before performing on behalf of a user that
 should be allowed even if the user doesn't have permission to perform
 those actions on their own.
 <p>
 For example, a user might not have permission to GET from the tasks index
 but the tasks API will perform a get on their behalf using this method
 if it can't find the task in memory.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="stashAndMergeHeaders(java.util.Map)">stashAndMergeHeaders</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></span>&nbsp;<span class="memberName">stashAndMergeHeaders</span>&#8203;(<span class="arguments">java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;headers)</span></div>
<div class="block">Removes the current context and resets a new context that contains a merge of the current headers and the given headers.
 The removed context can be restored when closing the returned <a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent"><code>ThreadContext.StoredContext</code></a>. The merge strategy is that headers
 that are already existing are preserved unless they are defaults.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="newStoredContext(boolean)">newStoredContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></span>&nbsp;<span class="memberName">newStoredContext</span>&#8203;(<span class="arguments">boolean&nbsp;preserveResponseHeaders)</span></div>
<div class="block">Just like <a href="#stashContext()"><code>stashContext()</code></a> but no default context is set.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>preserveResponseHeaders</code> - if set to <code>true</code> the response headers of the restore thread will be preserved.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="newStoredContext(boolean,java.util.Collection)">newStoredContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType"><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a></span>&nbsp;<span class="memberName">newStoredContext</span>&#8203;(<span class="arguments">boolean&nbsp;preserveResponseHeaders,
java.util.Collection&lt;java.lang.String&gt;&nbsp;transientHeadersToClear)</span></div>
<div class="block">Just like <a href="#stashContext()"><code>stashContext()</code></a> but no default context is set. Instead, the <code>transientHeadersToClear</code> argument can be used
 to clear specific transient headers in the new context. All headers (with the possible exception of <code>responseHeaders</code>) are
 restored by closing the returned <a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent"><code>ThreadContext.StoredContext</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>preserveResponseHeaders</code> - if set to <code>true</code> the response headers of the restore thread will be preserved.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="newRestorableContext(boolean)">newRestorableContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.function.Supplier&lt;<a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a>&gt;</span>&nbsp;<span class="memberName">newRestorableContext</span>&#8203;(<span class="arguments">boolean&nbsp;preserveResponseHeaders)</span></div>
<div class="block">Returns a supplier that gathers a <a href="#newStoredContext(boolean)"><code>newStoredContext(boolean)</code></a> and restores it once the
 returned supplier is invoked. The context returned from the supplier is a stored version of the
 suppliers callers context that should be restored once the originally gathered context is not needed anymore.
 For instance this method should be used like this:

 <pre>
     Supplier&lt;ThreadContext.StoredContext&gt; restorable = context.newRestorableContext(true);
     new Thread() {
         public void run() {
             try (ThreadContext.StoredContext ctx = restorable.get()) {
                 // execute with the parents context and restore the threads context afterwards
             }
         }

     }.start();
 </pre></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>preserveResponseHeaders</code> - if set to <code>true</code> the response headers of the restore thread will be preserved.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a restorable context supplier</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="wrapRestorable(org.elasticsearch.common.util.concurrent.ThreadContext.StoredContext)">wrapRestorable</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.function.Supplier&lt;<a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a>&gt;</span>&nbsp;<span class="memberName">wrapRestorable</span>&#8203;(<span class="arguments"><a href="ThreadContext.StoredContext.html" title="interface in org.elasticsearch.common.util.concurrent">ThreadContext.StoredContext</a>&nbsp;storedContext)</span></div>
<div class="block">Same as <a href="#newRestorableContext(boolean)"><code>newRestorableContext(boolean)</code></a> but wraps an existing context to restore.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>storedContext</code> - the context to restore</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="writeTo(org.elasticsearch.common.io.stream.StreamOutput)">writeTo</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">writeTo</span>&#8203;(<span class="arguments"><a href="../../io/stream/StreamOutput.html" title="class in org.elasticsearch.common.io.stream">StreamOutput</a>&nbsp;out)</span>
             throws <span class="exceptions">java.io.IOException</span></div>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../io/stream/Writeable.html#writeTo(org.elasticsearch.common.io.stream.StreamOutput)">Writeable</a></code></span></div>
<div class="block">Write this into the <a href="../../io/stream/StreamOutput.html" title="class in org.elasticsearch.common.io.stream">StreamOutput</a>.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../io/stream/Writeable.html#writeTo(org.elasticsearch.common.io.stream.StreamOutput)">writeTo</a></code>&nbsp;in interface&nbsp;<code><a href="../../io/stream/Writeable.html" title="interface in org.elasticsearch.common.io.stream">Writeable</a></code></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="readHeaders(org.elasticsearch.common.io.stream.StreamInput)">readHeaders</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">readHeaders</span>&#8203;(<span class="arguments"><a href="../../io/stream/StreamInput.html" title="class in org.elasticsearch.common.io.stream">StreamInput</a>&nbsp;in)</span>
                 throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Reads the headers from the stream into the current context</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="setHeaders(org.elasticsearch.common.collect.Tuple)">setHeaders</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">setHeaders</span>&#8203;(<span class="arguments">org.elasticsearch.common.collect.Tuple&lt;java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;,&#8203;java.util.Map&lt;java.lang.String,&#8203;java.util.Set&lt;java.lang.String&gt;&gt;&gt;&nbsp;headerTuple)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="readHeadersFromStream(org.elasticsearch.common.io.stream.StreamInput)">readHeadersFromStream</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">org.elasticsearch.common.collect.Tuple&lt;java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;,&#8203;java.util.Map&lt;java.lang.String,&#8203;java.util.Set&lt;java.lang.String&gt;&gt;&gt;</span>&nbsp;<span class="memberName">readHeadersFromStream</span>&#8203;(<span class="arguments"><a href="../../io/stream/StreamInput.html" title="class in org.elasticsearch.common.io.stream">StreamInput</a>&nbsp;in)</span>
                                                                                                                                                                                      throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getHeader(java.lang.String)">getHeader</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">getHeader</span>&#8203;(<span class="arguments">java.lang.String&nbsp;key)</span></div>
<div class="block">Returns the header for the given key or <code>null</code> if not present</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getHeaders()">getHeaders</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</span>&nbsp;<span class="memberName">getHeaders</span>()</div>
<div class="block">Returns all of the request headers from the thread's context.<br>
 <b>Be advised, headers might contain credentials.</b>
 In order to avoid storing, and erroneously exposing, such headers,
 it is recommended to instead store security headers that prove
 the credentials have been verified successfully, and which are
 internal to the system, in the sense that they cannot be sent
 by the clients.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getRequestHeadersOnly()">getRequestHeadersOnly</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</span>&nbsp;<span class="memberName">getRequestHeadersOnly</span>()</div>
<div class="block">Returns the request headers, without the default headers</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getResponseHeaders()">getResponseHeaders</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.util.Map&lt;java.lang.String,&#8203;java.util.List&lt;java.lang.String&gt;&gt;</span>&nbsp;<span class="memberName">getResponseHeaders</span>()</div>
<div class="block">Get a copy of all <em>response</em> headers.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Never <code>null</code>.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="copyHeaders(java.lang.Iterable)">copyHeaders</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">copyHeaders</span>&#8203;(<span class="arguments">java.lang.Iterable&lt;java.util.Map.Entry&lt;java.lang.String,&#8203;java.lang.String&gt;&gt;&nbsp;headers)</span></div>
<div class="block">Copies all header key, value pairs into the current context</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="putHeader(java.lang.String,java.lang.String)">putHeader</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">putHeader</span>&#8203;(<span class="arguments">java.lang.String&nbsp;key,
java.lang.String&nbsp;value)</span></div>
<div class="block">Puts a header into the context</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="putHeader(java.util.Map)">putHeader</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">putHeader</span>&#8203;(<span class="arguments">java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;header)</span></div>
<div class="block">Puts all of the given headers into this context</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="putTransient(java.lang.String,java.lang.Object)">putTransient</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">putTransient</span>&#8203;(<span class="arguments">java.lang.String&nbsp;key,
java.lang.Object&nbsp;value)</span></div>
<div class="block">Puts a transient header object into this context</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getTransient(java.lang.String)">getTransient</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="typeParameters">&lt;T&gt;</span>&nbsp;<span class="returnType">T</span>&nbsp;<span class="memberName">getTransient</span>&#8203;(<span class="arguments">java.lang.String&nbsp;key)</span></div>
<div class="block">Returns a transient header object or <code>null</code> if there is no header for the given key</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addResponseHeader(java.lang.String,java.lang.String)">addResponseHeader</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">addResponseHeader</span>&#8203;(<span class="arguments">java.lang.String&nbsp;key,
java.lang.String&nbsp;value)</span></div>
<div class="block">Add the <code>value</code> for the specified <code>key</code> Any duplicate <code>value</code> is ignored.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - the header name</dd>
<dd><code>value</code> - the header value</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="addResponseHeader(java.lang.String,java.lang.String,java.util.function.Function)">addResponseHeader</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">addResponseHeader</span>&#8203;(<span class="arguments">java.lang.String&nbsp;key,
java.lang.String&nbsp;value,
java.util.function.Function&lt;java.lang.String,&#8203;java.lang.String&gt;&nbsp;uniqueValue)</span></div>
<div class="block">Add the <code>value</code> for the specified <code>key</code> with the specified <code>uniqueValue</code> used for de-duplication. Any duplicate
 <code>value</code> after applying <code>uniqueValue</code> is ignored.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - the header name</dd>
<dd><code>value</code> - the header value</dd>
<dd><code>uniqueValue</code> - the function that produces de-duplication values</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="preserveContext(java.lang.Runnable)">preserveContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.Runnable</span>&nbsp;<span class="memberName">preserveContext</span>&#8203;(<span class="arguments">java.lang.Runnable&nbsp;command)</span></div>
<div class="block">Saves the current thread context and wraps command in a Runnable that restores that context before running command. If
 <code>command</code> has already been passed through this method then it is returned unaltered rather than wrapped twice.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="unwrap(java.lang.Runnable)">unwrap</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.lang.Runnable</span>&nbsp;<span class="memberName">unwrap</span>&#8203;(<span class="arguments">java.lang.Runnable&nbsp;command)</span></div>
<div class="block">Unwraps a command that was previously wrapped by <a href="#preserveContext(java.lang.Runnable)"><code>preserveContext(Runnable)</code></a>.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="markAsSystemContext()">markAsSystemContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">markAsSystemContext</span>()</div>
<div class="block">Marks this thread context as an internal system context. This signals that actions in this context are issued
 by the system itself rather than by a user action.</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isSystemContext()">isSystemContext</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">boolean</span>&nbsp;<span class="memberName">isSystemContext</span>()</div>
<div class="block">Returns <code>true</code> iff this context is a system context</div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="buildDefaultHeaders(org.elasticsearch.common.settings.Settings)">buildDefaultHeaders</a></h3>
<div class="memberSignature"><span class="modifiers">public static</span>&nbsp;<span class="returnType">java.util.Map&lt;java.lang.String,&#8203;java.lang.String&gt;</span>&nbsp;<span class="memberName">buildDefaultHeaders</span>&#8203;(<span class="arguments"><a href="../../settings/Settings.html" title="class in org.elasticsearch.common.settings">Settings</a>&nbsp;settings)</span></div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</div>
</div>
</body>
</html>
