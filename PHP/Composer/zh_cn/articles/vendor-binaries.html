<!DOCTYPE html>
<html class="no-js" lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,initial-scale=1">

        <title>二进制供应库和 vendor/bin 目录 | Composer 中文文档 | Composer 中文网</title>
        <meta name="description" content="Composer 是 PHP 中用来管理依赖（dependency）关系的工具">
        <meta name="keywords" content="PHP, Composer, Packagist, 依赖管理, npm, Symfony, Laravel">

        <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="../assets/css/style.css">
        <link rel="stylesheet" href="../assets/css/libs/prism.css">

        <script src="https://cdn.bootcss.com/modernizr/2.8.2/modernizr.min.js"></script>
    </head>

    <body>
        <div id="container">
            <header>
                    <a href="../docs_phpcomposer_default.html">首页</a>
                    <a href="../00-intro.html">入门</a>
                    <a href="https://getcomposer.org/download/" target="_blank">下载</a>
                    <a href="https://packagist.org/" target="_blank">安装包列表</a>
                    <a class="last" href="https://pkg.phpcomposer.com/" target="_blank">中国镜像</a>
            </header>
            <div id="main" role="main">
    
    <!--
    tagline: Expose command-line scripts from packages
-->
<h1>二进制供应库和 <code>vendor/bin</code> 目录</h1>
<h2>什么是二进制供应库？</h2>
<p>一个 Composer 资源包，想要传递给安装它的用户的任何命令行脚本，
都应该被列入 <code>二进制供应库</code>。</p>
<p>如果一个资源包，含有不被用户所需要的其他脚本（比如构建或编译脚本）
那么这些代码不应该被列入二进制供应库。</p>
<h2>如何定义？</h2>
<p>它是通过在项目的 <code>composer.json</code> 里添加一个 <code>bin</code> 键定义的。
它是以一种文件的数组的形式定义的，这样任何给定的项目
都可以添加多个二进制文件。</p>
<pre><code class="language-json">{
    &quot;bin&quot;: [&quot;bin/my-script&quot;, &quot;bin/my-other-script&quot;]
}
</code></pre>
<h2>在 composer.json 里定义二进制供应库的作用是？</h2>
<p>对于任何 <strong>依赖于</strong> 该资源包的项目，
它将引导 Composer 安装资源包里的二进制文件到 <code>vendor/bin</code> 目录。</p>
<p>这是一个便捷的途径来暴露有用的脚本，
否则它们将会被隐藏在 <code>vendor/</code> 目录的深处。</p>
<h2>当 Composer 运行到定义了二进制供应库的 composer.json 文件时发生了什么？</h2>
<p>对于被某个资源包直接定义的二进制供应库，什么也不会发生。</p>
<h2>当 Composer 运行到，列出了二进制供应库依赖关系的 composer.json 文件时发生了什么？</h2>
<p>Composer 会检查所有依赖包里定义的二进制文件。
并为每一个依赖的二进制库设立一个指向 <code>vendor/bin</code> 的软连接。</p>
<p>比如 <code>my-vendor/project-a</code> 资源包的二进制库就是这样安装的：</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;my-vendor/project-a&quot;,
    &quot;bin&quot;: [&quot;bin/project-a-bin&quot;]
}
</code></pre>
<p>在该 <code>composer.json</code> 上执行 <code>composer install</code> 命令，
不会对 <code>bin/project-a-bin</code> 造成任何影响。</p>
<p>再比如项目 <code>my-vendor/project-b</code> 有这样的 require 定义：</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;my-vendor/project-b&quot;,
    &quot;require&quot;: {
        &quot;my-vendor/project-a&quot;: &quot;*&quot;
    }
}
</code></pre>
<p>在该 <code>composer.json</code> 上执行 <code>composer install</code> 命令时，
将会检查 project-b 的所有依赖包，并安装它们的二进制库到 <code>vendor/bin</code> 目录。</p>
<p>这种情况下，Composer 将使 <code>vendor/bin/project-a-bin</code> 可以作为
<code>vendor/my-vendor/project-a/bin/project-a-bin</code> 的访问路径。在类 Unix 平台上，
这是通过创建软链接实现的。</p>
<h2>对于 Windows 环境和 .bat 文件呢？</h2>
<p>完全由 Composer 管理的包并不 <em>需要</em> 包含任何用以兼容 Windows 的
<code>.bat</code> 文件。在 Windows 环境下运行时，Composer 会用一种特殊的方式处理
二进制文件的安装：</p>
<ul>
<li>一个用以引用此二进制文件的 <code>.bat</code> 文件会自动生成</li>
<li>一个与该二进制文件同名的 Unix 风格的代理文件也会自动生成
（方便 Cygwin 或 Git Bash 使用）</li>
</ul>
<p>有时资源包需要维护自定义的 <code>.bat</code> 文件来支持工作流，它可以不包含在 Composer 中。
这种情况下，该资源包 <strong>不</strong> 应该把它们作为二进制文件列出，因为 Composer 不需要知道它们。</p>
<h2>二进制供应库可以安装在 vendor/bin 以外的其它地方么？</h2>
<p>当然，这里有两种指定二进制供应库的其他可选位置的方法：</p>
<ol>
<li>在 <code>composer.json</code> 文件中的 <code>bin-dir</code> 配置属性处设置</li>
<li>设置环境变量 <code>COMPOSER_BIN_DIR</code></li>
</ol>
<p>前者的实例如下：</p>
<pre><code class="language-json">{
    &quot;config&quot;: {
        &quot;bin-dir&quot;: &quot;scripts&quot;
    }
}
</code></pre>
<p>在这个 <code>composer.json</code> 上运行 <code>composer install</code> 会把所有的二进制供应库
都安装在 <code>scripts/</code> 目录，而不是缺省的 <code>vendor/bin/</code> 目录。</p>


    <p class="fork-and-edit">
        如果您发现文档中有错误，或者能够帮我们完善文档，请提交到我们的 <a href="https://github.com/5-say/composer-doc-cn" target="_blank">Github 仓库吧</a>！
    </p>
            </div>
            <footer>

                <p class="license">Composer 以及本网站上的所有内容全部遵循 <a href="https://github.com/composer/composer/blob/master/LICENSE" target="_blank">MIT 开源协议</a>。</p>
            </footer>
        </div>

        <script src="http://docs.phpcomposer.com/assets/js/libs/prism.js"></script>
        <script type="text/javascript">
        var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
        document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F16e97907ef84179ff8cd833509017a96' type='text/javascript'%3E%3C/script%3E"));
        </script>
    </body>
</html>
