<!DOCTYPE html>
<html class="no-js" lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,initial-scale=1">

        <title>库（资源包） | Composer 中文文档 | Composer 中文网</title>
        <meta name="description" content="Composer 是 PHP 中用来管理依赖（dependency）关系的工具">
        <meta name="keywords" content="PHP, Composer, Packagist, 依赖管理, npm, Symfony, Laravel">

        <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="assets/css/style.css">
        <link rel="stylesheet" href="assets/css/libs/prism.css">

        <script src="https://cdn.bootcss.com/modernizr/2.8.2/modernizr.min.js"></script>
    </head>

    <body>
        <div id="container">
            <header>
                    <a href="docs_phpcomposer_default.html">首页</a>
                    <a href="00-intro.html">入门</a>
                    <a href="https://getcomposer.org/download/" target="_blank">下载</a>
                    <a href="https://packagist.org/" target="_blank">安装包列表</a>
                    <a class="last" href="https://pkg.phpcomposer.com/" target="_blank">中国镜像</a>
            </header>
            <div id="main" role="main">
    
    <p><a name="Libraries"></a></p>
<h1>库（资源包）</h1>
<p>本章将告诉你如何通过 Composer 来安装你的库。</p>
<hr>
<ul>
<li><a href="02-libraries.html#Libraries">库（资源包）</a>
<ul>
<li><a href="02-libraries.html#Every-project-is-a-package">每一个项目都是一个包</a></li>
<li><a href="02-libraries.html#Platform-packages">平台软件包</a></li>
<li><a href="02-libraries.html#Specifying-the-version">指明版本</a>
<ul>
<li><a href="02-libraries.html#Tags">标签</a></li>
<li><a href="02-libraries.html#Branches">分支</a></li>
<li><a href="02-libraries.html#Aliases">别名</a></li>
</ul>
</li>
<li><a href="02-libraries.html#Lock-file">锁文件</a></li>
<li><a href="02-libraries.html#Publishing-to-a-VCS">发布到 VCS（线上版本控制系统）</a></li>
<li><a href="02-libraries.html#Publishing-to-packagist">发布到 packagist</a></li>
</ul>
</li>
</ul>
<hr>
<p><a name="Every-project-is-a-package"></a></p>
<h2>每一个项目都是一个包</h2>
<p>只要你有一个 <code>composer.json</code> 文件在目录中，那么整个目录就是一个包。当你添加一个 <code>require</code> 到项目中，你就是在创建一个依赖于其它库的包。你的项目和库之间唯一的区别是，你的项目是一个没有名字的包。</p>
<p>为了使它成为一个可安装的包，你需要给它一个名称。你可以通过 <code>composer.json</code> 中的 <code>name</code> 来定义：</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;acme/hello-world&quot;,
    &quot;require&quot;: {
        &quot;monolog/monolog&quot;: &quot;1.0.*&quot;
    }
}
</code></pre>
<p>在这种情况下项目的名称为 <code>acme/hello-world</code>，其中 <code>acme</code> 是供应商的名称。供应商的名称是必须填写的。</p>
<blockquote>
<p><strong>注意：</strong> 如果你不知道拿什么作为供应商的名称，
那么使用你 github 上的用户名通常是不错的选择。
虽然包名不区分大小写，但惯例是使用小写字母，并用连字符作为单词的分隔。</p>
</blockquote>
<p><a name="Platform-packages"></a></p>
<h2>平台软件包</h2>
<p>Composer 将那些已经安装在系统上，但并不是由 Composer 安装的包视为一个虚拟的平台软件包。这包括PHP本身，PHP扩展和一些系统库。</p>
<ul>
<li>
<p><code>php</code> 表示用户的 PHP 版本要求，你可以对其做出限制。例如 <code>&gt;=5.4.0</code>。如果需要64位版本的 PHP，你可以使用 <code>php-64bit</code> 进行限制。</p>
</li>
<li>
<p><code>hhvm</code> 代表的是 HHVM（也就是 HipHop Virtual
Machine） 运行环境的版本，并且允许你设置一个版本限制，例如，'&gt;=2.3.3'。</p>
</li>
<li>
<p><code>ext-&lt;name&gt;</code> 可以帮你指定需要的 PHP 扩展（包括核心扩展）。通常 PHP 拓展的版本可以是不一致的，将它们的版本约束为 <code>*</code> 是一个不错的主意。一个 PHP 扩展包的例子：包名可以写成 <code>ext-gd</code>。</p>
</li>
<li>
<p><code>lib-&lt;name&gt;</code> 允许对 PHP 库的版本进行限制。<br>
以下是可供使用的名称：<code>curl</code>、<code>iconv</code>、<code>icu</code>、<code>libxml</code>、<code>openssl</code>、<code>pcre</code>、<code>uuid</code>、<code>xsl</code>。</p>
</li>
</ul>
<p>你可以使用 <code>composer show --platform</code> 命令来获取可用的平台软件包的列表。</p>
<p><a name="Specifying-the-version"></a></p>
<h2>指明版本</h2>
<p>你需要一些方法来指明自己开发的包的版本，当你在 Packagist 上发布自己的包，它能够从 VCS (git, svn,
hg) 的信息推断出包的版本，因此你不必手动指明版本号，并且也不建议这样做。请查看 <a href="02-libraries.html#Tags">标签</a> 和 <a href="02-libraries.html#Branches">分支</a> 来了解版本号是如何被提取的。</p>
<p>如果你想要手动创建并且真的要明确指定它，你只需要添加一个 <code>version</code> 字段：</p>
<pre><code class="language-json">{
    &quot;version&quot;: &quot;1.0.0&quot;
}
</code></pre>
<blockquote>
<p><strong>注意：</strong> 你应该尽量避免手动设置版本号，因为标签的值必须与标签名相匹配。</p>
</blockquote>
<p><a name="Tags"></a></p>
<h3>标签</h3>
<p>对于每一个看起来像版本号的标签，都会相应的创建一个包的版本。它应该符合 'X.Y.Z' 或者 'vX.Y.Z' 的形式，<code>-patch</code>、<code>-alpha</code>、<code>-beta</code> 或 <code>-RC</code> 这些后缀是可选的。在后缀之后也可以再跟上一个数字。</p>
<p>下面是有效的标签名称的几个例子：</p>
<ul>
<li>1.0.0</li>
<li>v1.0.0</li>
<li>1.10.5-RC1</li>
<li>v4.4.4beta2</li>
<li>v2.0.0-alpha</li>
<li>v2.0.4-p1</li>
</ul>
<blockquote>
<p><strong>注意：</strong> 即使你的标签带有前缀 <code>v</code>，
由于在需要 <code>require</code> 一个<a href="01-basic-usage.html#Package-Versions">版本的约束</a>时是不允许这种前缀的，
因此 <code>v</code> 将被省略（例如标签 <code>V1.0.0</code> 将创建 <code>1.0.0</code> 版本）。</p>
</blockquote>
<p><a name="Branches"></a></p>
<h3>分支</h3>
<p>对于每一个分支，都会相应的创建一个包的开发版本。如果分支名看起来像一个版本号，那么将创建一个如同 <code>{分支名}-dev</code> 的包版本号。例如一个分支 <code>2.0</code> 将产生一个 <code>2.0.x-dev</code> 包版本（加入了 <code>.x</code> 是出于技术的原因，以确保它被识别为一个分支，而 <code>2.0.x</code> 的分支名称也是允许的，它同样会被转换为 <code>2.0.x-dev</code>）。如果分支名看起来不像一个版本号，它将会创建 <code>dev-{分支名}</code> 形式的版本号。例如 <code>master</code> 将产生一个 <code>dev-master</code> 的版本号。</p>
<p>下面是版本分支名称的一些示例：</p>
<ul>
<li>1.x</li>
<li>1.0 (equals 1.0.x)</li>
<li>1.1.x</li>
</ul>
<blockquote>
<p><strong>注意：</strong> 当你安装一个新的版本时，将会自动从它 <code>source</code> 中拉取。
详细请查看 <a href="03-cli.html#install"><code>install</code></a> 命令。</p>
</blockquote>
<p><a name="Aliases"></a></p>
<h3>别名</h3>
<p>它表示一个包版本的别名。例如，你可以为 <code>dev-master</code> 设置别名 <code>1.0.x-dev</code>，这样就可以通过 require <code>1.0.x-dev</code> 来得到 <code>dev-master</code> 版本的包。</p>
<p>详细请查看<a href="articles/aliases.html">“别名”</a>。</p>
<p><a name="Lock-file"></a></p>
<h2>锁文件</h2>
<p>如果你愿意，可以在你的项目中提交 <code>composer.lock</code> 文件。他将帮助你的团队始终针对同一个依赖版本进行测试。任何时候，这个锁文件都只对于你的项目产生影响。</p>
<p>如果你不想提交锁文件，并且你正在使用 Git，那么请将它添加到 <code>.gitignore</code> 文件中。</p>
<p><a name="Publishing-to-a-VCS"></a></p>
<h2>发布到 VCS（线上版本控制系统）</h2>
<p>一旦你有一个包含 <code>composer.json</code> 文件的库存储在线上版本控制系统（例如：Git），你的库就可以被 Composer 所安装。在这个例子中，我们将 <code>acme/hello-world</code> 库发布在 GitHub 上的 <code>github.com/username/hello-world</code> 中。</p>
<p>现在测试这个 <code>acme/hello-world</code> 包，我们在本地创建一个新的项目。我们将它命名为 <code>acme/blog</code>。此博客将依赖 <code>acme/hello-world</code>，而后者又依赖 <code>monolog/monolog</code>。我们可以在某处创建一个新的 <code>blog</code> 文件夹来完成它，并且需要包含 <code>composer.json</code> 文件：</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;acme/blog&quot;,
    &quot;require&quot;: {
        &quot;acme/hello-world&quot;: &quot;dev-master&quot;
    }
}
</code></pre>
<p>在这个例子中 <code>name</code> 不是必须的，因为我们并不想将它发布为一个库。在这里为 <code>composer.json</code> 文件添加描述。</p>
<p>现在我们需要告诉我们的应用，在哪里可以找到 <code>hello-world</code> 的依赖。为此我们需要在 <code>composer.json</code> 中添加 <code>repositories</code> 来源申明：</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;acme/blog&quot;,
    &quot;repositories&quot;: [
        {
            &quot;type&quot;: &quot;vcs&quot;,
            &quot;url&quot;: &quot;https://github.com/username/hello-world&quot;
        }
    ],
    &quot;require&quot;: {
        &quot;acme/hello-world&quot;: &quot;dev-master&quot;
    }
}
</code></pre>
<p>更多关于包的来源是如何工作的，以及还有什么其他的类型可供选择，请查看<a href="05-repositories.html">资源库</a>。</p>
<p>这就是全部了。你现在可以使用 Composer 的 <code>install</code> 命令来安装你的依赖包了！</p>
<p><strong>小结：</strong> 任何含有 <code>composer.json</code> 的 <code>GIT</code>、<code>SVN</code>、<code>HG</code> 存储库，都可以通过 <code>require</code> 字段指定“包来源”和“声明依赖”来添加到你的项目中。</p>
<p><a name="Publishing-to-packagist"></a></p>
<h2>发布到 packagist</h2>
<p>好的，你现在可以发布你的包了，但你不会希望你的用户每次都这样繁琐的指定包的来源。</p>
<p>你可能注意到了另一件事，我们并没有指定 <code>monolog/monolog</code> 的来源。它是怎么工作的？答案是 packagist。</p>
<p><a href="https://packagist.org/" target="_blank">Packagist</a> 是 Composer 主要的一个包信息存储库，它默认是启用的。任何在 packagist 上发布的包都可以直接被 Composer 使用。就像 monolog
它被 <a href="https://packagist.org/packages/monolog/monolog" target="_blank">发布在 packagist 上</a>，我们可以直接使用它，而不必指定任何额外的来源信息。</p>
<p>如果我们想与世界分享我们的 <code>hello-world</code>，我们最好将它发布到 packagist 上。这样做是很容易的。</p>
<p>你只需要点击那个大大的 &quot;Submit Package&quot; 按钮并注册。接着提交你库的来源地址，此时 packagist 就开始了抓取。一旦完成，你的包将可以提供给任何人使用。</p>
<p>← <a href="01-basic-usage.html">基本用法</a> |  <a href="03-cli.html">命令行</a> →</p>


    <p class="fork-and-edit">
        如果您发现文档中有错误，或者能够帮我们完善文档，请提交到我们的 <a href="https://github.com/5-say/composer-doc-cn" target="_blank">Github 仓库吧</a>！
    </p>
            </div>
            <footer>

                <p class="license">Composer 以及本网站上的所有内容全部遵循 <a href="https://github.com/composer/composer/blob/master/LICENSE" target="_blank">MIT 开源协议</a>。</p>
            </footer>
        </div>

        <script src="http://docs.phpcomposer.com/assets/js/libs/prism.js"></script>
        <script type="text/javascript">
        var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
        document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F16e97907ef84179ff8cd833509017a96' type='text/javascript'%3E%3C/script%3E"));
        </script>
    </body>
</html>
